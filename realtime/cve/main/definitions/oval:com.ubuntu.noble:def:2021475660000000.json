{
	"class": "vulnerability",
	"id": "oval:com.ubuntu.noble:def:2021475660000000",
	"version": "1",
	"metadata": {
		"title": "CVE-2021-47566 on Ubuntu 24.04 LTS (noble) - medium",
		"description": "In the Linux kernel, the following vulnerability has been resolved:proc/vmcore: fix clearing user buffer by properly using clear_user() Toclear a user buffer we cannot simply use memset, we have to useclear_user(). With a virtio-mem device that registers a vmcore_cb and hassome logically unplugged memory inside an added Linux memory block, I caneasily trigger a BUG by copying the vmcore via \"cp\": systemd[1]: StartingKdump Vmcore Save Service... kdump[420]: Kdump is using the default loglevel(3). kdump[453]: saving to/sysroot/var/crash/127.0.0.1-2021-11-11-14:59:22/ kdump[458]: savingvmcore-dmesg.txt to /sysroot/var/crash/127.0.0.1-2021-11-11-14:59:22/kdump[465]: saving vmcore-dmesg.txt complete kdump[467]: saving vmcore BUG:unable to handle page fault for address: 00007f2374e01000 #PF: supervisorwrite access in kernel mode #PF: error_code(0x0003) - permissions violationPGD 7a523067 P4D 7a523067 PUD 7a528067 PMD 7a525067 PTE 800000007048f867Oops: 0003 [#1] PREEMPT SMP NOPTI CPU: 0 PID: 468 Comm: cp Not tainted5.15.0+ #6 Hardware name: QEMU Standard PC (Q35 + ICH9, 2009), BIOSrel-1.14.0-27-g64f37cc530f1-prebuilt.qemu.org 04/01/2014 RIP:0010:read_from_oldmem.part.0.cold+0x1d/0x86 Code: ff ff ff e8 05 ff fe ffe9 b9 e9 7f ff 48 89 de 48 c7 c7 38 3b 60 82 e8 f1 fe fe ff 83 fd 08 72 3c49 8d 7d 08 4c 89 e9 89 e8 <49> c7 45 00 00 00 00 00 49 c7 44 05 f8 00 0000 00 48 83 e7 f81 RSP: 0018:ffffc9000073be08 EFLAGS: 00010212 RAX:0000000000001000 RBX: 00000000002fd000 RCX: 00007f2374e01000 RDX:0000000000000001 RSI: 00000000ffffdfff RDI: 00007f2374e01008 RBP:0000000000001000 R08: 0000000000000000 R09: ffffc9000073bc50 R10:ffffc9000073bc48 R11: ffffffff829461a8 R12: 000000000000f000 R13:00007f2374e01000 R14: 0000000000000000 R15: ffff88807bd421e8 FS:00007f2374e12140(0000) GS:ffff88807f000000(0000) knlGS:0000000000000000 CS:0010 DS: 0000 ES: 0000 CR0: 0000000080050033 CR2: 00007f2374e01000 CR3:000000007a4aa000 CR4: 0000000000350eb0 Call Trace: read_vmcore+0x236/0x2c0proc_reg_read+0x55/0xa0 vfs_read+0x95/0x190 ksys_read+0x4f/0xc0do_syscall_64+0x3b/0x90 entry_SYSCALL_64_after_hwframe+0x44/0xae Somex86-64 CPUs have a CPU feature called \"Supervisor Mode Access Prevention(SMAP)\", which is used to detect wrong access from the kernel to userbuffers like this: SMAP triggers a permissions violation on wrong access.In the x86-64 variant of clear_user(), SMAP is properly handled viaclac()+stac(). To fix, properly use clear_user() when we're dealing with auser buffer.\n\n    Update Instructions:\n\n    Run `sudo pro fix CVE-2021-47566` to fix the vulnerability. The problem can be corrected\n    by updating your system to the following package versions:\n\nlinux-image-6.5.0-9-generic - 6.5.0-9.9\nlinux-image-unsigned-6.5.0-9-generic - 6.5.0-9.9\nlinux-image-unsigned-6.5.0-9-generic-64k - 6.5.0-9.9\nNo subscription required\n\nlinux-image-unsigned-6.5.0-1008-aws - 6.5.0-1008.8\nNo subscription required\n\nlinux-image-unsigned-6.5.0-1007-azure - 6.5.0-1007.7\nNo subscription required\n\nlinux-image-unsigned-6.5.0-1007-gcp - 6.5.0-1007.7\nNo subscription required\n\nlinux-image-unsigned-6.8.0-1003-gke - 6.8.0-1003.5\nNo subscription required\n\nlinux-image-unsigned-6.5.0-1009-ibm - 6.5.0-1009.9\nNo subscription required\n\nlinux-image-unsigned-6.5.0-9-lowlatency - 6.5.0-9.9.1\nlinux-image-unsigned-6.5.0-9-lowlatency-64k - 6.5.0-9.9.1\nNo subscription required\n\nlinux-image-unsigned-6.5.0-1010-oracle - 6.5.0-1010.10\nNo subscription required\n\nlinux-image-6.5.0-1005-raspi - 6.5.0-1005.7\nNo subscription required\n\nlinux-image-unsigned-6.8.0-1003-oem - 6.8.0-1003.3\nNo subscription required\n\nlinux-image-unsigned-6.8.0-1005-intel - 6.8.0-1001.6\nNo subscription required\n\nlinux-image-6.7.0-2001-raspi-realtime - 6.7.0-2001.1\nAvailable with Ubuntu Pro: https://ubuntu.com/pro\n\nlinux-image-unsigned-6.8.0-1008-realtime - 6.8.0-1008.19\nAvailable with Ubuntu Pro: https://ubuntu.com/pro",
		"affected": {
			"family": "unix",
			"platform": "Ubuntu 24.04 LTS"
		},
		"reference": {
			"source": "CVE",
			"ref_id": "CVE-2021-47566",
			"ref_url": "https://www.cve.org/CVERecord?id=CVE-2021-47566"
		},
		"advisory": {
			"severity": "Medium",
			"rights": "Copyright (C) 2024 Canonical Ltd.",
			"public_date": "2024-05-24 15:15:00 UTC",
			"cve": {
				"text": "CVE-2021-47566",
				"href": "https://ubuntu.com/security/CVE-2021-47566",
				"public": "20240524"
			}
		}
	},
	"notes": {},
	"criteria": {
		"criterias": [
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201431800000000",
						"comment": "linux package in noble, is related to the CVE in some way and has been fixed (note: '6.5.0-9.9')."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201431800000010",
						"comment": "linux-aws package in noble, is related to the CVE in some way and has been fixed (note: '6.5.0-1008.8')."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201431800000020",
						"comment": "linux-azure package in noble, is related to the CVE in some way and has been fixed (note: '6.5.0-1007.7')."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201431800000020",
						"comment": "linux-gcp package in noble, is related to the CVE in some way and has been fixed (note: '6.5.0-1007.7')."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201431800000040",
						"comment": "linux-gke package in noble, is related to the CVE in some way and has been fixed (note: '6.8.0-1003.5')."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201431800000050",
						"comment": "linux-ibm package in noble, is related to the CVE in some way and has been fixed (note: '6.5.0-1009.9')."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201431800000070",
						"comment": "linux-lowlatency package in noble, is related to the CVE in some way and has been fixed (note: '6.5.0-9.9.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201431800000030",
						"comment": "linux-oracle package in noble, is related to the CVE in some way and has been fixed (note: '6.5.0-1010.10')."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201431800000090",
						"comment": "linux-raspi package in noble, is related to the CVE in some way and has been fixed (note: '6.5.0-1005.7')."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201431800000080",
						"comment": "linux-oem-6.8 package in noble, is related to the CVE in some way and has been fixed (note: '6.8.0-1003.3')."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201431800000060",
						"comment": "linux-intel package in noble, is related to the CVE in some way and has been fixed (note: '6.8.0-1001.6')."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201431800000100",
						"comment": "linux-raspi-realtime package in realtime/noble, is related to the CVE in some way and has been fixed (note: '6.7.0-2001.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201431800000110",
						"comment": "linux-realtime package in realtime/noble, is related to the CVE in some way and has been fixed (note: '6.8.0-1008.19')."
					}
				]
			}
		]
	}
}
