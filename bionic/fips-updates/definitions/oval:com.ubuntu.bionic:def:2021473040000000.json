{
	"class": "vulnerability",
	"id": "oval:com.ubuntu.bionic:def:2021473040000000",
	"version": "1",
	"metadata": {
		"title": "CVE-2021-47304 on Ubuntu 18.04 FIPS Compliant (bionic) - medium",
		"description": "In the Linux kernel, the following vulnerability has been resolved: tcp:fix tcp_init_transfer() to not reset icsk_ca_initialized This commit fixesa bug (found by syzkaller) that could cause spurious double-initializationsfor congestion control modules, which could cause memory leaks or otherproblems for congestion control modules (like CDG) that allocate memory intheir init functions. The buggy scenario constructed by syzkaller wassomething like: (1) create a TCP socket (2) initiate a TFO connect viasendto() (3) while socket is in TCP_SYN_SENT, callsetsockopt(TCP_CONGESTION), which calls: tcp_set_congestion_control() ->tcp_reinit_congestion_control() -> tcp_init_congestion_control() (4)receive ACK, connection is established, call tcp_init_transfer(), seticsk_ca_initialized=0 (without first calling cc->release()), calltcp_init_congestion_control() again. Note that in this sequencetcp_init_congestion_control() is called twice without a cc->release() callin between. Thus, for CC modules that allocate memory in their init()function, e.g, CDG, a memory leak may occur. The syzkaller tool managed tofind a reproducer that triggered such a leak in CDG. The bug was introducedwhen that commit 8919a9b31eb4 (\"tcp: Only init congestion control if notinitialized already\") introduced icsk_ca_initialized and seticsk_ca_initialized to 0 in tcp_init_transfer(), missing the possibilityfor a sequence like the one above, where a process could callsetsockopt(TCP_CONGESTION) in state TCP_SYN_SENT (i.e. after the connect()or TFO open sendmsg()), which would call tcp_init_congestion_control(). Itdid not intend to reset any initialization that the user had alreadyexplicitly made; it just missed the possibility of that particular sequence(which syzkaller managed to find).\n\n    Update Instructions:\n\n    Run `sudo pro fix CVE-2021-47304` to fix the vulnerability. The problem can be corrected\n    by updating your system to the following package versions:\n\nlinux-image-4.15.0-1119-fips - 4.15.0-1119.130\nlinux-image-hmac-4.15.0-1119-fips - 4.15.0-1119.130\nlinux-image-unsigned-4.15.0-1119-fips - 4.15.0-1119.130\nlinux-image-unsigned-hmac-4.15.0-1119-fips - 4.15.0-1119.130\nAvailable with Ubuntu Pro: https://ubuntu.com/pro\n\nlinux-image-unsigned-4.15.0-2103-aws-fips - 4.15.0-2103.109\nlinux-image-unsigned-hmac-4.15.0-2103-aws-fips - 4.15.0-2103.109\nAvailable with Ubuntu Pro: https://ubuntu.com/pro\n\nlinux-image-unsigned-4.15.0-2082-azure-fips - 4.15.0-2082.88\nlinux-image-unsigned-hmac-4.15.0-2082-azure-fips - 4.15.0-2082.88\nAvailable with Ubuntu Pro: https://ubuntu.com/pro\n\nlinux-image-unsigned-4.15.0-2066-gcp-fips - 4.15.0-2066.71\nlinux-image-unsigned-hmac-4.15.0-2066-gcp-fips - 4.15.0-2066.71\nAvailable with Ubuntu Pro: https://ubuntu.com/pro",
		"affected": {
			"family": "unix",
			"platform": "Ubuntu 18.04 FIPS Compliant"
		},
		"reference": {
			"source": "CVE",
			"ref_id": "CVE-2021-47304",
			"ref_url": "https://www.cve.org/CVERecord?id=CVE-2021-47304"
		},
		"advisory": {
			"severity": "Medium",
			"rights": "Copyright (C) 2024 Canonical Ltd.",
			"public_date": "2024-05-21 15:15:00 UTC",
			"cve": {
				"text": "CVE-2021-47304",
				"href": "https://ubuntu.com/security/CVE-2021-47304",
				"public": "20240521"
			}
		}
	},
	"notes": {},
	"criteria": {
		"criterias": [
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:2017109110000010",
						"comment": "linux-fips package in fips-updates/bionic, is related to the CVE in some way and has been fixed (note: '4.15.0-1119.130')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:2017109110000020",
						"comment": "linux-aws-fips package in fips-updates/bionic, is related to the CVE in some way and has been fixed (note: '4.15.0-2103.109')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:2017109110000030",
						"comment": "linux-azure-fips package in fips-updates/bionic, is related to the CVE in some way and has been fixed (note: '4.15.0-2082.88')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:2017109110000040",
						"comment": "linux-gcp-fips package in fips-updates/bionic, is related to the CVE in some way and has been fixed (note: '4.15.0-2066.71')."
					}
				]
			}
		]
	}
}
