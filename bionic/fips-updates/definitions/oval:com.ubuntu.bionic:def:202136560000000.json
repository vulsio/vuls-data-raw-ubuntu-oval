{
	"class": "vulnerability",
	"id": "oval:com.ubuntu.bionic:def:202136560000000",
	"version": "1",
	"metadata": {
		"Title": "CVE-2021-3656 on Ubuntu 18.04 FIPS Compliant (bionic) - high.",
		"Description": "A flaw was found in the KVM's AMD code for supporting SVM nested virtualization. The flaw occurs when processing the VMCB (virtual machine control block) provided by the L1 guest to spawn/handle a nested guest (L2). Due to improper validation of the \"virt_ext\" field, this issue could allow a malicious L1 to disable both VMLOAD/VMSAVE intercepts and VLS (Virtual VMLOAD/VMSAVE) for the L2 guest. As a result, the L2 guest would be allowed to read/write physical pages of the host, resulting in a crash of the entire system, leak of sensitive data or potential guest-to-host escape. Maxim Levitsky and Paolo Bonzini discovered that the KVM hypervisor implementation for AMD processors in the Linux kernel allowed a guest VM to disable restrictions on VMLOAD/VMSAVE in a nested guest. An attacker in a guest VM could use this to read or write portions of the host's physical memory.\n\nUpdate Instructions:\n\nRun `sudo pro fix CVE-2021-3656` to fix the vulnerability. The problem can be corrected\nby updating your system to the following package versions:\n\nlinux-image-4.15.0-156-generic - 4.15.0-156.163\nlinux-image-4.15.0-156-generic-lpae - 4.15.0-156.163\nlinux-image-4.15.0-156-lowlatency - 4.15.0-156.163\nlinux-image-unsigned-4.15.0-156-generic - 4.15.0-156.163\nlinux-image-unsigned-4.15.0-156-lowlatency - 4.15.0-156.163\nNo subscription required\n\nlinux-image-4.15.0-1111-aws - 4.15.0-1111.118\nNo subscription required\n\nlinux-image-5.4.0-1056-aws - 5.4.0-1056.59~18.04.1\nNo subscription required\n\nlinux-image-unsigned-4.15.0-1123-azure - 4.15.0-1123.136\nNo subscription required\n\nlinux-image-unsigned-5.4.0-1058-azure - 5.4.0-1058.60~18.04.1\nNo subscription required\n\nlinux-image-unsigned-4.15.0-1027-dell300x - 4.15.0-1027.32\nNo subscription required\n\nlinux-image-unsigned-4.15.0-1108-gcp - 4.15.0-1108.122\nNo subscription required\n\nlinux-image-unsigned-5.4.0-1052-gcp - 5.4.0-1052.56~18.04.1\nNo subscription required\n\nlinux-image-unsigned-5.4.0-1052-gke - 5.4.0-1052.55~18.04.1\nNo subscription required\n\nlinux-image-unsigned-5.4.0-1023-gkeop - 5.4.0-1023.24~18.04.1\nNo subscription required\n\nlinux-image-5.4.0-84-generic - 5.4.0-84.94~18.04.1\nlinux-image-5.4.0-84-generic-lpae - 5.4.0-84.94~18.04.1\nlinux-image-5.4.0-84-lowlatency - 5.4.0-84.94~18.04.1\nlinux-image-unsigned-5.4.0-84-generic - 5.4.0-84.94~18.04.1\nlinux-image-unsigned-5.4.0-84-lowlatency - 5.4.0-84.94~18.04.1\nNo subscription required\n\nlinux-image-unsigned-5.4.0-1010-ibm - 5.4.0-1010.11~18.04.2\nNo subscription required\n\nlinux-image-4.15.0-1099-kvm - 4.15.0-1099.101\nNo subscription required\n\nlinux-image-unsigned-4.15.0-1080-oracle - 4.15.0-1080.88\nNo subscription required\n\nlinux-image-unsigned-5.4.0-1054-oracle - 5.4.0-1054.58~18.04.1\nNo subscription required\n\nlinux-image-4.15.0-156-generic - 4.15.0-156.163\nlinux-image-4.15.0-156-generic-lpae - 4.15.0-156.163\nlinux-image-4.15.0-156-lowlatency - 4.15.0-156.163\nlinux-image-unsigned-4.15.0-156-generic - 4.15.0-156.163\nlinux-image-unsigned-4.15.0-156-lowlatency - 4.15.0-156.163\nNo subscription required\n\nlinux-image-4.15.0-1111-aws - 4.15.0-1111.118\nNo subscription required\n\nlinux-image-5.4.0-1056-aws - 5.4.0-1056.59~18.04.1\nNo subscription required\n\nlinux-image-unsigned-4.15.0-1123-azure - 4.15.0-1123.136\nNo subscription required\n\nlinux-image-unsigned-5.4.0-1058-azure - 5.4.0-1058.60~18.04.1\nNo subscription required\n\nlinux-image-unsigned-4.15.0-1027-dell300x - 4.15.0-1027.32\nNo subscription required\n\nlinux-image-unsigned-4.15.0-1108-gcp - 4.15.0-1108.122\nNo subscription required\n\nlinux-image-unsigned-5.4.0-1052-gcp - 5.4.0-1052.56~18.04.1\nNo subscription required\n\nlinux-image-unsigned-5.4.0-1052-gke - 5.4.0-1052.55~18.04.1\nNo subscription required\n\nlinux-image-unsigned-5.4.0-1023-gkeop - 5.4.0-1023.24~18.04.1\nNo subscription required\n\nlinux-image-5.4.0-84-generic - 5.4.0-84.94~18.04.1\nlinux-image-5.4.0-84-generic-lpae - 5.4.0-84.94~18.04.1\nlinux-image-5.4.0-84-lowlatency - 5.4.0-84.94~18.04.1\nlinux-image-unsigned-5.4.0-84-generic - 5.4.0-84.94~18.04.1\nlinux-image-unsigned-5.4.0-84-lowlatency - 5.4.0-84.94~18.04.1\nNo subscription required\n\nlinux-image-unsigned-5.4.0-1010-ibm - 5.4.0-1010.11~18.04.2\nNo subscription required\n\nlinux-image-unsigned-4.15.0-1080-oracle - 4.15.0-1080.88\nNo subscription required\n\nlinux-image-unsigned-5.4.0-1054-oracle - 5.4.0-1054.58~18.04.1\nNo subscription required\n\nlinux-image-4.15.0-1112-snapdragon - 4.15.0-1112.121\nNo subscription required",
		"affected": {
			"family": "unix",
			"Platform": "Ubuntu 18.04 FIPS Compliant"
		},
		"reference": {
			"source": "CVE",
			"ref_id": "CVE-2021-3656",
			"ref_url": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-3656"
		},
		"advisory": {
			"Severity": "High",
			"Rights": "Copyright (C) 2021 Canonical Ltd.",
			"PublicDate": "2021-08-16 12:00:00 UTC",
			"Bug": null,
			"cve": {
				"text": "CVE-2021-3656",
				"href": "https://ubuntu.com/security/CVE-2021-3656",
				"public": "20210816",
				"cvss_score": "8.8",
				"cvss_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H",
				"usns": "5070-1,5071-1,5072-1,5073-1,5071-2,5082-1,5073-2"
			},
			"PublicDateAtUsn": "2021-08-16 12:00:00 UTC",
			"AssignedTo": "cascardo",
			"DiscoveredBy": "Maxim Levitsky and Paolo Bonzini",
			"Crd": "2021-08-16 12:00:00 UTC",
			"Ref": null
		}
	},
	"notes": {
		"Note": ""
	},
	"criteria": {
		"criterias": [
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:2021346930000000",
						"comment": "linux package in bionic was vulnerable but has been fixed (note: '4.15.0-156.163')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:2021346930000010",
						"comment": "linux-aws package in bionic was vulnerable but has been fixed (note: '4.15.0-1111.118')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000020",
						"comment": "linux-aws-5.0: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of standard support')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000030",
						"comment": "linux-aws-5.3: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of standard support')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:2020363110000040",
						"comment": "linux-aws-5.4 package in bionic was vulnerable but has been fixed (note: '5.4.0-1056.59~18.04.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000050",
						"comment": "linux-azure: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of standard support')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:2021346930000060",
						"comment": "linux-azure-4.15 package in bionic was vulnerable but has been fixed (note: '4.15.0-1123.136')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201585530000070",
						"comment": "linux-azure-5.3: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of standard support')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:2020363110000080",
						"comment": "linux-azure-5.4 package in bionic was vulnerable but has been fixed (note: '5.4.0-1058.60~18.04.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:2020245860000090",
						"comment": "linux-dell300x package in bionic was vulnerable but has been fixed (note: '4.15.0-1027.32')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201585530000100",
						"comment": "linux-fips package in fips-updates/bionic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000090",
						"comment": "linux-gcp: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of standard support')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:2021346930000120",
						"comment": "linux-gcp-4.15 package in bionic was vulnerable but has been fixed (note: '4.15.0-1108.122')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000110",
						"comment": "linux-gcp-5.3: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of standard support')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:2020363110000140",
						"comment": "linux-gcp-5.4 package in bionic was vulnerable but has been fixed (note: '5.4.0-1052.56~18.04.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000130",
						"comment": "linux-gke-4.15: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of standard support, was needs-triage')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000140",
						"comment": "linux-gke-5.0: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of standard support, was needs-triage')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000150",
						"comment": "linux-gke-5.3: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of standard support, was needs-triage')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:2020363110000180",
						"comment": "linux-gke-5.4 package in bionic was vulnerable but has been fixed (note: '5.4.0-1052.55~18.04.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:2020363110000190",
						"comment": "linux-gkeop-5.4 package in bionic was vulnerable but has been fixed (note: '5.4.0-1023.24~18.04.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000180",
						"comment": "linux-hwe: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of standard support')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:2020363110000210",
						"comment": "linux-hwe-5.4 package in bionic was vulnerable but has been fixed (note: '5.4.0-84.94~18.04.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:2016107230000220",
						"comment": "linux-ibm-5.4 package in bionic, is related to the CVE in some way and has been fixed (note: '5.4.0-1010.11~18.04.2')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:2021346930000230",
						"comment": "linux-kvm package in bionic was vulnerable but has been fixed (note: '4.15.0-1099.101')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000220",
						"comment": "linux-oem: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of standard support, was needs-triage')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000230",
						"comment": "linux-oem-osp1: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of standard support, was needs-triage')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:2021346930000260",
						"comment": "linux-oracle package in bionic was vulnerable but has been fixed (note: '4.15.0-1080.88')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000250",
						"comment": "linux-oracle-5.0: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of standard support')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000260",
						"comment": "linux-oracle-5.3: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of standard support')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:2020363110000290",
						"comment": "linux-oracle-5.4 package in bionic was vulnerable but has been fixed (note: '5.4.0-1054.58~18.04.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:2021346930000330",
						"comment": "linux-signed package in bionic was vulnerable but has been fixed (note: '4.15.0-156.163')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:2021346930000340",
						"comment": "linux-signed-aws package in bionic was vulnerable but has been fixed (note: '4.15.0-1111.118')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:2020363110000330",
						"comment": "linux-signed-aws-5.4 package in bionic was vulnerable but has been fixed (note: '5.4.0-1056.59~18.04.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000340",
						"comment": "linux-signed-azure: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of standard support')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:2021346930000370",
						"comment": "linux-signed-azure-4.15 package in bionic was vulnerable but has been fixed (note: '4.15.0-1123.136')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201585530000380",
						"comment": "linux-signed-azure-5.3: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of standard support')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:2020363110000370",
						"comment": "linux-signed-azure-5.4 package in bionic was vulnerable but has been fixed (note: '5.4.0-1058.60~18.04.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:2020245860000400",
						"comment": "linux-signed-dell300x package in bionic was vulnerable but has been fixed (note: '4.15.0-1027.32')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000380",
						"comment": "linux-signed-gcp: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of standard support')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:2021346930000420",
						"comment": "linux-signed-gcp-4.15 package in bionic was vulnerable but has been fixed (note: '4.15.0-1108.122')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000400",
						"comment": "linux-signed-gcp-5.3: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of standard support')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:2020363110000420",
						"comment": "linux-signed-gcp-5.4 package in bionic was vulnerable but has been fixed (note: '5.4.0-1052.56~18.04.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000420",
						"comment": "linux-signed-gke-4.15: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of standard support, was needs-triage')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000430",
						"comment": "linux-signed-gke-5.0: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of standard support, was needs-triage')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000440",
						"comment": "linux-signed-gke-5.3: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of standard support, was needs-triage')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:2020363110000460",
						"comment": "linux-signed-gke-5.4 package in bionic was vulnerable but has been fixed (note: '5.4.0-1052.55~18.04.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:2020363110000470",
						"comment": "linux-signed-gkeop-5.4 package in bionic was vulnerable but has been fixed (note: '5.4.0-1023.24~18.04.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000470",
						"comment": "linux-signed-hwe: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of standard support')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:2020363110000490",
						"comment": "linux-signed-hwe-5.4 package in bionic was vulnerable but has been fixed (note: '5.4.0-84.94~18.04.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:2016107230000520",
						"comment": "linux-signed-ibm-5.4 package in bionic, is related to the CVE in some way and has been fixed (note: '5.4.0-1010.11~18.04.2')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000500",
						"comment": "linux-signed-oem: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of standard support, was needs-triage')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000510",
						"comment": "linux-signed-oem-osp1: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of standard support, was needs-triage')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:2021346930000550",
						"comment": "linux-signed-oracle package in bionic was vulnerable but has been fixed (note: '4.15.0-1080.88')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000530",
						"comment": "linux-signed-oracle-5.0: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of standard support')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000540",
						"comment": "linux-signed-oracle-5.3: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of standard support')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:2020363110000560",
						"comment": "linux-signed-oracle-5.4 package in bionic was vulnerable but has been fixed (note: '5.4.0-1054.58~18.04.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:2021346930000590",
						"comment": "linux-snapdragon package in bionic was vulnerable but has been fixed (note: '4.15.0-1112.121')."
					}
				]
			}
		]
	}
}
