{
	"class": "vulnerability",
	"id": "oval:com.ubuntu.bionic:def:2022489410000000",
	"version": "1",
	"metadata": {
		"title": "CVE-2022-48941 on Ubuntu 18.04 FIPS Compliant (bionic) - medium",
		"description": "In the Linux kernel, the following vulnerability has been resolved:ice: fix concurrent reset and removal of VFsCommit c503e63200c6 (\"ice: Stop processing VF messages during teardown\")introduced a driver state flag, ICE_VF_DEINIT_IN_PROGRESS, which isintended to prevent some issues with concurrently handling messages fromVFs while tearing down the VFs.This change was motivated by crashes caused while tearing down andbringing up VFs in rapid succession.It turns out that the fix actually introduces issues with the VF drivercaused because the PF no longer responds to any messages sent by the VFduring its .remove routine. This results in the VF potentially removingits DMA memory before the PF has shut down the device queues.Additionally, the fix doesn't actually resolve concurrency issues withinthe ice driver. It is possible for a VF to initiate a reset just priorto the ice driver removing VFs. This can result in the remove taskconcurrently operating while the VF is being reset. This results insimilar memory corruption and panics purportedly fixed by that commit.Fix this concurrency at its root by protecting both the reset andremoval flows using the existing VF cfg_lock. This ensures that wecannot remove the VF while any outstanding critical tasks such as avirtchnl message or a reset are occurring.This locking change also fixes the root cause originally fixed by commitc503e63200c6 (\"ice: Stop processing VF messages during teardown\"), so wecan simply revert it.Note that I kept these two changes together because simply reverting theoriginal commit alone would leave the driver vulnerable to worse raceconditions.\n\n    Update Instructions:\n\n    Run `sudo pro fix CVE-2022-48941` to fix the vulnerability. The problem can be corrected\n    by updating your system to the following package versions:\n\nlinux-image-4.15.0-1027-fips - 4.15.0-1027.32\nlinux-image-hmac-4.15.0-1027-fips - 4.15.0-1027.32\nlinux-image-unsigned-4.15.0-1027-fips - 4.15.0-1027.32\nlinux-image-unsigned-hmac-4.15.0-1027-fips - 4.15.0-1027.32\nAvailable with Ubuntu Pro: https://ubuntu.com/pro\n\nlinux-image-unsigned-4.15.0-2000-aws-fips - 4.15.0-2000.4\nlinux-image-unsigned-hmac-4.15.0-2000-aws-fips - 4.15.0-2000.4\nAvailable with Ubuntu Pro: https://ubuntu.com/pro\n\nlinux-image-unsigned-4.15.0-1002-azure-fips - 4.15.0-1002.2\nlinux-image-unsigned-hmac-4.15.0-1002-azure-fips - 4.15.0-1002.2\nAvailable with Ubuntu Pro: https://ubuntu.com/pro\n\nlinux-image-unsigned-4.15.0-2013-gcp-fips - 4.15.0-2013.14\nlinux-image-unsigned-hmac-4.15.0-2013-gcp-fips - 4.15.0-2013.14\nAvailable with Ubuntu Pro: https://ubuntu.com/pro",
		"affected": {
			"family": "unix",
			"platform": "Ubuntu 18.04 FIPS Compliant"
		},
		"reference": {
			"source": "CVE",
			"ref_id": "CVE-2022-48941",
			"ref_url": "https://www.cve.org/CVERecord?id=CVE-2022-48941"
		},
		"advisory": {
			"severity": "Medium",
			"rights": "Copyright (C) 2024 Canonical Ltd.",
			"public_date": "2024-08-22 04:15:00 UTC",
			"cve": {
				"text": "CVE-2022-48941",
				"href": "https://ubuntu.com/security/CVE-2022-48941",
				"public": "20240822",
				"cvss_score": "4.7",
				"cvss_vector": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:H"
			}
		}
	},
	"notes": {},
	"criteria": {
		"criterias": [
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:2016200220000000",
						"comment": "linux-fips package in fips-updates/bionic, is related to the CVE in some way and has been fixed (note: '4.15.0-1027.32')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:2016200220000010",
						"comment": "linux-aws-fips package in fips-updates/bionic, is related to the CVE in some way and has been fixed (note: '4.15.0-2000.4')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:200747740000040",
						"comment": "linux-azure-fips package in fips-updates/bionic, is related to the CVE in some way and has been fixed (note: '4.15.0-1002.2')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:2016200220000020",
						"comment": "linux-gcp-fips package in fips-updates/bionic, is related to the CVE in some way and has been fixed (note: '4.15.0-2013.14')."
					}
				]
			}
		]
	}
}
