{
	"class": "vulnerability",
	"id": "oval:com.ubuntu.bionic:def:2024359770000000",
	"version": "1",
	"metadata": {
		"title": "CVE-2024-35977 on Ubuntu 18.04 FIPS Certified (bionic) - medium",
		"description": "In the Linux kernel, the following vulnerability has been resolved:platform/chrome: cros_ec_uart: properly fix race conditionThe cros_ec_uart_probe() function calls devm_serdev_device_open() beforeit calls serdev_device_set_client_ops(). This can trigger a NULL pointerdereference:    BUG: kernel NULL pointer dereference, address: 0000000000000000    ...    Call Trace:     <TASK>     ...     ? ttyport_receive_bufA simplified version of crashing code is as follows:    static inline size_t serdev_controller_receive_buf(structserdev_controller *ctrl,                                                      const u8 *data,                                                      size_t count)    {            struct serdev_device *serdev = ctrl->serdev;            if (!serdev || !serdev->ops->receive_buf) // CRASH!                return 0;            return serdev->ops->receive_buf(serdev, data, count);    }It assumes that if SERPORT_ACTIVE is set and serdev exists, serdev->opswill also exist. This conflicts with the existing cros_ec_uart_probe()logic, as it first calls devm_serdev_device_open() (which setsSERPORT_ACTIVE), and only later sets serdev->ops viaserdev_device_set_client_ops().Commit 01f95d42b8f4 (\"platform/chrome: cros_ec_uart: fix racecondition\") attempted to fix a similar race condition, but while doingso, made the window of error for this race condition to happen muchwider.Attempt to fix the race condition again, making sure we fully setupbefore calling devm_serdev_device_open().",
		"affected": {
			"family": "unix",
			"platform": "Ubuntu 18.04 FIPS Certified"
		},
		"reference": {
			"source": "CVE",
			"ref_id": "CVE-2024-35977",
			"ref_url": "https://www.cve.org/CVERecord?id=CVE-2024-35977"
		},
		"advisory": {
			"severity": "Medium",
			"rights": "Copyright (C) 2024 Canonical Ltd.",
			"public_date": "2024-05-20 10:15:00 UTC",
			"cve": {
				"text": "CVE-2024-35977",
				"href": "https://ubuntu.com/security/CVE-2024-35977",
				"public": "20240520"
			}
		}
	},
	"notes": {},
	"criteria": {
		"criterias": [
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201585530000010",
						"comment": "linux-fips package in fips/bionic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000320",
						"comment": "linux-aws-fips package in fips/bionic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000330",
						"comment": "linux-azure-fips package in fips/bionic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000340",
						"comment": "linux-gcp-fips package in fips/bionic is affected and may need fixing."
					}
				]
			}
		]
	}
}
