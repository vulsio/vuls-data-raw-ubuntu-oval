{
	"class": "vulnerability",
	"id": "oval:com.ubuntu.bionic:def:2021472270000000",
	"version": "1",
	"metadata": {
		"title": "CVE-2021-47227 on Ubuntu 18.04 FIPS Certified (bionic) - medium",
		"description": "In the Linux kernel, the following vulnerability has been resolved:x86/fpu: Prevent state corruption in __fpu__restore_sig() The non-compactedslowpath uses __copy_from_user() and copies the entire user buffer into thekernel buffer, verbatim. This means that the kernel buffer may now containentirely invalid state on which XRSTOR will #GP.validate_user_xstate_header() can detect some of that corruption, but thatleaves the onus on callers to clear the buffer. Prior to XSAVES support, itwas possible just to reinitialize the buffer, completely, but withsupervisor states that is not longer possible as the buffer clearing codesplit got it backwards. Fixing that is possible but not corrupting thestate in the first place is more robust. Avoid corruption of the kernelXSAVE buffer by using copy_user_to_xstate() which validates the XSAVEheader contents before copying the actual states to the kernel.copy_user_to_xstate() was previously only called for compacted-formatkernel buffers, but it works for both compacted and non-compacted forms.Using it for the non-compacted form is slower because of multiple__copy_from_user() operations, but that cost is less important than robustcode in an already slow path. [ Changelog polished by Dave Hansen ]",
		"affected": {
			"family": "unix",
			"platform": "Ubuntu 18.04 FIPS Certified"
		},
		"reference": {
			"source": "CVE",
			"ref_id": "CVE-2021-47227",
			"ref_url": "https://www.cve.org/CVERecord?id=CVE-2021-47227"
		},
		"advisory": {
			"severity": "Medium",
			"rights": "Copyright (C) 2024 Canonical Ltd.",
			"public_date": "2024-05-21 15:15:00 UTC",
			"cve": {
				"text": "CVE-2021-47227",
				"href": "https://ubuntu.com/security/CVE-2021-47227",
				"public": "20240521"
			}
		}
	},
	"notes": {},
	"criteria": {
		"criterias": [
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201585530000010",
						"comment": "linux-fips package in fips/bionic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000320",
						"comment": "linux-aws-fips package in fips/bionic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000330",
						"comment": "linux-azure-fips package in fips/bionic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000340",
						"comment": "linux-gcp-fips package in fips/bionic is affected and may need fixing."
					}
				]
			}
		]
	}
}
