{
	"class": "vulnerability",
	"id": "oval:com.ubuntu.bionic:def:2023527920000000",
	"version": "1",
	"metadata": {
		"title": "CVE-2023-52792 on Ubuntu 18.04 FIPS Certified (bionic) - medium",
		"description": "In the Linux kernel, the following vulnerability has been resolved:cxl/region: Do not try to cleanup after cxl_region_setup_targets() failsCommit 5e42bcbc3fef (\"cxl/region: decrement ->nr_targets on error incxl_region_attach()\") tried to avoid 'eiw' initialization errors when->nr_targets exceeded 16, by just decrementing ->nr_targets whencxl_region_setup_targets() failed.Commit 86987c766276 (\"cxl/region: Cleanup target list on attach error\")extended that cleanup to also clear cxled->pos and p->targets[pos]. Theinitialization error was incidentally fixed separately by:Commit 8d4285425714 (\"cxl/region: Fix port setup uninitialized variablewarnings\") which was merged a few days after 5e42bcbc3fef.But now the original cleanup when cxl_region_setup_targets() failsprevents endpoint and switch decoder resources from being reused:1) the cleanup does not set the decoder's region to NULL, which results   in future dpa_size_store() calls returning -EBUSY2) the decoder is not properly freed, which results in future commit   errors associated with the upstream switchNow that the initialization errors were fixed separately, the propercleanup for this case is to just return immediately. Then the resourcesassociated with this target get cleanup up as normal when the failedregion is deleted.The ->nr_targets decrement in the error case also helped preventa p->targets[] array overflow, so add a new check to prevent againstthat overflow.Tested by trying to create an invalid region for a 2 switch * 2 endpointtopology, and then following up with creating a valid region.",
		"affected": {
			"family": "unix",
			"platform": "Ubuntu 18.04 FIPS Certified"
		},
		"reference": {
			"source": "CVE",
			"ref_id": "CVE-2023-52792",
			"ref_url": "https://www.cve.org/CVERecord?id=CVE-2023-52792"
		},
		"advisory": {
			"severity": "Medium",
			"rights": "Copyright (C) 2024 Canonical Ltd.",
			"public_date": "2024-05-21 16:15:00 UTC",
			"cve": {
				"text": "CVE-2023-52792",
				"href": "https://ubuntu.com/security/CVE-2023-52792",
				"public": "20240521"
			}
		}
	},
	"notes": {},
	"criteria": {
		"criterias": [
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201585530000010",
						"comment": "linux-fips package in fips/bionic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000320",
						"comment": "linux-aws-fips package in fips/bionic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000330",
						"comment": "linux-azure-fips package in fips/bionic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000340",
						"comment": "linux-gcp-fips package in fips/bionic is affected and may need fixing."
					}
				]
			}
		]
	}
}
