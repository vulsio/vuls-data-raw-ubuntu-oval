{
	"class": "vulnerability",
	"id": "oval:com.ubuntu.bionic:def:2024439100000000",
	"version": "1",
	"metadata": {
		"title": "CVE-2024-43910 on Ubuntu 18.04 FIPS Certified (bionic) - medium",
		"description": "In the Linux kernel, the following vulnerability has been resolved:bpf: add missing check_func_arg_reg_off() to prevent out-of-bounds memoryaccessesCurrently, it's possible to pass in a modified CONST_PTR_TO_DYNPTR toa global function as an argument. The adverse effects of this is thatBPF helpers can continue to make use of this modifiedCONST_PTR_TO_DYNPTR from within the context of the global function,which can unintentionally result in out-of-bounds memory accesses andtherefore compromise overall system stability i.e.[  244.157771] BUG: KASAN: slab-out-of-bounds inbpf_dynptr_data+0x137/0x140[  244.161345] Read of size 8 at addr ffff88810914be68 by tasktest_progs/302[  244.167151] CPU: 0 PID: 302 Comm: test_progs Tainted: G O E6.10.0-rc3-00131-g66b586715063 #533[  244.174318] Call Trace:[  244.175787]  <TASK>[  244.177356]  dump_stack_lvl+0x66/0xa0[  244.179531]  print_report+0xce/0x670[  244.182314]  ? __virt_addr_valid+0x200/0x3e0[  244.184908]  kasan_report+0xd7/0x110[  244.187408]  ? bpf_dynptr_data+0x137/0x140[  244.189714]  ? bpf_dynptr_data+0x137/0x140[  244.192020]  bpf_dynptr_data+0x137/0x140[  244.194264]bpf_prog_b02a02fdd2bdc5fa_global_call_bpf_dynptr_data+0x22/0x26[  244.198044]bpf_prog_b0fe7b9d7dc3abde_callback_adjust_bpf_dynptr_reg_off+0x1f/0x23[  244.202136]  bpf_user_ringbuf_drain+0x2c7/0x570[  244.204744]  ? 0xffffffffc0009e58[  244.206593]  ? __pfx_bpf_user_ringbuf_drain+0x10/0x10[  244.209795]bpf_prog_33ab33f6a804ba2d_user_ringbuf_callback_const_ptr_to_dynptr_reg_off+0x47/0x4b[  244.215922]  bpf_trampoline_6442502480+0x43/0xe3[  244.218691]  __x64_sys_prlimit64+0x9/0xf0[  244.220912]  do_syscall_64+0xc1/0x1d0[  244.223043]  entry_SYSCALL_64_after_hwframe+0x77/0x7f[  244.226458] RIP: 0033:0x7ffa3eb8f059[  244.228582] Code: 08 89 e8 5b 5d c3 66 2e 0f 1f 84 00 00 00 00 00 90 4889 f8 48 89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05<48> 3d 01 f0 ff ff 73 01 c3 48 8b 0d 8f 1d 0d 00 f7 d8 64 89 01 48[  244.241307] RSP: 002b:00007ffa3e9c6eb8 EFLAGS: 00000206 ORIG_RAX:000000000000012e[  244.246474] RAX: ffffffffffffffda RBX: 00007ffa3e9c7cdc RCX:00007ffa3eb8f059[  244.250478] RDX: 00007ffa3eb162b4 RSI: 0000000000000000 RDI:00007ffa3e9c7fb0[  244.255396] RBP: 00007ffa3e9c6ed0 R08: 00007ffa3e9c76c0 R09:0000000000000000[  244.260195] R10: 0000000000000000 R11: 0000000000000206 R12:ffffffffffffff80[  244.264201] R13: 000000000000001c R14: 00007ffc5d6b4260 R15:00007ffa3e1c7000[  244.268303]  </TASK>Add a check_func_arg_reg_off() to the path in which the BPF verifierverifies the arguments of global function arguments, specificallythose which take an argument of type ARG_PTR_TO_DYNPTR |MEM_RDONLY. Also, process_dynptr_func() doesn't appear to perform anyexplicit and strict type matching on the supplied register type, solet's also enforce that a register either type PTR_TO_STACK orCONST_PTR_TO_DYNPTR is by the caller.",
		"affected": {
			"family": "unix",
			"platform": "Ubuntu 18.04 FIPS Certified"
		},
		"reference": {
			"source": "CVE",
			"ref_id": "CVE-2024-43910",
			"ref_url": "https://www.cve.org/CVERecord?id=CVE-2024-43910"
		},
		"advisory": {
			"severity": "Medium",
			"rights": "Copyright (C) 2024 Canonical Ltd.",
			"public_date": "2024-08-26 11:15:00 UTC",
			"cve": {
				"text": "CVE-2024-43910",
				"href": "https://ubuntu.com/security/CVE-2024-43910",
				"public": "20240826",
				"cvss_score": "5.5",
				"cvss_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H"
			}
		}
	},
	"notes": {},
	"criteria": {
		"criterias": [
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000350",
						"comment": "linux-fips: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'ESM criteria, was needed')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000320",
						"comment": "linux-aws-fips: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'ESM criteria, was needed')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000330",
						"comment": "linux-azure-fips: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'ESM criteria, was needed')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000340",
						"comment": "linux-gcp-fips: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'ESM criteria, was needed')."
					}
				]
			}
		]
	}
}
