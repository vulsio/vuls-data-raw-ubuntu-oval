{
	"class": "vulnerability",
	"id": "oval:com.ubuntu.bionic:def:2021472290000000",
	"version": "1",
	"metadata": {
		"title": "CVE-2021-47229 on Ubuntu Pro FIPS 18.04 LTS (bionic) - medium",
		"description": "In the Linux kernel, the following vulnerability has been resolved: PCI:aardvark: Fix kernel panic during PIO transfer Trying to start a new PIOtransfer by writing value 0 in PIO_START register when previous transferhas not yet completed (which is indicated by value 1 in PIO_START) causesan External Abort on CPU, which results in kernel panic: SError Interrupton CPU0, code 0xbf000002 -- SError Kernel panic - not syncing: AsynchronousSError Interrupt To prevent kernel panic, it is required to reject a newPIO transfer when previous one has not finished yet. If previous PIOtransfer is not finished yet, the kernel may issue a new PIO request onlyif the previous PIO transfer timed out. In the past the root cause of thisissue was incorrectly identified (as it often happens during linkretraining or after link down event) and special hack was implemented inTrusted Firmware to catch all SError events in EL3, to ignore errors withcode 0xbf000002 and not forwarding any other errors to kernel and insteadthrow panic from EL3 Trusted Firmware handler. Links to discussion andpatches about this issue:https://git.trustedfirmware.org/TF-A/trusted-firmware-a.git/commit/?id=3c7dcdac5c50https://lore.kernel.org/linux-pci/20190316161243.29517-1-repk@triplefau.lt/https://lore.kernel.org/linux-pci/971be151d24312cc533989a64bd454b4@www.loen.fr/https://review.trustedfirmware.org/c/TF-A/trusted-firmware-a/+/1541 But thereal cause was the fact that during link retraining or after link downevent the PIO transfer may take longer time, up to the 1.44s until it timesout. This increased probability that a new PIO transfer would be issued bykernel while previous one has not finished yet. After applying this changeinto the kernel, it is possible to revert the mentioned TF-A hack andSError events do not have to be caught in TF-A EL3.\n\n    Update Instructions:\n\n    Run `sudo pro fix CVE-2021-47229` to fix the vulnerability. The problem can be corrected\n    by updating your system to the following package versions:\n\nlinux-image-4.15.0-156-generic - 4.15.0-156.163\nlinux-image-4.15.0-156-generic-lpae - 4.15.0-156.163\nlinux-image-4.15.0-156-lowlatency - 4.15.0-156.163\nlinux-image-unsigned-4.15.0-156-generic - 4.15.0-156.163\nlinux-image-unsigned-4.15.0-156-lowlatency - 4.15.0-156.163\nNo subscription required\n\nlinux-image-5.4.0-81-generic - 5.4.0-81.91~18.04.1\nlinux-image-5.4.0-81-generic-lpae - 5.4.0-81.91~18.04.1\nlinux-image-5.4.0-81-lowlatency - 5.4.0-81.91~18.04.1\nlinux-image-unsigned-5.4.0-81-generic - 5.4.0-81.91~18.04.1\nlinux-image-unsigned-5.4.0-81-lowlatency - 5.4.0-81.91~18.04.1\nNo subscription required\n\nlinux-image-4.15.0-1099-kvm - 4.15.0-1099.101\nNo subscription required\n\nlinux-image-4.15.0-1111-aws - 4.15.0-1111.118\nNo subscription required\n\nlinux-image-5.4.0-1055-aws - 5.4.0-1055.58~18.04.1\nNo subscription required\n\nlinux-image-unsigned-4.15.0-1123-azure - 4.15.0-1123.136\nNo subscription required\n\nlinux-image-unsigned-5.4.0-1056-azure - 5.4.0-1056.58~18.04.1\nNo subscription required\n\nlinux-image-unsigned-4.15.0-1108-gcp - 4.15.0-1108.122\nNo subscription required\n\nlinux-image-unsigned-5.4.0-1051-gcp - 5.4.0-1051.55~18.04.1\nNo subscription required\n\nlinux-image-unsigned-5.4.0-1010-ibm - 5.4.0-1010.11~18.04.2\nNo subscription required\n\nlinux-image-unsigned-4.15.0-1080-oracle - 4.15.0-1080.88\nNo subscription required\n\nlinux-image-unsigned-5.4.0-1053-oracle - 5.4.0-1053.57~18.04.1\nNo subscription required\n\nlinux-image-5.4.0-1042-raspi - 5.4.0-1042.46~18.04.3\nNo subscription required",
		"affected": {
			"family": "unix",
			"platform": "Ubuntu Pro FIPS 18.04 LTS"
		},
		"reference": {
			"source": "CVE",
			"ref_id": "CVE-2021-47229",
			"ref_url": "https://www.cve.org/CVERecord?id=CVE-2021-47229"
		},
		"advisory": {
			"severity": "Medium",
			"rights": "Copyright (C) 2024 Canonical Ltd.",
			"public_date": "2024-05-21 15:15:00 UTC",
			"cve": {
				"text": "CVE-2021-47229",
				"href": "https://ubuntu.com/security/CVE-2021-47229",
				"public": "20240521"
			}
		}
	},
	"notes": {},
	"criteria": {
		"criterias": [
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:2021346930000000",
						"comment": "linux package in bionic was vulnerable but has been fixed (note: '4.15.0-156.163')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000040",
						"comment": "linux-hwe: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'replaced by linux-hwe-5.4')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:2021346930000010",
						"comment": "linux-hwe-5.4 package in bionic was vulnerable but has been fixed (note: '5.4.0-81.91~18.04.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:2021346930000020",
						"comment": "linux-kvm package in bionic was vulnerable but has been fixed (note: '4.15.0-1099.101')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:2021346930000030",
						"comment": "linux-aws package in bionic was vulnerable but has been fixed (note: '4.15.0-1111.118')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000150",
						"comment": "linux-aws-5.0: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-aws-5.3')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000200",
						"comment": "linux-aws-5.3: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-aws-5.4')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:2019194490000120",
						"comment": "linux-aws-5.4 package in bionic was vulnerable but has been fixed (note: '5.4.0-1055.58~18.04.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000070",
						"comment": "linux-azure: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-azure-5.3')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:2021346930000040",
						"comment": "linux-azure-4.15 package in bionic was vulnerable but has been fixed (note: '4.15.0-1123.136')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201585530000000",
						"comment": "linux-azure-5.3: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-azure-5.4')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:2021346930000050",
						"comment": "linux-azure-5.4 package in bionic was vulnerable but has been fixed (note: '5.4.0-1056.58~18.04.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000350",
						"comment": "linux-fips: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'ESM criteria, was needed')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000320",
						"comment": "linux-aws-fips: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'ESM criteria, was needed')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000330",
						"comment": "linux-azure-fips: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'ESM criteria, was needed')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000340",
						"comment": "linux-gcp-fips: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'ESM criteria, was needed')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000080",
						"comment": "linux-gcp: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-gcp-5.3')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:2021346930000060",
						"comment": "linux-gcp-4.15 package in bionic was vulnerable but has been fixed (note: '4.15.0-1108.122')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000130",
						"comment": "linux-gcp-5.3: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-gcp-5.4')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:2021346930000070",
						"comment": "linux-gcp-5.4 package in bionic was vulnerable but has been fixed (note: '5.4.0-1051.55~18.04.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000050",
						"comment": "linux-gke-4.15: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-gke-5.0')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000280",
						"comment": "linux-gke-5.4: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of kernel support')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000290",
						"comment": "linux-gkeop-5.4: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of kernel support')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201499000000020",
						"comment": "linux-ibm-5.4 package in bionic, is related to the CVE in some way and has been fixed (note: '5.4.0-1010.11~18.04.2')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:2021346930000100",
						"comment": "linux-oracle package in bionic was vulnerable but has been fixed (note: '4.15.0-1080.88')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000140",
						"comment": "linux-oracle-5.0: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-oracle-5.3')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000180",
						"comment": "linux-oracle-5.3: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-oracle-5.4')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:202109200000060",
						"comment": "linux-oracle-5.4 package in bionic was vulnerable but has been fixed (note: '5.4.0-1053.57~18.04.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000100",
						"comment": "linux-oem: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'replaced by linux-hwe-5.4')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000010",
						"comment": "linux-raspi2: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of standard support')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:2021346930000120",
						"comment": "linux-raspi-5.4 package in bionic was vulnerable but has been fixed (note: '5.4.0-1042.46~18.04.3')."
					}
				]
			}
		]
	}
}
