{
	"class": "vulnerability",
	"id": "oval:com.ubuntu.bionic:def:2023526350000000",
	"version": "1",
	"metadata": {
		"title": "CVE-2023-52635 on Ubuntu 18.04 LTS (bionic) - medium",
		"description": "In the Linux kernel, the following vulnerability has been resolved:PM / devfreq: Synchronize devfreq_monitor_[start/stop]There is a chance if a frequent switch of the governordone in a loop result in timer list corruption wheretimer cancel being done from two place one fromcancel_delayed_work_sync() and followed by expire_timers()can be seen from the traces[1].while truedo        echo \"simple_ondemand\" > /sys/class/devfreq/1d84000.ufshc/governor        echo \"performance\" > /sys/class/devfreq/1d84000.ufshc/governordoneIt looks to be issue with devfreq driver wheredevice_monitor_[start/stop] need to synchronized so thatdelayed work should get corrupted while it is eitherbeing queued or running or being cancelled.Let's use polling flag and devfreq lock to synchronize thequeueing the timer instance twice and work data beingcorrupted.[1].....<idle>-0    [003]   9436.209662:  timer_cancel   timer=0xffffff80444f0428<idle>-0    [003]   9436.209664:  timer_expire_entrytimer=0xffffff80444f0428  now=0x10022da1cfunction=__typeid__ZTSFvP10timer_listE_global_addr  baseclk=0x10022da1c<idle>-0    [003]   9436.209718:  timer_expire_exittimer=0xffffff80444f0428kworker/u16:6-14217    [003]   9436.209863:  timer_starttimer=0xffffff80444f0428function=__typeid__ZTSFvP10timer_listE_global_addr  expires=0x10022da2bnow=0x10022da1c  flags=182452227vendor.xxxyyy.ha-1593    [004]   9436.209888:  timer_canceltimer=0xffffff80444f0428vendor.xxxyyy.ha-1593    [004]   9436.216390:  timer_inittimer=0xffffff80444f0428vendor.xxxyyy.ha-1593    [004]   9436.216392:  timer_starttimer=0xffffff80444f0428function=__typeid__ZTSFvP10timer_listE_global_addr  expires=0x10022da2cnow=0x10022da1d  flags=186646532vendor.xxxyyy.ha-1593    [005]   9436.220992:  timer_canceltimer=0xffffff80444f0428xxxyyyTraceManag-7795    [004]   9436.261641:  timer_canceltimer=0xffffff80444f0428[2] 9436.261653][    C4] Unable to handle kernel paging request at virtualaddress dead00000000012a[ 9436.261664][    C4] Mem abort info:[ 9436.261666][    C4]   ESR = 0x96000044[ 9436.261669][    C4]   EC = 0x25: DABT (current EL), IL = 32 bits[ 9436.261671][    C4]   SET = 0, FnV = 0[ 9436.261673][    C4]   EA = 0, S1PTW = 0[ 9436.261675][    C4] Data abort info:[ 9436.261677][    C4]   ISV = 0, ISS = 0x00000044[ 9436.261680][    C4]   CM = 0, WnR = 1[ 9436.261682][    C4] [dead00000000012a] address between user and kerneladdress ranges[ 9436.261685][    C4] Internal error: Oops: 96000044 [#1] PREEMPT SMP[ 9436.261701][    C4] Skip md ftrace buffer dump for: 0x3a982d0...[ 9436.262138][    C4] CPU: 4 PID: 7795 Comm: TraceManag Tainted: G SW  O      5.10.149-android12-9-o-g17f915d29d0c #1[ 9436.262141][    C4] Hardware name: Qualcomm Technologies, Inc.  (DT)[ 9436.262144][    C4] pstate: 22400085 (nzCv daIf +PAN -UAO +TCO BTYPE=--)[ 9436.262161][    C4] pc : expire_timers+0x9c/0x438[ 9436.262164][    C4] lr : expire_timers+0x2a4/0x438[ 9436.262168][    C4] sp : ffffffc010023dd0[ 9436.262171][    C4] x29: ffffffc010023df0 x28: ffffffd0636fdc18[ 9436.262178][    C4] x27: ffffffd063569dd0 x26: ffffffd063536008[ 9436.262182][    C4] x25: 0000000000000001 x24: ffffff88f7c69280[ 9436.262185][    C4] x23: 00000000000000e0 x22: dead000000000122[ 9436.262188][    C4] x21: 000000010022da29 x20: ffffff8af72b4e80[ 9436.262191][    C4] x19: ffffffc010023e50 x18: ffffffc010025038[ 9436.262195][    C4] x17: 0000000000000240 x16: 0000000000000201[ 9436.262199][    C4] x15: ffffffffffffffff x14: ffffff889f3c3100[ 9436.262203][    C4] x13: ffffff889f3c3100 x12: 00000000049f56b8[ 9436.262207][    C4] x11: 00000000049f56b8 x10: 00000000ffffffff[ 9436.262212][    C4] x9 : ffffffc010023e50 x8 : dead000000000122[ 9436.262216][    C4] x7 : ffffffffffffffff x6 : ffffffc0100239d8[ 9436.262220][    C4] x5 : 0000000000000000 x4 : 0000000000000101[ 9436.262223][    C4] x3 : 0000000000000080 x2 : ffffff8---truncated---",
		"affected": {
			"family": "unix",
			"platform": "Ubuntu 18.04 LTS"
		},
		"reference": {
			"source": "CVE",
			"ref_id": "CVE-2023-52635",
			"ref_url": "https://www.cve.org/CVERecord?id=CVE-2023-52635"
		},
		"advisory": {
			"severity": "Medium",
			"rights": "Copyright (C) 2024 Canonical Ltd.",
			"public_date": "2024-04-02 07:15:00 UTC",
			"cve": {
				"text": "CVE-2023-52635",
				"href": "https://ubuntu.com/security/CVE-2023-52635",
				"public": "20240402"
			}
		}
	},
	"notes": {},
	"criteria": {
		"criterias": [
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000000",
						"comment": "linux package in bionic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000040",
						"comment": "linux-hwe: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'replaced by linux-hwe-5.4')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000220",
						"comment": "linux-hwe-5.4 package in bionic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000090",
						"comment": "linux-kvm package in bionic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000030",
						"comment": "linux-aws package in bionic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000150",
						"comment": "linux-aws-5.0: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-aws-5.3')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000200",
						"comment": "linux-aws-5.3: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-aws-5.4')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000270",
						"comment": "linux-aws-5.4 package in bionic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000070",
						"comment": "linux-azure: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-azure-5.3')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000190",
						"comment": "linux-azure-4.15 package in bionic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201585530000000",
						"comment": "linux-azure-5.3: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-azure-5.4')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000240",
						"comment": "linux-azure-5.4 package in bionic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000080",
						"comment": "linux-gcp: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-gcp-5.3')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000210",
						"comment": "linux-gcp-4.15 package in bionic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000130",
						"comment": "linux-gcp-5.3: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-gcp-5.4')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000260",
						"comment": "linux-gcp-5.4 package in bionic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000050",
						"comment": "linux-gke-4.15: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-gke-5.0')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000280",
						"comment": "linux-gke-5.4: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of kernel support')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000290",
						"comment": "linux-gkeop-5.4: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of kernel support')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000310",
						"comment": "linux-ibm-5.4 package in bionic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000110",
						"comment": "linux-oracle package in bionic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000140",
						"comment": "linux-oracle-5.0: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-oracle-5.3')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000180",
						"comment": "linux-oracle-5.3: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-oracle-5.4')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000250",
						"comment": "linux-oracle-5.4 package in bionic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000100",
						"comment": "linux-oem: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'replaced by linux-hwe-5.4')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000230",
						"comment": "linux-raspi-5.4 package in bionic is affected and may need fixing."
					}
				]
			}
		]
	}
}
