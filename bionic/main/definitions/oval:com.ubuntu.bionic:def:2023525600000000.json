{
	"class": "vulnerability",
	"id": "oval:com.ubuntu.bionic:def:2023525600000000",
	"version": "1",
	"metadata": {
		"title": "CVE-2023-52560 on Ubuntu 18.04 LTS (bionic) - medium",
		"description": "In the Linux kernel, the following vulnerability has been resolved:mm/damon/vaddr-test: fix memory leak in damon_do_test_apply_three_regions()When CONFIG_DAMON_VADDR_KUNIT_TEST=y and making CONFIG_DEBUG_KMEMLEAK=y andCONFIG_DEBUG_KMEMLEAK_AUTO_SCAN=y, the below memory leak is detected. Sincecommit 9f86d624292c (\"mm/damon/vaddr-test: remove unnecessary variables\"),the damon_destroy_ctx() is removed, but still call damon_new_target() anddamon_new_region(), the damon_region which is allocated bykmem_cache_alloc() in damon_new_region() and the damon_target which isallocated by kmalloc in damon_new_target() are not freed. And thedamon_region which is allocated in damon_new_region() indamon_set_regions() is also not freed. So use damon_destroy_target to freeall the damon_regions and damon_target. unreferenced object0xffff888107c9a940 (size 64): comm \"kunit_try_catch\", pid 1069, jiffies4294670592 (age 732.761s) hex dump (first 32 bytes): 00 00 00 00 00 00 0000 06 00 00 00 6b 6b 6b 6b ............kkkk 60 c7 9c 07 81 88 ff ff f8 cb9c 07 81 88 ff ff `............... backtrace: [<ffffffff817e0167>]kmalloc_trace+0x27/0xa0 [<ffffffff819c11cf>] damon_new_target+0x3f/0x1b0[<ffffffff819c7d55>]damon_do_test_apply_three_regions.constprop.0+0x95/0x3e0[<ffffffff819c82be>] damon_test_apply_three_regions1+0x21e/0x260[<ffffffff829fce6a>] kunit_generic_run_threadfn_adapter+0x4a/0x90[<ffffffff81237cf6>] kthread+0x2b6/0x380 [<ffffffff81097add>]ret_from_fork+0x2d/0x70 [<ffffffff81003791>] ret_from_fork_asm+0x11/0x20unreferenced object 0xffff8881079cc740 (size 56): comm \"kunit_try_catch\",pid 1069, jiffies 4294670592 (age 732.761s) hex dump (first 32 bytes): 0500 00 00 00 00 00 00 14 00 00 00 00 00 00 00 ................ 6b 6b 6b 6b6b 6b 6b 6b 00 00 00 00 6b 6b 6b 6b kkkkkkkk....kkkk backtrace:[<ffffffff819bc492>] damon_new_region+0x22/0x1c0 [<ffffffff819c7d91>]damon_do_test_apply_three_regions.constprop.0+0xd1/0x3e0[<ffffffff819c82be>] damon_test_apply_three_regions1+0x21e/0x260[<ffffffff829fce6a>] kunit_generic_run_threadfn_adapter+0x4a/0x90[<ffffffff81237cf6>] kthread+0x2b6/0x380 [<ffffffff81097add>]ret_from_fork+0x2d/0x70 [<ffffffff81003791>] ret_from_fork_asm+0x11/0x20unreferenced object 0xffff888107c9ac40 (size 64): comm \"kunit_try_catch\",pid 1071, jiffies 4294670595 (age 732.843s) hex dump (first 32 bytes): 0000 00 00 00 00 00 00 06 00 00 00 6b 6b 6b 6b ............kkkk a0 cc 9c 0781 88 ff ff 78 a1 76 07 81 88 ff ff ........x.v..... backtrace:[<ffffffff817e0167>] kmalloc_trace+0x27/0xa0 [<ffffffff819c11cf>]damon_new_target+0x3f/0x1b0 [<ffffffff819c7d55>]damon_do_test_apply_three_regions.constprop.0+0x95/0x3e0[<ffffffff819c851e>] damon_test_apply_three_regions2+0x21e/0x260[<ffffffff829fce6a>] kunit_generic_run_threadfn_adapter+0x4a/0x90[<ffffffff81237cf6>] kthread+0x2b6/0x380 [<ffffffff81097add>]ret_from_fork+0x2d/0x70 [<ffffffff81003791>] ret_from_fork_asm+0x11/0x20unreferenced object 0xffff8881079ccc80 (size 56): comm \"kunit_try_catch\",pid 1071, jiffies 4294670595 (age 732.843s) hex dump (first 32 bytes): 0500 00 00 00 00 00 00 14 00 00 00 00 00 00 00 ................ 6b 6b 6b 6b6b 6b 6b 6b 00 00 00 00 6b 6b 6b 6b kkkkkkkk....kkkk backtrace:[<ffffffff819bc492>] damon_new_region+0x22/0x1c0 [<ffffffff819c7d91>]damon_do_test_apply_three_regions.constprop.0+0xd1/0x3e0[<ffffffff819c851e>] damon_test_apply_three_regions2+0x21e/0x260[<ffffffff829fce6a>] kunit_generic_run_threadfn_adapter+0x4a/0x90[<ffffffff81237cf6>] kthread+0x2b6/0x380 [<ffffffff81097add>]ret_from_fork+0x2d/0x70 [<ffff ---truncated---\n\n    Update Instructions:\n\n    Run `sudo pro fix CVE-2023-52560` to fix the vulnerability. The problem can be corrected\n    by updating your system to the following package versions:\n\nlinux-image-4.15.0-214-generic - 4.13.0-16.19\nlinux-image-4.15.0-214-generic-lpae - 4.13.0-16.19\nlinux-image-4.15.0-214-lowlatency - 4.13.0-16.19\nlinux-image-unsigned-4.15.0-214-generic - 4.13.0-16.19\nlinux-image-unsigned-4.15.0-214-lowlatency - 4.13.0-16.19\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro\n\nlinux-image-5.4.0-152-generic - 5.4.0-37.41~18.04.1\nlinux-image-5.4.0-152-generic-lpae - 5.4.0-37.41~18.04.1\nlinux-image-5.4.0-152-lowlatency - 5.4.0-37.41~18.04.1\nlinux-image-unsigned-5.4.0-152-generic - 5.4.0-37.41~18.04.1\nlinux-image-unsigned-5.4.0-152-lowlatency - 5.4.0-37.41~18.04.1\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro\n\nlinux-image-4.15.0-1143-kvm - 4.15.0-1002.2\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro\n\nlinux-image-unsigned-4.15.0-1159-aws - 4.15.0-1001.1\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro\n\nlinux-image-unsigned-5.4.0-1104-aws - 5.4.0-1018.18~18.04.1\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro\n\nlinux-image-unsigned-4.15.0-1168-azure - 4.15.0-1082.92\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro\n\nlinux-image-unsigned-5.4.0-1110-azure - 5.4.0-1020.20~18.04.1\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro\n\nlinux-image-unsigned-4.15.0-1153-gcp - 4.15.0-1071.81\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro\n\nlinux-image-unsigned-5.4.0-1107-gcp - 5.4.0-1019.19~18.04.2\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro\n\nlinux-image-unsigned-5.4.0-1051-ibm - 5.4.0-1010.11~18.04.2\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro\n\nlinux-image-unsigned-4.15.0-1122-oracle - 4.15.0-1007.9\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro\n\nlinux-image-unsigned-5.4.0-1103-oracle - 5.4.0-1019.19~18.04.1\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro\n\nlinux-image-5.4.0-1088-raspi - 5.4.0-1013.13~18.04.1\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro",
		"affected": {
			"family": "unix",
			"platform": "Ubuntu 18.04 LTS"
		},
		"reference": {
			"source": "CVE",
			"ref_id": "CVE-2023-52560",
			"ref_url": "https://www.cve.org/CVERecord?id=CVE-2023-52560"
		},
		"advisory": {
			"severity": "Medium",
			"rights": "Copyright (C) 2024 Canonical Ltd.",
			"public_date": "2024-03-02 22:15:00 UTC",
			"cve": {
				"text": "CVE-2023-52560",
				"href": "https://ubuntu.com/security/CVE-2023-52560",
				"public": "20240302"
			}
		}
	},
	"notes": {},
	"criteria": {
		"criterias": [
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:200747740000000",
						"comment": "linux package in bionic, is related to the CVE in some way and has been fixed (note: '4.13.0-16.19')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000040",
						"comment": "linux-hwe: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'replaced by linux-hwe-5.4')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201325960000050",
						"comment": "linux-hwe-5.4 package in bionic, is related to the CVE in some way and has been fixed (note: '5.4.0-37.41~18.04.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:200747740000040",
						"comment": "linux-kvm package in bionic, is related to the CVE in some way and has been fixed (note: '4.15.0-1002.2')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:200747740000050",
						"comment": "linux-aws package in bionic, is related to the CVE in some way and has been fixed (note: '4.15.0-1001.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000150",
						"comment": "linux-aws-5.0: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-aws-5.3')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000200",
						"comment": "linux-aws-5.3: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-aws-5.4')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201325960000100",
						"comment": "linux-aws-5.4 package in bionic, is related to the CVE in some way and has been fixed (note: '5.4.0-1018.18~18.04.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000070",
						"comment": "linux-azure: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-azure-5.3')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201325960000010",
						"comment": "linux-azure-4.15 package in bionic, is related to the CVE in some way and has been fixed (note: '4.15.0-1082.92')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201585530000000",
						"comment": "linux-azure-5.3: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-azure-5.4')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201325960000070",
						"comment": "linux-azure-5.4 package in bionic, is related to the CVE in some way and has been fixed (note: '5.4.0-1020.20~18.04.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000080",
						"comment": "linux-gcp: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-gcp-5.3')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201325960000040",
						"comment": "linux-gcp-4.15 package in bionic, is related to the CVE in some way and has been fixed (note: '4.15.0-1071.81')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000130",
						"comment": "linux-gcp-5.3: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-gcp-5.4')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201325960000090",
						"comment": "linux-gcp-5.4 package in bionic, is related to the CVE in some way and has been fixed (note: '5.4.0-1019.19~18.04.2')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000050",
						"comment": "linux-gke-4.15: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-gke-5.0')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000280",
						"comment": "linux-gke-5.4: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of kernel support')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000290",
						"comment": "linux-gkeop-5.4: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of kernel support')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:2016107230000030",
						"comment": "linux-ibm-5.4 package in bionic, is related to the CVE in some way and has been fixed (note: '5.4.0-1010.11~18.04.2')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:200747740000110",
						"comment": "linux-oracle package in bionic, is related to the CVE in some way and has been fixed (note: '4.15.0-1007.9')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000140",
						"comment": "linux-oracle-5.0: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-oracle-5.3')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000180",
						"comment": "linux-oracle-5.3: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-oracle-5.4')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201325960000080",
						"comment": "linux-oracle-5.4 package in bionic, is related to the CVE in some way and has been fixed (note: '5.4.0-1019.19~18.04.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000100",
						"comment": "linux-oem: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'replaced by linux-hwe-5.4')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201325960000060",
						"comment": "linux-raspi-5.4 package in bionic, is related to the CVE in some way and has been fixed (note: '5.4.0-1013.13~18.04.1')."
					}
				]
			}
		]
	}
}
