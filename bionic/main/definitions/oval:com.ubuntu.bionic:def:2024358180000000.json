{
	"class": "vulnerability",
	"id": "oval:com.ubuntu.bionic:def:2024358180000000",
	"version": "1",
	"metadata": {
		"title": "CVE-2024-35818 on Ubuntu 18.04 LTS (bionic) - medium",
		"description": "In the Linux kernel, the following vulnerability has been resolved:LoongArch: Define the __io_aw() hook as mmiowb()Commit fb24ea52f78e0d595852e (\"drivers: Remove explicit invocations ofmmiowb()\") remove all mmiowb() in drivers, but it says:\"NOTE: mmiowb() has only ever guaranteed ordering in conjunction withspin_unlock(). However, pairing each mmiowb() removal in this patch withthe corresponding call to spin_unlock() is not at all trivial, so thereis a small chance that this change may regress any drivers incorrectlyrelying on mmiowb() to order MMIO writes between CPUs using lock-freesynchronisation.\"The mmio in radeon_ring_commit() is protected by a mutex rather than aspinlock, but in the mutex fastpath it behaves similar to spinlock. Wecan add mmiowb() calls in the radeon driver but the maintainer says hedoesn't like such a workaround, and radeon is not the only example ofmutex protected mmio.So we should extend the mmiowb tracking system from spinlock to mutex,and maybe other locking primitives. This is not easy and error prone, sowe solve it in the architectural code, by simply defining the __io_aw()hook as mmiowb(). And we no longer need to override queued_spin_unlock()so use the generic definition.Without this, we get such an error when run 'glxgears' on weak orderingarchitectures such as LoongArch:radeon 0000:04:00.0: ring 0 stalled for more than 10324msecradeon 0000:04:00.0: ring 3 stalled for more than 10240msecradeon 0000:04:00.0: GPU lockup (current fence id 0x000000000001f412 lastfence id 0x000000000001f414 on ring 3)radeon 0000:04:00.0: GPU lockup (current fence id 0x000000000000f940 lastfence id 0x000000000000f941 on ring 0)radeon 0000:04:00.0: scheduling IB failed (-35).[drm:radeon_gem_va_ioctl [radeon]] *ERROR* Couldn't update BO_VA (-35)radeon 0000:04:00.0: scheduling IB failed (-35).[drm:radeon_gem_va_ioctl [radeon]] *ERROR* Couldn't update BO_VA (-35)radeon 0000:04:00.0: scheduling IB failed (-35).[drm:radeon_gem_va_ioctl [radeon]] *ERROR* Couldn't update BO_VA (-35)radeon 0000:04:00.0: scheduling IB failed (-35).[drm:radeon_gem_va_ioctl [radeon]] *ERROR* Couldn't update BO_VA (-35)radeon 0000:04:00.0: scheduling IB failed (-35).[drm:radeon_gem_va_ioctl [radeon]] *ERROR* Couldn't update BO_VA (-35)radeon 0000:04:00.0: scheduling IB failed (-35).[drm:radeon_gem_va_ioctl [radeon]] *ERROR* Couldn't update BO_VA (-35)radeon 0000:04:00.0: scheduling IB failed (-35).[drm:radeon_gem_va_ioctl [radeon]] *ERROR* Couldn't update BO_VA (-35)",
		"affected": {
			"family": "unix",
			"platform": "Ubuntu 18.04 LTS"
		},
		"reference": {
			"source": "CVE",
			"ref_id": "CVE-2024-35818",
			"ref_url": "https://www.cve.org/CVERecord?id=CVE-2024-35818"
		},
		"advisory": {
			"severity": "Medium",
			"rights": "Copyright (C) 2024 Canonical Ltd.",
			"public_date": "2024-05-17 14:15:00 UTC",
			"cve": {
				"text": "CVE-2024-35818",
				"href": "https://ubuntu.com/security/CVE-2024-35818",
				"public": "20240517"
			}
		}
	},
	"notes": {},
	"criteria": {
		"criterias": [
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000000",
						"comment": "linux package in bionic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000040",
						"comment": "linux-hwe: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'replaced by linux-hwe-5.4')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000220",
						"comment": "linux-hwe-5.4 package in bionic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000090",
						"comment": "linux-kvm package in bionic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000030",
						"comment": "linux-aws package in bionic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000150",
						"comment": "linux-aws-5.0: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-aws-5.3')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000200",
						"comment": "linux-aws-5.3: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-aws-5.4')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000270",
						"comment": "linux-aws-5.4 package in bionic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000070",
						"comment": "linux-azure: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-azure-5.3')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000190",
						"comment": "linux-azure-4.15 package in bionic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201585530000000",
						"comment": "linux-azure-5.3: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-azure-5.4')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000240",
						"comment": "linux-azure-5.4 package in bionic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000080",
						"comment": "linux-gcp: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-gcp-5.3')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000210",
						"comment": "linux-gcp-4.15 package in bionic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000130",
						"comment": "linux-gcp-5.3: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-gcp-5.4')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000260",
						"comment": "linux-gcp-5.4 package in bionic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000050",
						"comment": "linux-gke-4.15: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-gke-5.0')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000280",
						"comment": "linux-gke-5.4: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of kernel support')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000290",
						"comment": "linux-gkeop-5.4: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of kernel support')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000310",
						"comment": "linux-ibm-5.4 package in bionic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000110",
						"comment": "linux-oracle package in bionic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000140",
						"comment": "linux-oracle-5.0: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-oracle-5.3')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000180",
						"comment": "linux-oracle-5.3: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-oracle-5.4')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000250",
						"comment": "linux-oracle-5.4 package in bionic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000100",
						"comment": "linux-oem: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'replaced by linux-hwe-5.4')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000230",
						"comment": "linux-raspi-5.4 package in bionic is affected and may need fixing."
					}
				]
			}
		]
	}
}
