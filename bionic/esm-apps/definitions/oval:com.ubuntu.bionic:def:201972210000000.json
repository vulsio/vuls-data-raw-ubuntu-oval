{
  "class": "vulnerability",
  "id": "oval:com.ubuntu.bionic:def:201972210000000",
  "version": "1",
  "metadata": {
    "Title": "CVE-2019-7221 on Ubuntu 18.04 ESM (bionic) - medium.",
    "Description": "The KVM implementation in the Linux kernel through 4.20.5 has a Use-after-Free. Jim Mattson and Felix Wilhelm discovered a use-after-free vulnerability in the KVM subsystem of the Linux kernel, when using nested virtual machines. A local attacker in a guest VM could use this to cause a denial of service (system crash) or possibly execute arbitrary code in the host system.\n\nUpdate Instructions:\n\nRun `sudo pro fix CVE-2019-7221` to fix the vulnerability. The problem can be corrected\nby updating your system to the following package versions:\n\nlinux-image-4.15.0-47-generic - 4.15.0-47.50\nlinux-image-4.15.0-47-generic-lpae - 4.15.0-47.50\nlinux-image-4.15.0-47-lowlatency - 4.15.0-47.50\nlinux-image-4.15.0-47-snapdragon - 4.15.0-47.50\nlinux-image-unsigned-4.15.0-47-generic - 4.15.0-47.50\nlinux-image-unsigned-4.15.0-47-lowlatency - 4.15.0-47.50\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro\n\nlinux-image-4.15.0-1035-aws - 4.15.0-1035.37\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro\n\nlinux-image-unsigned-4.18.0-1014-azure - 4.18.0-1014.14~18.04.1\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro\n\nlinux-image-unsigned-4.15.0-1029-gcp - 4.15.0-1029.31\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro\n\nlinux-image-4.18.0-17-generic - 4.18.0-17.18~18.04.1\nlinux-image-4.18.0-17-generic-lpae - 4.18.0-17.18~18.04.1\nlinux-image-4.18.0-17-lowlatency - 4.18.0-17.18~18.04.1\nlinux-image-4.18.0-17-snapdragon - 4.18.0-17.18~18.04.1\nlinux-image-unsigned-4.18.0-17-generic - 4.18.0-17.18~18.04.1\nlinux-image-unsigned-4.18.0-17-lowlatency - 4.18.0-17.18~18.04.1\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro\n\nlinux-image-4.15.0-1031-kvm - 4.15.0-1031.31\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro\n\nlinux-image-unsigned-4.15.0-1035-oem - 4.15.0-1035.40\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro\n\nlinux-image-unsigned-4.15.0-1010-oracle - 4.15.0-1010.12\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro\n\nlinux-image-4.15.0-1033-raspi2 - 4.15.0-1033.35\nNo subscription required\n\nlinux-image-4.15.0-47-generic - 4.15.0-47.50\nlinux-image-4.15.0-47-generic-lpae - 4.15.0-47.50\nlinux-image-4.15.0-47-lowlatency - 4.15.0-47.50\nlinux-image-4.15.0-47-snapdragon - 4.15.0-47.50\nlinux-image-unsigned-4.15.0-47-generic - 4.15.0-47.50\nlinux-image-unsigned-4.15.0-47-lowlatency - 4.15.0-47.50\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro\n\nlinux-image-4.15.0-1035-aws - 4.15.0-1035.37\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro\n\nlinux-image-unsigned-4.18.0-1014-azure - 4.18.0-1014.14~18.04.1\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro\n\nlinux-image-unsigned-4.15.0-1029-gcp - 4.15.0-1029.31\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro\n\nlinux-image-4.18.0-17-generic - 4.18.0-17.18~18.04.1\nlinux-image-4.18.0-17-generic-lpae - 4.18.0-17.18~18.04.1\nlinux-image-4.18.0-17-lowlatency - 4.18.0-17.18~18.04.1\nlinux-image-4.18.0-17-snapdragon - 4.18.0-17.18~18.04.1\nlinux-image-unsigned-4.18.0-17-generic - 4.18.0-17.18~18.04.1\nlinux-image-unsigned-4.18.0-17-lowlatency - 4.18.0-17.18~18.04.1\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro\n\nlinux-image-unsigned-4.15.0-1035-oem - 4.15.0-1035.40\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro\n\nlinux-image-unsigned-4.15.0-1010-oracle - 4.15.0-1010.12\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro\n\nlinux-image-4.15.0-1053-snapdragon - 4.15.0-1053.57\nNo subscription required",
    "affected": {
      "family": "unix",
      "Platform": "Ubuntu 18.04 ESM"
    },
    "reference": {
      "source": "CVE",
      "ref_id": "CVE-2019-7221",
      "ref_url": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-7221"
    },
    "advisory": {
      "Severity": "Medium",
      "Rights": "Copyright (C) 2019 Canonical Ltd.",
      "PublicDate": "2019-03-21",
      "Bug": [
        "https://bugs.chromium.org/p/project-zero/issues/detail?id=1760"
      ],
      "cve": {
        "text": "CVE-2019-7221",
        "href": "https://ubuntu.com/security/CVE-2019-7221",
        "public": "20190321",
        "cvss_score": "7.8",
        "cvss_vector": "CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
        "usns": "3930-1,3930-2,3931-1,3931-2,3932-1,3932-2"
      },
      "PublicDateAtUsn": "2019-03-21",
      "AssignedTo": "",
      "DiscoveredBy": "Jim Mattson and Felix Wilhelm",
      "Crd": "",
      "Ref": null
    }
  },
  "notes": {
    "Note": "tyhicks> Ubuntu kernels do not enable nested KVM virtualization by default and are unaffected by this flaw in the default configuration. However, installing QEMU results in nested KVM support to be enabled via the /etc/modprobe.d/qemu-system-x86.conf file. To ensure that nested virtualization is not enabled, verify that the /sys/module/kvm_intel/parameters/nested file contains \"N\"."
  },
  "criteria": {
    "criterias": [
      {
        "operator": "OR",
        "criterions": [
          {
            "test_ref": "oval:com.ubuntu.bionic:tst:201973080000000",
            "comment": "linux package in bionic was vulnerable but has been fixed (note: '4.15.0-47.50')."
          },
          {
            "test_ref": "oval:com.ubuntu.bionic:tst:201973080000010",
            "comment": "linux-aws package in bionic was vulnerable but has been fixed (note: '4.15.0-1035.37')."
          },
          {
            "test_ref": "oval:com.ubuntu.bionic:tst:201973080000050",
            "comment": "linux-azure package in bionic was vulnerable but has been fixed (note: '4.18.0-1014.14~18.04.1')."
          },
          {
            "test_ref": "oval:com.ubuntu.bionic:tst:201973080000100",
            "comment": "linux-gcp package in bionic was vulnerable but has been fixed (note: '4.15.0-1029.31')."
          },
          {
            "test_ref": "oval:com.ubuntu.bionic:tst:201973080000190",
            "comment": "linux-hwe package in bionic was vulnerable but has been fixed (note: '4.18.0-17.18~18.04.1')."
          },
          {
            "test_ref": "oval:com.ubuntu.bionic:tst:201973080000210",
            "comment": "linux-kvm package in bionic was vulnerable but has been fixed (note: '4.15.0-1031.31')."
          },
          {
            "test_ref": "oval:com.ubuntu.bionic:tst:201973080000220",
            "comment": "linux-oem package in bionic was vulnerable but has been fixed (note: '4.15.0-1035.40')."
          },
          {
            "test_ref": "oval:com.ubuntu.bionic:tst:201973080000240",
            "comment": "linux-oracle package in bionic was vulnerable but has been fixed (note: '4.15.0-1010.12')."
          },
          {
            "test_ref": "oval:com.ubuntu.bionic:tst:201973080000290",
            "comment": "linux-raspi2 package in bionic was vulnerable but has been fixed (note: '4.15.0-1033.35')."
          },
          {
            "test_ref": "oval:com.ubuntu.bionic:tst:201973080000310",
            "comment": "linux-signed package in bionic was vulnerable but has been fixed (note: '4.15.0-47.50')."
          },
          {
            "test_ref": "oval:com.ubuntu.bionic:tst:201973080000320",
            "comment": "linux-signed-aws package in bionic was vulnerable but has been fixed (note: '4.15.0-1035.37')."
          },
          {
            "test_ref": "oval:com.ubuntu.bionic:tst:201973080000340",
            "comment": "linux-signed-azure package in bionic was vulnerable but has been fixed (note: '4.18.0-1014.14~18.04.1')."
          },
          {
            "test_ref": "oval:com.ubuntu.bionic:tst:201973080000390",
            "comment": "linux-signed-gcp package in bionic was vulnerable but has been fixed (note: '4.15.0-1029.31')."
          },
          {
            "test_ref": "oval:com.ubuntu.bionic:tst:201973080000480",
            "comment": "linux-signed-hwe package in bionic was vulnerable but has been fixed (note: '4.18.0-17.18~18.04.1')."
          },
          {
            "test_ref": "oval:com.ubuntu.bionic:tst:201973080000500",
            "comment": "linux-signed-oem package in bionic was vulnerable but has been fixed (note: '4.15.0-1035.40')."
          },
          {
            "test_ref": "oval:com.ubuntu.bionic:tst:201973080000520",
            "comment": "linux-signed-oracle package in bionic was vulnerable but has been fixed (note: '4.15.0-1010.12')."
          },
          {
            "test_ref": "oval:com.ubuntu.bionic:tst:2018121260000600",
            "comment": "linux-snapdragon package in bionic was vulnerable but has been fixed (note: '4.15.0-1053.57')."
          }
        ]
      }
    ]
  }
}
