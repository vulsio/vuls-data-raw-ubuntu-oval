{
	"class": "vulnerability",
	"id": "oval:com.ubuntu.bionic:def:2021474360000000",
	"version": "1",
	"metadata": {
		"title": "CVE-2021-47436 on Ubuntu Pro FIPS 18.04 LTS (bionic) - medium",
		"description": "In the Linux kernel, the following vulnerability has been resolved: usb:musb: dsps: Fix the probe error path Commit 7c75bde329d7 (\"usb: musb:musb_dsps: request_irq() after initializing musb\") has inverted the callsto dsps_setup_optional_vbus_irq() and dsps_create_musb_pdev() withoutupdating correctly the error path. dsps_create_musb_pdev() allocates andregisters a new platform device which must be unregistered and freed withplatform_device_unregister(), and this is missing upondsps_setup_optional_vbus_irq() error. While on the master branch it seemsnot to trigger any issue, I observed a kernel crash because of a NULLpointer dereference with a v5.10.70 stable kernel where the patch mentionedabove was backported. With this kernel version, -EPROBE_DEFER is returnedthe first time dsps_setup_optional_vbus_irq() is called which triggers theprobe to error out without unregistering the platform device.Unfortunately, on the Beagle Bone Black Wireless, the platform device stillliving in the system is being used by the USB Ethernet gadget driver, whichduring the boot phase triggers the crash. My limited knowledge of the musbworld prevents me to revert this commit which was sent to silence a robotwarning which, as far as I understand, does not make sense. The goal ofthis patch was to prevent an IRQ to fire before the platform device beingregistered. I think this cannot ever happen due to the fact that enablingthe interrupts is done by the ->enable() callback of the platform musbdevice, and this platform device must be already registered in order forthe core or any other user to use this callback. Hence, I decided to fixthe error path, which might prevent future errors on mainline kernels whilealso fixing older ones.\n\n    Update Instructions:\n\n    Run `sudo pro fix CVE-2021-47436` to fix the vulnerability. The problem can be corrected\n    by updating your system to the following package versions:\n\nlinux-image-4.15.0-166-generic - 4.15.0-166.174\nlinux-image-4.15.0-166-generic-lpae - 4.15.0-166.174\nlinux-image-4.15.0-166-lowlatency - 4.15.0-166.174\nlinux-image-unsigned-4.15.0-166-generic - 4.15.0-166.174\nlinux-image-unsigned-4.15.0-166-lowlatency - 4.15.0-166.174\nNo subscription required\n\nlinux-image-5.4.0-92-generic - 5.4.0-92.103~18.04.2\nlinux-image-5.4.0-92-generic-lpae - 5.4.0-92.103~18.04.2\nlinux-image-5.4.0-92-lowlatency - 5.4.0-92.103~18.04.2\nlinux-image-unsigned-5.4.0-92-generic - 5.4.0-92.103~18.04.2\nlinux-image-unsigned-5.4.0-92-lowlatency - 5.4.0-92.103~18.04.2\nNo subscription required\n\nlinux-image-4.15.0-1105-kvm - 4.15.0-1105.107\nNo subscription required\n\nlinux-image-4.15.0-1118-aws - 4.15.0-1118.125\nNo subscription required\n\nlinux-image-unsigned-5.4.0-1061-aws - 5.4.0-1061.64~18.04.1\nNo subscription required\n\nlinux-image-unsigned-4.15.0-1129-azure - 4.15.0-1129.142\nNo subscription required\n\nlinux-image-unsigned-5.4.0-1065-azure - 5.4.0-1065.68~18.04.1\nNo subscription required\n\nlinux-image-4.15.0-1011-fips - 4.15.0-1011.12\nlinux-image-hmac-4.15.0-1011-fips - 4.15.0-1011.12\nlinux-image-unsigned-4.15.0-1011-fips - 4.15.0-1011.12\nlinux-image-unsigned-hmac-4.15.0-1011-fips - 4.15.0-1011.12\nAvailable with Ubuntu Pro: https://ubuntu.com/pro\n\nlinux-image-unsigned-4.15.0-2000-aws-fips - 4.15.0-2000.4\nlinux-image-unsigned-hmac-4.15.0-2000-aws-fips - 4.15.0-2000.4\nAvailable with Ubuntu Pro: https://ubuntu.com/pro\n\nlinux-image-unsigned-4.15.0-1002-azure-fips - 4.15.0-1002.2\nlinux-image-unsigned-hmac-4.15.0-1002-azure-fips - 4.15.0-1002.2\nAvailable with Ubuntu Pro: https://ubuntu.com/pro\n\nlinux-image-unsigned-4.15.0-1001-gcp-fips - 4.15.0-1001.1\nlinux-image-unsigned-hmac-4.15.0-1001-gcp-fips - 4.15.0-1001.1\nAvailable with Ubuntu Pro: https://ubuntu.com/pro\n\nlinux-image-unsigned-4.15.0-1114-gcp - 4.15.0-1114.128\nNo subscription required\n\nlinux-image-unsigned-5.4.0-1059-gcp - 5.4.0-1059.63~18.04.1\nNo subscription required\n\nlinux-image-unsigned-5.4.0-1010-ibm - 5.4.0-1010.11~18.04.2\nNo subscription required\n\nlinux-image-unsigned-4.15.0-1085-oracle - 4.15.0-1085.93\nNo subscription required\n\nlinux-image-unsigned-5.4.0-1059-oracle - 5.4.0-1059.63~18.04.1\nNo subscription required\n\nlinux-image-5.4.0-1048-raspi - 5.4.0-1048.53~18.04.1\nNo subscription required",
		"affected": {
			"family": "unix",
			"platform": "Ubuntu Pro FIPS 18.04 LTS"
		},
		"reference": {
			"source": "CVE",
			"ref_id": "CVE-2021-47436",
			"ref_url": "https://www.cve.org/CVERecord?id=CVE-2021-47436"
		},
		"advisory": {
			"severity": "Medium",
			"rights": "Copyright (C) 2024 Canonical Ltd.",
			"public_date": "2024-05-22 07:15:00 UTC",
			"cve": {
				"text": "CVE-2021-47436",
				"href": "https://ubuntu.com/security/CVE-2021-47436",
				"public": "20240522"
			}
		}
	},
	"notes": {},
	"criteria": {
		"criterias": [
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:2018250200000000",
						"comment": "linux package in bionic was vulnerable but has been fixed (note: '4.15.0-166.174')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000040",
						"comment": "linux-hwe: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'replaced by linux-hwe-5.4')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:2020265410000000",
						"comment": "linux-hwe-5.4 package in bionic was vulnerable but has been fixed (note: '5.4.0-92.103~18.04.2')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:2018250200000010",
						"comment": "linux-kvm package in bionic was vulnerable but has been fixed (note: '4.15.0-1105.107')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:2018250200000020",
						"comment": "linux-aws package in bionic was vulnerable but has been fixed (note: '4.15.0-1118.125')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000150",
						"comment": "linux-aws-5.0: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-aws-5.3')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000200",
						"comment": "linux-aws-5.3: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-aws-5.4')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:2020265410000010",
						"comment": "linux-aws-5.4 package in bionic was vulnerable but has been fixed (note: '5.4.0-1061.64~18.04.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000070",
						"comment": "linux-azure: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-azure-5.3')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:2018250200000030",
						"comment": "linux-azure-4.15 package in bionic was vulnerable but has been fixed (note: '4.15.0-1129.142')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201585530000000",
						"comment": "linux-azure-5.3: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-azure-5.4')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:2020265410000020",
						"comment": "linux-azure-5.4 package in bionic was vulnerable but has been fixed (note: '5.4.0-1065.68~18.04.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201431800000000",
						"comment": "linux-fips package in fips/bionic, is related to the CVE in some way and has been fixed (note: '4.15.0-1011.12')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201431800000010",
						"comment": "linux-aws-fips package in fips/bionic, is related to the CVE in some way and has been fixed (note: '4.15.0-2000.4')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:200747740000040",
						"comment": "linux-azure-fips package in fips/bionic, is related to the CVE in some way and has been fixed (note: '4.15.0-1002.2')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:200747740000050",
						"comment": "linux-gcp-fips package in fips/bionic, is related to the CVE in some way and has been fixed (note: '4.15.0-1001.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000080",
						"comment": "linux-gcp: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-gcp-5.3')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:2018250200000040",
						"comment": "linux-gcp-4.15 package in bionic was vulnerable but has been fixed (note: '4.15.0-1114.128')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000130",
						"comment": "linux-gcp-5.3: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-gcp-5.4')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:2020265410000030",
						"comment": "linux-gcp-5.4 package in bionic was vulnerable but has been fixed (note: '5.4.0-1059.63~18.04.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000050",
						"comment": "linux-gke-4.15: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-gke-5.0')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000280",
						"comment": "linux-gke-5.4: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of kernel support')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000290",
						"comment": "linux-gkeop-5.4: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of kernel support')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201431800000020",
						"comment": "linux-ibm-5.4 package in bionic, is related to the CVE in some way and has been fixed (note: '5.4.0-1010.11~18.04.2')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:2018250200000050",
						"comment": "linux-oracle package in bionic was vulnerable but has been fixed (note: '4.15.0-1085.93')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000140",
						"comment": "linux-oracle-5.0: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-oracle-5.3')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000180",
						"comment": "linux-oracle-5.3: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-oracle-5.4')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:2020265410000030",
						"comment": "linux-oracle-5.4 package in bionic was vulnerable but has been fixed (note: '5.4.0-1059.63~18.04.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000100",
						"comment": "linux-oem: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'replaced by linux-hwe-5.4')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000010",
						"comment": "linux-raspi2: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of standard support')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:2020265410000040",
						"comment": "linux-raspi-5.4 package in bionic was vulnerable but has been fixed (note: '5.4.0-1048.53~18.04.1')."
					}
				]
			}
		]
	}
}
