{
	"class": "vulnerability",
	"id": "oval:com.ubuntu.bionic:def:2022486520000000",
	"version": "1",
	"metadata": {
		"title": "CVE-2022-48652 on Ubuntu 18.04 LTS (bionic) - medium",
		"description": "In the Linux kernel, the following vulnerability has been resolved: ice:Fix crash by keep old cfg when update TCs more than queues There areproblems if allocated queues less than Traffic Classes. Commit a632b2a4c920(\"ice: ethtool: Prohibit improper channel config for DCB\") already disallowsetting less queues than TCs. Another case is if we first set less queues,and later update more TCs config due to LLDP, ice_vsi_cfg_tc() will failedbut left dirty num_txq/rxq and tc_cfg in vsi, that will cause invalidpointer access. [ 95.968089] ice 0000:3b:00.1: More TCs defined thanqueues/rings allocated. [ 95.968092] ice 0000:3b:00.1: Trying to use moreRx queues (8), than were allocated (1)! [ 95.968093] ice 0000:3b:00.1:Failed to config TC for VSI index: 0 [ 95.969621] general protection fault:0000 [#1] SMP NOPTI [ 95.969705] CPU: 1 PID: 58405 Comm: lldpad Kdump:loaded Tainted: G U W O --------- -t - 4.18.0 #1 [ 95.969867] Hardwarename: O.E.M/BC11SPSCB10, BIOS 8.23 12/30/2021 [ 95.969992] RIP:0010:devm_kmalloc+0xa/0x60 [ 95.970052] Code: 5c ff ff ff 31 c0 5b 5d 41 5cc3 b8 f4 ff ff ff eb f4 0f 1f 40 00 66 2e 0f 1f 84 00 00 00 00 00 0f 1f 4400 00 48 89 f8 89 d1 <8b> 97 60 02 00 00 48 8d 7e 18 48 39 f7 72 3f 55 89ce 53 48 8b 4c [ 95.970344] RSP: 0018:ffffc9003f553888 EFLAGS: 00010206 [95.970425] RAX: dead000000000200 RBX: ffffea003c425b00 RCX:00000000006080c0 [ 95.970536] RDX: 00000000006080c0 RSI: 0000000000000200RDI: dead000000000200 [ 95.970648] RBP: dead000000000200 R08:00000000000463c0 R09: ffff888ffa900000 [ 95.970760] R10: 0000000000000000R11: 0000000000000002 R12: ffff888ff6b40100 [ 95.970870] R13:ffff888ff6a55018 R14: 0000000000000000 R15: ffff888ff6a55460 [ 95.970981]FS: 00007f51b7d24700(0000) GS:ffff88903ee80000(0000) knlGS:0000000000000000[ 95.971108] CS: 0010 DS: 0000 ES: 0000 CR0: 0000000080050033 [ 95.971197]CR2: 00007fac5410d710 CR3: 0000000f2c1de002 CR4: 00000000007606e0 [95.971309] DR0: 0000000000000000 DR1: 0000000000000000 DR2:0000000000000000 [ 95.971419] DR3: 0000000000000000 DR6: 00000000fffe0ff0DR7: 0000000000000400 [ 95.971530] PKRU: 55555554 [ 95.971573] Call Trace:[ 95.971622] ice_setup_rx_ring+0x39/0x110 [ice] [ 95.971695]ice_vsi_setup_rx_rings+0x54/0x90 [ice] [ 95.971774] ice_vsi_open+0x25/0x120[ice] [ 95.971843] ice_open_internal+0xb8/0x1f0 [ice] [ 95.971919]ice_ena_vsi+0x4f/0xd0 [ice] [ 95.971987]ice_dcb_ena_dis_vsi.constprop.5+0x29/0x90 [ice] [ 95.972082]ice_pf_dcb_cfg+0x29a/0x380 [ice] [ 95.972154] ice_dcbnl_setets+0x174/0x1b0[ice] [ 95.972220] dcbnl_ieee_set+0x89/0x230 [ 95.972279] ?dcbnl_ieee_del+0x150/0x150 [ 95.972341] dcb_doit+0x124/0x1b0 [ 95.972392]rtnetlink_rcv_msg+0x243/0x2f0 [ 95.972457] ? dcb_doit+0x14d/0x1b0 [95.972510] ? __kmalloc_node_track_caller+0x1d3/0x280 [ 95.972591] ?rtnl_calcit.isra.31+0x100/0x100 [ 95.972661] netlink_rcv_skb+0xcf/0xf0 [95.972720] netlink_unicast+0x16d/0x220 [ 95.972781]netlink_sendmsg+0x2ba/0x3a0 [ 95.975891] sock_sendmsg+0x4c/0x50 [95.979032] ___sys_sendmsg+0x2e4/0x300 [ 95.982147] ?kmem_cache_alloc+0x13e/0x190 [ 95.985242] ? __wake_up_common_lock+0x79/0x90[ 95.988338] ? __check_object_size+0xac/0x1b0 [ 95.991440] ?_copy_to_user+0x22/0x30 [ 95.994539] ? move_addr_to_user+0xbb/0xd0 [95.997619] ? __sys_sendmsg+0x53/0x80 [ 96.000664] __sys_sendmsg+0x53/0x80 [96.003747] do_syscall_64+0x5b/0x1d0 [ 96.006862]entry_SYSCALL_64_after_hwframe+0x65/0xca Only update num_txq/rxq whenpassed check, and restore tc_cfg if setup queue map failed.\n\n    Update Instructions:\n\n    Run `sudo pro fix CVE-2022-48652` to fix the vulnerability. The problem can be corrected\n    by updating your system to the following package versions:\n\nlinux-image-4.15.0-214-generic - 4.13.0-16.19\nlinux-image-4.15.0-214-generic-lpae - 4.13.0-16.19\nlinux-image-4.15.0-214-lowlatency - 4.13.0-16.19\nlinux-image-unsigned-4.15.0-214-generic - 4.13.0-16.19\nlinux-image-unsigned-4.15.0-214-lowlatency - 4.13.0-16.19\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro\n\nlinux-image-5.4.0-152-generic - 5.4.0-37.41~18.04.1\nlinux-image-5.4.0-152-generic-lpae - 5.4.0-37.41~18.04.1\nlinux-image-5.4.0-152-lowlatency - 5.4.0-37.41~18.04.1\nlinux-image-unsigned-5.4.0-152-generic - 5.4.0-37.41~18.04.1\nlinux-image-unsigned-5.4.0-152-lowlatency - 5.4.0-37.41~18.04.1\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro\n\nlinux-image-4.15.0-1143-kvm - 4.15.0-1002.2\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro\n\nlinux-image-unsigned-4.15.0-1159-aws - 4.15.0-1001.1\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro\n\nlinux-image-unsigned-5.4.0-1104-aws - 5.4.0-1018.18~18.04.1\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro\n\nlinux-image-unsigned-4.15.0-1168-azure - 4.15.0-1082.92\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro\n\nlinux-image-unsigned-5.4.0-1110-azure - 5.4.0-1020.20~18.04.1\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro\n\nlinux-image-unsigned-4.15.0-1153-gcp - 4.15.0-1071.81\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro\n\nlinux-image-unsigned-5.4.0-1107-gcp - 5.4.0-1019.19~18.04.2\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro\n\nlinux-image-unsigned-5.4.0-1051-ibm - 5.4.0-1010.11~18.04.2\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro\n\nlinux-image-unsigned-4.15.0-1122-oracle - 4.15.0-1007.9\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro\n\nlinux-image-unsigned-5.4.0-1103-oracle - 5.4.0-1019.19~18.04.1\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro\n\nlinux-image-5.4.0-1088-raspi - 5.4.0-1013.13~18.04.1\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro",
		"affected": {
			"family": "unix",
			"platform": "Ubuntu 18.04 LTS"
		},
		"reference": {
			"source": "CVE",
			"ref_id": "CVE-2022-48652",
			"ref_url": "https://www.cve.org/CVERecord?id=CVE-2022-48652"
		},
		"advisory": {
			"severity": "Medium",
			"rights": "Copyright (C) 2024 Canonical Ltd.",
			"public_date": "2024-04-28 13:15:00 UTC",
			"cve": {
				"text": "CVE-2022-48652",
				"href": "https://ubuntu.com/security/CVE-2022-48652",
				"public": "20240428"
			}
		}
	},
	"notes": {},
	"criteria": {
		"criterias": [
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:200747740000000",
						"comment": "linux package in bionic, is related to the CVE in some way and has been fixed (note: '4.13.0-16.19')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000040",
						"comment": "linux-hwe: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'replaced by linux-hwe-5.4')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201325960000050",
						"comment": "linux-hwe-5.4 package in bionic, is related to the CVE in some way and has been fixed (note: '5.4.0-37.41~18.04.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:200747740000040",
						"comment": "linux-kvm package in bionic, is related to the CVE in some way and has been fixed (note: '4.15.0-1002.2')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:200747740000050",
						"comment": "linux-aws package in bionic, is related to the CVE in some way and has been fixed (note: '4.15.0-1001.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000150",
						"comment": "linux-aws-5.0: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-aws-5.3')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000200",
						"comment": "linux-aws-5.3: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-aws-5.4')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201325960000100",
						"comment": "linux-aws-5.4 package in bionic, is related to the CVE in some way and has been fixed (note: '5.4.0-1018.18~18.04.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000070",
						"comment": "linux-azure: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-azure-5.3')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201325960000010",
						"comment": "linux-azure-4.15 package in bionic, is related to the CVE in some way and has been fixed (note: '4.15.0-1082.92')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201585530000000",
						"comment": "linux-azure-5.3: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-azure-5.4')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201325960000070",
						"comment": "linux-azure-5.4 package in bionic, is related to the CVE in some way and has been fixed (note: '5.4.0-1020.20~18.04.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000080",
						"comment": "linux-gcp: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-gcp-5.3')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201325960000040",
						"comment": "linux-gcp-4.15 package in bionic, is related to the CVE in some way and has been fixed (note: '4.15.0-1071.81')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000130",
						"comment": "linux-gcp-5.3: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-gcp-5.4')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201325960000090",
						"comment": "linux-gcp-5.4 package in bionic, is related to the CVE in some way and has been fixed (note: '5.4.0-1019.19~18.04.2')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000050",
						"comment": "linux-gke-4.15: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-gke-5.0')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000280",
						"comment": "linux-gke-5.4: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of kernel support')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000290",
						"comment": "linux-gkeop-5.4: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of kernel support')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201431800000000",
						"comment": "linux-ibm-5.4 package in bionic, is related to the CVE in some way and has been fixed (note: '5.4.0-1010.11~18.04.2')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:200747740000110",
						"comment": "linux-oracle package in bionic, is related to the CVE in some way and has been fixed (note: '4.15.0-1007.9')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000140",
						"comment": "linux-oracle-5.0: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-oracle-5.3')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000180",
						"comment": "linux-oracle-5.3: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-oracle-5.4')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201325960000080",
						"comment": "linux-oracle-5.4 package in bionic, is related to the CVE in some way and has been fixed (note: '5.4.0-1019.19~18.04.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000100",
						"comment": "linux-oem: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'replaced by linux-hwe-5.4')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201325960000060",
						"comment": "linux-raspi-5.4 package in bionic, is related to the CVE in some way and has been fixed (note: '5.4.0-1013.13~18.04.1')."
					}
				]
			}
		]
	}
}
