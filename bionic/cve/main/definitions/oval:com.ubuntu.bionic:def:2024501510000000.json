{
	"class": "vulnerability",
	"id": "oval:com.ubuntu.bionic:def:2024501510000000",
	"version": "1",
	"metadata": {
		"title": "CVE-2024-50151 on Ubuntu 18.04 LTS (bionic) - medium",
		"description": "In the Linux kernel, the following vulnerability has been resolved:smb: client: fix OOBs when building SMB2_IOCTL requestWhen using encryption, either enforced by the server or when using'seal' mount option, the client will squash all compound request buffersdown for encryption into a single iov in smb2_set_next_command().SMB2_ioctl_init() allocates a small buffer (448 bytes) to hold theSMB2_IOCTL request in the first iov, and if the user passes an inputbuffer that is greater than 328 bytes, smb2_set_next_command() willend up writing off the end of @rqst->iov[0].iov_base as shown below:  mount.cifs //srv/share /mnt -o ...,seal  ln -s $(perl -e \"print('a')for 1..1024\") /mnt/link  BUG: KASAN: slab-out-of-bounds in  smb2_set_next_command.cold+0x1d6/0x24c [cifs]  Write of size 4116 at addr ffff8881148fcab8 by task ln/859  CPU: 1 UID: 0 PID: 859 Comm: ln Not tainted 6.12.0-rc3 #1  Hardware name: QEMU Standard PC (Q35 + ICH9, 2009), BIOS  1.16.3-2.fc40 04/01/2014  Call Trace:   <TASK>   dump_stack_lvl+0x5d/0x80   ? smb2_set_next_command.cold+0x1d6/0x24c [cifs]   print_report+0x156/0x4d9   ? smb2_set_next_command.cold+0x1d6/0x24c [cifs]   ? __virt_addr_valid+0x145/0x310   ? __phys_addr+0x46/0x90   ? smb2_set_next_command.cold+0x1d6/0x24c [cifs]   kasan_report+0xda/0x110   ? smb2_set_next_command.cold+0x1d6/0x24c [cifs]   kasan_check_range+0x10f/0x1f0   __asan_memcpy+0x3c/0x60   smb2_set_next_command.cold+0x1d6/0x24c [cifs]   smb2_compound_op+0x238c/0x3840 [cifs]   ? kasan_save_track+0x14/0x30   ? kasan_save_free_info+0x3b/0x70   ? vfs_symlink+0x1a1/0x2c0   ? do_symlinkat+0x108/0x1c0   ? __pfx_smb2_compound_op+0x10/0x10 [cifs]   ? kmem_cache_free+0x118/0x3e0   ? cifs_get_writable_path+0xeb/0x1a0 [cifs]   smb2_get_reparse_inode+0x423/0x540 [cifs]   ? __pfx_smb2_get_reparse_inode+0x10/0x10 [cifs]   ? rcu_is_watching+0x20/0x50   ? __kmalloc_noprof+0x37c/0x480   ? smb2_create_reparse_symlink+0x257/0x490 [cifs]   ? smb2_create_reparse_symlink+0x38f/0x490 [cifs]   smb2_create_reparse_symlink+0x38f/0x490 [cifs]   ? __pfx_smb2_create_reparse_symlink+0x10/0x10 [cifs]   ? find_held_lock+0x8a/0xa0   ? hlock_class+0x32/0xb0   ? __build_path_from_dentry_optional_prefix+0x19d/0x2e0 [cifs]   cifs_symlink+0x24f/0x960 [cifs]   ? __pfx_make_vfsuid+0x10/0x10   ? __pfx_cifs_symlink+0x10/0x10 [cifs]   ? make_vfsgid+0x6b/0xc0   ? generic_permission+0x96/0x2d0   vfs_symlink+0x1a1/0x2c0   do_symlinkat+0x108/0x1c0   ? __pfx_do_symlinkat+0x10/0x10   ? strncpy_from_user+0xaa/0x160   __x64_sys_symlinkat+0xb9/0xf0   do_syscall_64+0xbb/0x1d0   entry_SYSCALL_64_after_hwframe+0x77/0x7f  RIP: 0033:0x7f08d75c13bb\n\n    Update Instructions:\n\n    Run `sudo pro fix CVE-2024-50151` to fix the vulnerability. The problem can be corrected\n    by updating your system to the following package versions:\n\nlinux-image-4.13.0-16-generic - 4.13.0-16.19\nlinux-image-4.13.0-16-generic-lpae - 4.13.0-16.19\nlinux-image-4.13.0-16-lowlatency - 4.13.0-16.19\nlinux-image-extra-4.13.0-16-generic - 4.13.0-16.19\nNo subscription required\n\nlinux-image-4.15.0-1002-kvm - 4.15.0-1002.2\nNo subscription required\n\nlinux-image-4.15.0-1001-aws - 4.15.0-1001.1\nNo subscription required\n\nlinux-image-unsigned-4.15.0-1082-azure - 4.15.0-1082.92\nNo subscription required\n\nlinux-image-unsigned-4.15.0-1071-gcp - 4.15.0-1071.81\nNo subscription required\n\nlinux-image-unsigned-4.15.0-1007-oracle - 4.15.0-1007.9\nNo subscription required",
		"affected": {
			"family": "unix",
			"platform": "Ubuntu 18.04 LTS"
		},
		"reference": {
			"source": "CVE",
			"ref_id": "CVE-2024-50151",
			"ref_url": "https://www.cve.org/CVERecord?id=CVE-2024-50151"
		},
		"advisory": {
			"severity": "Medium",
			"rights": "Copyright (C) 2024 Canonical Ltd.",
			"public_date": "2024-11-07 10:15:00 UTC",
			"cve": {
				"text": "CVE-2024-50151",
				"href": "https://ubuntu.com/security/CVE-2024-50151",
				"public": "20241107"
			}
		}
	},
	"notes": {},
	"criteria": {
		"criterias": [
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:200747740000000",
						"comment": "linux package in bionic, is related to the CVE in some way and has been fixed (note: '4.13.0-16.19')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000040",
						"comment": "linux-hwe: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'replaced by linux-hwe-5.4')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000220",
						"comment": "linux-hwe-5.4: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'ESM criteria, was needed')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:200747740000040",
						"comment": "linux-kvm package in bionic, is related to the CVE in some way and has been fixed (note: '4.15.0-1002.2')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:200747740000050",
						"comment": "linux-aws package in bionic, is related to the CVE in some way and has been fixed (note: '4.15.0-1001.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000150",
						"comment": "linux-aws-5.0: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-aws-5.3')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000200",
						"comment": "linux-aws-5.3: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-aws-5.4')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000270",
						"comment": "linux-aws-5.4: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'ESM criteria, was needed')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000070",
						"comment": "linux-azure: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-azure-5.3')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201325960000010",
						"comment": "linux-azure-4.15 package in bionic, is related to the CVE in some way and has been fixed (note: '4.15.0-1082.92')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201585530000000",
						"comment": "linux-azure-5.3: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-azure-5.4')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000240",
						"comment": "linux-azure-5.4: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'ESM criteria, was needed')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000080",
						"comment": "linux-gcp: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-gcp-5.3')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201325960000040",
						"comment": "linux-gcp-4.15 package in bionic, is related to the CVE in some way and has been fixed (note: '4.15.0-1071.81')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000130",
						"comment": "linux-gcp-5.3: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-gcp-5.4')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000260",
						"comment": "linux-gcp-5.4: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'ESM criteria, was needed')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000050",
						"comment": "linux-gke-4.15: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-gke-5.0')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000280",
						"comment": "linux-gke-5.4: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of kernel support')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000290",
						"comment": "linux-gkeop-5.4: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of kernel support')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000310",
						"comment": "linux-ibm-5.4: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'ESM criteria, was needed')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:200747740000110",
						"comment": "linux-oracle package in bionic, is related to the CVE in some way and has been fixed (note: '4.15.0-1007.9')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000140",
						"comment": "linux-oracle-5.0: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-oracle-5.3')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000180",
						"comment": "linux-oracle-5.3: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-oracle-5.4')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000250",
						"comment": "linux-oracle-5.4: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'ESM criteria, was needed')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000100",
						"comment": "linux-oem: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'replaced by linux-hwe-5.4')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000010",
						"comment": "linux-raspi2: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of standard support')."
					},
					{
						"test_ref": "oval:com.ubuntu.bionic:tst:201245420000230",
						"comment": "linux-raspi-5.4: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'ESM criteria, was needed')."
					}
				]
			}
		]
	}
}
