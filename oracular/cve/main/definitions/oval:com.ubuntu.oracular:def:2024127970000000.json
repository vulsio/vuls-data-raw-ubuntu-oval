{
	"class": "vulnerability",
	"id": "oval:com.ubuntu.oracular:def:2024127970000000",
	"version": "1",
	"metadata": {
		"title": "CVE-2024-12797 on Ubuntu 24.10 (oracular) - high",
		"description": "Issue summary: Clients using RFC7250 Raw Public Keys (RPKs) to authenticateaserver may fail to notice that the server was not authenticated, becausehandshakes don't abort as expected when the SSL_VERIFY_PEER verificationmodeis set.Impact summary: TLS and DTLS connections using raw public keys may bevulnerable to man-in-middle attacks when server authentication failure isnotdetected by clients.RPKs are disabled by default in both TLS clients and TLS servers.  Theissueonly arises when TLS clients explicitly enable RPK use by the server, andtheserver, likewise, enables sending of an RPK instead of an X.509 certificatechain.  The affected clients are those that then rely on the handshake tofail when the server's RPK fails to match one of the expected public keys,by setting the verification mode to SSL_VERIFY_PEER.Clients that enable server-side raw public keys can still find out that rawpublic key verification failed by calling SSL_get_verify_result(), andthosethat do, and take appropriate action, are not affected.  This issue wasintroduced in the initial implementation of RPK support in OpenSSL 3.2.The FIPS modules in 3.4, 3.3, 3.2, 3.1 and 3.0 are not affected by thisissue.\n\n    Update Instructions:\n\n    Run `sudo pro fix CVE-2024-12797` to fix the vulnerability. The problem can be corrected\n    by updating your system to the following package versions:\n\nlibssl3t64 - 3.3.1-2ubuntu2.1\nopenssl - 3.3.1-2ubuntu2.1\nNo subscription required",
		"affected": {
			"family": "unix",
			"platform": "Ubuntu 24.10"
		},
		"reference": {
			"source": "CVE",
			"ref_id": "CVE-2024-12797",
			"ref_url": "https://www.cve.org/CVERecord?id=CVE-2024-12797"
		},
		"advisory": {
			"severity": "High",
			"rights": "Copyright (C) 2025 Canonical Ltd.",
			"public_date": "2025-02-11",
			"cve": {
				"text": "CVE-2024-12797",
				"href": "https://ubuntu.com/security/CVE-2024-12797",
				"public": "20250211"
			},
			"public_date_at_usn": "2025-02-11",
			"assigned_to": "mdeslaur(main)",
			"ref": [
				"https://ubuntu.com/security/notices/USN-7264-1"
			]
		}
	},
	"notes": {},
	"criteria": {
		"criterias": [
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:com.ubuntu.oracular:tst:2024127970000000",
						"comment": "openssl package in oracular was vulnerable but has been fixed (note: '3.3.1-2ubuntu2.1')."
					}
				]
			}
		]
	}
}
