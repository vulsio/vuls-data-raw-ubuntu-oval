{
	"class": "vulnerability",
	"id": "oval:com.ubuntu.oracular:def:2024566490000000",
	"version": "1",
	"metadata": {
		"title": "CVE-2024-56649 on Ubuntu 24.10 (oracular) - medium",
		"description": "In the Linux kernel, the following vulnerability has been resolved:net: enetc: Do not configure preemptible TCs if SIs do not supportBoth ENETC PF and VF drivers share enetc_setup_tc_mqprio() to configureMQPRIO. And enetc_setup_tc_mqprio() calls enetc_change_preemptible_tcs()to configure preemptible TCs. However, only PF is able to configurepreemptible TCs. Because only PF has related registers, while VF does nothave these registers. So for VF, its hw->port pointer is NULL. Therefore,VF will access an invalid pointer when accessing a non-existent register,which will cause a crash issue. The simplified log is as follows.root@ls1028ardb:~# tc qdisc add dev eno0vf0 parent root handle 100: \\mqprio num_tc 4 map 0 0 1 1 2 2 3 3 queues 1@0 1@1 1@2 1@3 hw 1[  187.290775] Unable to handle kernel paging request at virtual address0000000000001f00[  187.424831] pc : enetc_mm_commit_preemptible_tcs+0x1c4/0x400[  187.430518] lr : enetc_mm_commit_preemptible_tcs+0x30c/0x400[  187.511140] Call trace:[  187.513588]  enetc_mm_commit_preemptible_tcs+0x1c4/0x400[  187.518918]  enetc_setup_tc_mqprio+0x180/0x214[  187.523374]  enetc_vf_setup_tc+0x1c/0x30[  187.527306]  mqprio_enable_offload+0x144/0x178[  187.531766]  mqprio_init+0x3ec/0x668[  187.535351]  qdisc_create+0x15c/0x488[  187.539023]  tc_modify_qdisc+0x398/0x73c[  187.542958]  rtnetlink_rcv_msg+0x128/0x378[  187.547064]  netlink_rcv_skb+0x60/0x130[  187.550910]  rtnetlink_rcv+0x18/0x24[  187.554492]  netlink_unicast+0x300/0x36c[  187.558425]  netlink_sendmsg+0x1a8/0x420[  187.606759] ---[ end trace 0000000000000000 ]---In addition, some PFs also do not support configuring preemptible TCs,such as eno1 and eno3 on LS1028A. It won't crash like it does for VFs,but we should prevent these PFs from accessing these unimplementedregisters.",
		"affected": {
			"family": "unix",
			"platform": "Ubuntu 24.10"
		},
		"reference": {
			"source": "CVE",
			"ref_id": "CVE-2024-56649",
			"ref_url": "https://www.cve.org/CVERecord?id=CVE-2024-56649"
		},
		"advisory": {
			"severity": "Medium",
			"rights": "Copyright (C) 2024 Canonical Ltd.",
			"public_date": "2024-12-27 15:15:00 UTC",
			"cve": {
				"text": "CVE-2024-56649",
				"href": "https://ubuntu.com/security/CVE-2024-56649",
				"public": "20241227"
			}
		}
	},
	"notes": {},
	"criteria": {
		"criterias": [
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:com.ubuntu.oracular:tst:201245420000000",
						"comment": "linux package in oracular is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.oracular:tst:201245420000010",
						"comment": "linux-aws package in oracular is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.oracular:tst:201245420000020",
						"comment": "linux-azure package in oracular is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.oracular:tst:201245420000030",
						"comment": "linux-gcp package in oracular is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.oracular:tst:201245420000060",
						"comment": "linux-lowlatency package in oracular is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.oracular:tst:201245420000040",
						"comment": "linux-oracle package in oracular is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.oracular:tst:201245420000050",
						"comment": "linux-raspi package in oracular is affected and may need fixing."
					}
				]
			}
		]
	}
}
