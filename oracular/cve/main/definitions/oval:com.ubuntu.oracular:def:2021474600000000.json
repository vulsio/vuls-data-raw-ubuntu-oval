{
	"class": "vulnerability",
	"id": "oval:com.ubuntu.oracular:def:2021474600000000",
	"version": "1",
	"metadata": {
		"title": "CVE-2021-47460 on Ubuntu 24.10 (oracular) - medium",
		"description": "In the Linux kernel, the following vulnerability has been resolved: ocfs2:fix data corruption after conversion from inline format Commit 6dbf7bb55598(\"fs: Don't invalidate page buffers in block_write_full_page()\") uncovereda latent bug in ocfs2 conversion from inline inode format to a normal inodeformat. The code in ocfs2_convert_inline_data_to_extents() attempts to zeroout the whole cluster allocated for file data by grabbing, zeroing, anddirtying all pages covering this cluster. However these pages are beyondi_size, thus writeback code generally ignores these dirty pages and noblocks were ever actually zeroed on the disk. This oversight was fixed bycommit 693c241a5f6a (\"ocfs2: No need to zero pages past i_size.\") forstandard ocfs2 write path, inline conversion path was apparently forgotten;the commit log also has a reasoning why the zeroing actually is not needed.After commit 6dbf7bb55598, things became worse as writeback code stoppedinvalidating buffers on pages beyond i_size and thus these pages end upwith clean PageDirty bit but with buffers attached to these pages beingstill dirty. So when a file is converted from inline format, then writebacktriggers, and then the file is grown so that these pages become valid, theinvalid dirtiness state is preserved, mark_buffer_dirty() does nothing onthese pages (buffers are already dirty) but page is never written backbecause it is clean. So data written to these pages is lost once pages arereclaimed. Simple reproducer for the problem is: xfs_io -f -c \"pwrite 02000\" -c \"pwrite 2000 2000\" -c \"fsync\" \\ -c \"pwrite 4000 2000\" ocfs2_fileAfter unmounting and mounting the fs again, you can observe that end of'ocfs2_file' has lost its contents. Fix the problem by not doing thepointless zeroing during conversion from inline format similarly as in thestandard write path. [akpm@linux-foundation.org: fix whitespace, perJoseph]\n\n    Update Instructions:\n\n    Run `sudo pro fix CVE-2021-47460` to fix the vulnerability. The problem can be corrected\n    by updating your system to the following package versions:\n\nlinux-image-6.8.0-31-generic - 6.8.0-31.31\nlinux-image-unsigned-6.8.0-31-generic - 6.8.0-31.31\nlinux-image-unsigned-6.8.0-31-generic-64k - 6.8.0-31.31\nNo subscription required\n\nlinux-image-unsigned-6.8.0-1008-aws - 6.8.0-1008.8\nNo subscription required\n\nlinux-image-unsigned-6.8.0-1007-azure - 6.8.0-1007.7\nNo subscription required\n\nlinux-image-unsigned-6.8.0-1007-gcp - 6.8.0-1007.7\nNo subscription required\n\nlinux-image-unsigned-6.8.0-31-lowlatency - 6.8.0-31.31.1\nlinux-image-unsigned-6.8.0-31-lowlatency-64k - 6.8.0-31.31.1\nNo subscription required\n\nlinux-image-unsigned-6.8.0-1005-oracle - 6.8.0-1005.5\nlinux-image-unsigned-6.8.0-1005-oracle-64k - 6.8.0-1005.5\nNo subscription required\n\nlinux-image-6.8.0-1004-raspi - 6.8.0-1004.4\nNo subscription required",
		"affected": {
			"family": "unix",
			"platform": "Ubuntu 24.10"
		},
		"reference": {
			"source": "CVE",
			"ref_id": "CVE-2021-47460",
			"ref_url": "https://www.cve.org/CVERecord?id=CVE-2021-47460"
		},
		"advisory": {
			"severity": "Medium",
			"rights": "Copyright (C) 2024 Canonical Ltd.",
			"public_date": "2024-05-22 07:15:00 UTC",
			"cve": {
				"text": "CVE-2021-47460",
				"href": "https://ubuntu.com/security/CVE-2021-47460",
				"public": "20240522"
			}
		}
	},
	"notes": {},
	"criteria": {
		"criterias": [
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:com.ubuntu.oracular:tst:201431800000000",
						"comment": "linux package in oracular, is related to the CVE in some way and has been fixed (note: '6.8.0-31.31')."
					},
					{
						"test_ref": "oval:com.ubuntu.oracular:tst:201431800000010",
						"comment": "linux-aws package in oracular, is related to the CVE in some way and has been fixed (note: '6.8.0-1008.8')."
					},
					{
						"test_ref": "oval:com.ubuntu.oracular:tst:201431800000020",
						"comment": "linux-azure package in oracular, is related to the CVE in some way and has been fixed (note: '6.8.0-1007.7')."
					},
					{
						"test_ref": "oval:com.ubuntu.oracular:tst:201431800000030",
						"comment": "linux-gcp package in oracular, is related to the CVE in some way and has been fixed (note: '6.8.0-1007.7')."
					},
					{
						"test_ref": "oval:com.ubuntu.oracular:tst:201431800000050",
						"comment": "linux-lowlatency package in oracular, is related to the CVE in some way and has been fixed (note: '6.8.0-31.31.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.oracular:tst:201431800000040",
						"comment": "linux-oracle package in oracular, is related to the CVE in some way and has been fixed (note: '6.8.0-1005.5')."
					},
					{
						"test_ref": "oval:com.ubuntu.oracular:tst:201431800000060",
						"comment": "linux-raspi package in oracular, is related to the CVE in some way and has been fixed (note: '6.8.0-1004.4')."
					}
				]
			}
		]
	}
}
