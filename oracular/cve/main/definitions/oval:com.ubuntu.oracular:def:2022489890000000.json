{
	"class": "vulnerability",
	"id": "oval:com.ubuntu.oracular:def:2022489890000000",
	"version": "1",
	"metadata": {
		"title": "CVE-2022-48989 on Ubuntu 24.10 (oracular) - medium",
		"description": "In the Linux kernel, the following vulnerability has been resolved:fscache: Fix oops due to race with cookie_lru and use_cookieIf a cookie expires from the LRU and the LRU_DISCARD flag is set, butthe state machine has not run yet, it's possible another thread can callfscache_use_cookie and begin to use it.When the cookie_worker finally runs, it will see the LRU_DISCARD flagset, transition the cookie->state to LRU_DISCARDING, which will thenwithdraw the cookie.  Once the cookie is withdrawn the object is removedthe below oops will occur because the object associated with the cookieis now NULL.Fix the oops by clearing the LRU_DISCARD bit if another thread uses thecookie before the cookie_worker runs.  BUG: kernel NULL pointer dereference, address: 0000000000000008  ...  CPU: 31 PID: 44773 Comm: kworker/u130:1 Tainted: G     E6.0.0-5.dneg.x86_64 #1  Hardware name: Google Compute Engine/Google Compute Engine, BIOS Google08/26/2022  Workqueue: events_unbound netfs_rreq_write_to_cache_work [netfs]  RIP: 0010:cachefiles_prepare_write+0x28/0x90 [cachefiles]  ...  Call Trace:    netfs_rreq_write_to_cache_work+0x11c/0x320 [netfs]    process_one_work+0x217/0x3e0    worker_thread+0x4a/0x3b0    kthread+0xd6/0x100\n\n    Update Instructions:\n\n    Run `sudo pro fix CVE-2022-48989` to fix the vulnerability. The problem can be corrected\n    by updating your system to the following package versions:\n\nlinux-image-6.8.0-31-generic - 6.8.0-31.31\nlinux-image-unsigned-6.8.0-31-generic - 6.8.0-31.31\nlinux-image-unsigned-6.8.0-31-generic-64k - 6.8.0-31.31\nNo subscription required\n\nlinux-image-unsigned-6.8.0-1008-aws - 6.8.0-1008.8\nNo subscription required\n\nlinux-image-unsigned-6.8.0-1007-azure - 6.8.0-1007.7\nNo subscription required\n\nlinux-image-unsigned-6.8.0-1007-gcp - 6.8.0-1007.7\nNo subscription required\n\nlinux-image-unsigned-6.8.0-31-lowlatency - 6.8.0-31.31.1\nlinux-image-unsigned-6.8.0-31-lowlatency-64k - 6.8.0-31.31.1\nNo subscription required\n\nlinux-image-unsigned-6.8.0-1005-oracle - 6.8.0-1005.5\nlinux-image-unsigned-6.8.0-1005-oracle-64k - 6.8.0-1005.5\nNo subscription required\n\nlinux-image-6.8.0-1004-raspi - 6.8.0-1004.4\nNo subscription required",
		"affected": {
			"family": "unix",
			"platform": "Ubuntu 24.10"
		},
		"reference": {
			"source": "CVE",
			"ref_id": "CVE-2022-48989",
			"ref_url": "https://www.cve.org/CVERecord?id=CVE-2022-48989"
		},
		"advisory": {
			"severity": "Medium",
			"rights": "Copyright (C) 2024 Canonical Ltd.",
			"public_date": "2024-10-21 20:15:00 UTC",
			"cve": {
				"text": "CVE-2022-48989",
				"href": "https://ubuntu.com/security/CVE-2022-48989",
				"public": "20241021",
				"cvss_score": "4.7",
				"cvss_vector": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:H"
			}
		}
	},
	"notes": {},
	"criteria": {
		"criterias": [
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:com.ubuntu.oracular:tst:201431800000000",
						"comment": "linux package in oracular, is related to the CVE in some way and has been fixed (note: '6.8.0-31.31')."
					},
					{
						"test_ref": "oval:com.ubuntu.oracular:tst:201431800000010",
						"comment": "linux-aws package in oracular, is related to the CVE in some way and has been fixed (note: '6.8.0-1008.8')."
					},
					{
						"test_ref": "oval:com.ubuntu.oracular:tst:201431800000020",
						"comment": "linux-azure package in oracular, is related to the CVE in some way and has been fixed (note: '6.8.0-1007.7')."
					},
					{
						"test_ref": "oval:com.ubuntu.oracular:tst:201431800000030",
						"comment": "linux-gcp package in oracular, is related to the CVE in some way and has been fixed (note: '6.8.0-1007.7')."
					},
					{
						"test_ref": "oval:com.ubuntu.oracular:tst:201431800000050",
						"comment": "linux-lowlatency package in oracular, is related to the CVE in some way and has been fixed (note: '6.8.0-31.31.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.oracular:tst:201431800000040",
						"comment": "linux-oracle package in oracular, is related to the CVE in some way and has been fixed (note: '6.8.0-1005.5')."
					},
					{
						"test_ref": "oval:com.ubuntu.oracular:tst:201431800000060",
						"comment": "linux-raspi package in oracular, is related to the CVE in some way and has been fixed (note: '6.8.0-1004.4')."
					}
				]
			}
		]
	}
}
