{
	"class": "vulnerability",
	"id": "oval:com.ubuntu.oracular:def:2024369620000000",
	"version": "1",
	"metadata": {
		"title": "CVE-2024-36962 on Ubuntu 24.10 (oracular) - medium",
		"description": "In the Linux kernel, the following vulnerability has been resolved: net:ks8851: Queue RX packets in IRQ handler instead of disabling BHs Currentlythe driver uses local_bh_disable()/local_bh_enable() in its IRQ handler toavoid triggering net_rx_action() softirq on exit from netif_rx(). Thenet_rx_action() could trigger this driver .start_xmit callback, which isprotected by the same lock as the IRQ handler, so calling the .start_xmitfrom netif_rx() from the IRQ handler critical section protected by the lockcould lead to an attempt to claim the already claimed lock, and a hang. Thelocal_bh_disable()/local_bh_enable() approach works only in case the IRQhandler is protected by a spinlock, but does not work if the IRQ handler isprotected by mutex, i.e. this works for KS8851 with Parallel bus interface,but not for KS8851 with SPI bus interface. Remove the BH manipulation andinstead of calling netif_rx() inside the IRQ handler code protected by thelock, queue all the received SKBs in the IRQ handler into a queue first,and once the IRQ handler exits the critical section protected by the lock,dequeue all the queued SKBs and push them all into netif_rx(). At thispoint, it is safe to trigger the net_rx_action() softirq, since thenetif_rx() call is outside of the lock that protects the IRQ handler.\n\n    Update Instructions:\n\n    Run `sudo pro fix CVE-2024-36962` to fix the vulnerability. The problem can be corrected\n    by updating your system to the following package versions:\n\nlinux-image-6.8.0-31-generic - 6.8.0-31.31\nlinux-image-unsigned-6.8.0-31-generic - 6.8.0-31.31\nlinux-image-unsigned-6.8.0-31-generic-64k - 6.8.0-31.31\nNo subscription required\n\nlinux-image-unsigned-6.8.0-1008-aws - 6.8.0-1008.8\nNo subscription required\n\nlinux-image-unsigned-6.8.0-1007-azure - 6.8.0-1007.7\nNo subscription required\n\nlinux-image-unsigned-6.8.0-1007-gcp - 6.8.0-1007.7\nNo subscription required\n\nlinux-image-unsigned-6.8.0-31-lowlatency - 6.8.0-31.31.1\nlinux-image-unsigned-6.8.0-31-lowlatency-64k - 6.8.0-31.31.1\nNo subscription required\n\nlinux-image-unsigned-6.8.0-1005-oracle - 6.8.0-1005.5\nlinux-image-unsigned-6.8.0-1005-oracle-64k - 6.8.0-1005.5\nNo subscription required\n\nlinux-image-6.8.0-1004-raspi - 6.8.0-1004.4\nNo subscription required",
		"affected": {
			"family": "unix",
			"platform": "Ubuntu 24.10"
		},
		"reference": {
			"source": "CVE",
			"ref_id": "CVE-2024-36962",
			"ref_url": "https://www.cve.org/CVERecord?id=CVE-2024-36962"
		},
		"advisory": {
			"severity": "Medium",
			"rights": "Copyright (C) 2024 Canonical Ltd.",
			"public_date": "2024-06-03 08:15:00 UTC",
			"cve": {
				"text": "CVE-2024-36962",
				"href": "https://ubuntu.com/security/CVE-2024-36962",
				"public": "20240603"
			},
			"public_date_at_usn": "2024-06-03 08:15:00 UTC",
			"ref": [
				"https://ubuntu.com/security/notices/USN-6949-1",
				"https://ubuntu.com/security/notices/USN-6952-1",
				"https://ubuntu.com/security/notices/USN-6955-1",
				"https://ubuntu.com/security/notices/USN-6949-2",
				"https://ubuntu.com/security/notices/USN-6952-2"
			]
		}
	},
	"notes": {},
	"criteria": {
		"criterias": [
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:com.ubuntu.oracular:tst:201431800000000",
						"comment": "linux package in oracular, is related to the CVE in some way and has been fixed (note: '6.8.0-31.31')."
					},
					{
						"test_ref": "oval:com.ubuntu.oracular:tst:201431800000010",
						"comment": "linux-aws package in oracular, is related to the CVE in some way and has been fixed (note: '6.8.0-1008.8')."
					},
					{
						"test_ref": "oval:com.ubuntu.oracular:tst:201431800000020",
						"comment": "linux-azure package in oracular, is related to the CVE in some way and has been fixed (note: '6.8.0-1007.7')."
					},
					{
						"test_ref": "oval:com.ubuntu.oracular:tst:201431800000020",
						"comment": "linux-gcp package in oracular, is related to the CVE in some way and has been fixed (note: '6.8.0-1007.7')."
					},
					{
						"test_ref": "oval:com.ubuntu.oracular:tst:201431800000040",
						"comment": "linux-lowlatency package in oracular, is related to the CVE in some way and has been fixed (note: '6.8.0-31.31.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.oracular:tst:201431800000030",
						"comment": "linux-oracle package in oracular, is related to the CVE in some way and has been fixed (note: '6.8.0-1005.5')."
					},
					{
						"test_ref": "oval:com.ubuntu.oracular:tst:201431800000050",
						"comment": "linux-raspi package in oracular, is related to the CVE in some way and has been fixed (note: '6.8.0-1004.4')."
					}
				]
			}
		]
	}
}
