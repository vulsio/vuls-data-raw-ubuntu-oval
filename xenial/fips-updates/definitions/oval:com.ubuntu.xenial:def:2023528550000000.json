{
	"class": "vulnerability",
	"id": "oval:com.ubuntu.xenial:def:2023528550000000",
	"version": "1",
	"metadata": {
		"title": "CVE-2023-52855 on Ubuntu 16.04 FIPS Compliant (xenial) - medium",
		"description": "In the Linux kernel, the following vulnerability has been resolved:usb: dwc2: fix possible NULL pointer dereference caused by driverconcurrencyIn _dwc2_hcd_urb_enqueue(), \"urb->hcpriv = NULL\" is executed withoutholding the lock \"hsotg->lock\". In _dwc2_hcd_urb_dequeue():    spin_lock_irqsave(&hsotg->lock, flags);    ...\tif (!urb->hcpriv) {\t\tdev_dbg(hsotg->dev, \"## urb->hcpriv is NULL ##\\n\");\t\tgoto out;\t}    rc = dwc2_hcd_urb_dequeue(hsotg, urb->hcpriv); // Use urb->hcpriv    ...out:    spin_unlock_irqrestore(&hsotg->lock, flags);When _dwc2_hcd_urb_enqueue() and _dwc2_hcd_urb_dequeue() areconcurrently executed, the NULL check of \"urb->hcpriv\" can be executedbefore \"urb->hcpriv = NULL\". After urb->hcpriv is NULL, it can be usedin the function call to dwc2_hcd_urb_dequeue(), which can cause a NULLpointer dereference.This possible bug is found by an experimental static analysis tooldeveloped by myself. This tool analyzes the locking APIs to extractfunction pairs that can be concurrently executed, and then analyzes theinstructions in the paired functions to identify possible concurrencybugs including data races and atomicity violations. The above possiblebug is reported, when my tool analyzes the source code of Linux 6.5.To fix this possible bug, \"urb->hcpriv = NULL\" should be executed withholding the lock \"hsotg->lock\". After using this patch, my tool neverreports the possible bug, with the kernelconfiguration allyesconfig forx86_64. Because I have no associated hardware, I cannot test the patchin runtime testing, and just verify it according to the code logic.",
		"affected": {
			"family": "unix",
			"platform": "Ubuntu 16.04 FIPS Compliant"
		},
		"reference": {
			"source": "CVE",
			"ref_id": "CVE-2023-52855",
			"ref_url": "https://www.cve.org/CVERecord?id=CVE-2023-52855"
		},
		"advisory": {
			"severity": "Medium",
			"rights": "Copyright (C) 2024 Canonical Ltd.",
			"public_date": "2024-05-21 16:15:00 UTC",
			"cve": {
				"text": "CVE-2023-52855",
				"href": "https://ubuntu.com/security/CVE-2023-52855",
				"public": "20240521"
			}
		}
	},
	"notes": {},
	"criteria": {
		"criterias": [
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201585530000000",
						"comment": "linux-fips package in fips-updates/xenial is affected and may need fixing."
					}
				]
			}
		]
	}
}
