{
	"class": "vulnerability",
	"id": "oval:com.ubuntu.xenial:def:2024450040000000",
	"version": "1",
	"metadata": {
		"title": "CVE-2024-45004 on Ubuntu 16.04 FIPS Compliant (xenial) - medium",
		"description": "In the Linux kernel, the following vulnerability has been resolved:KEYS: trusted: dcp: fix leak of blob encryption keyTrusted keys unseal the key blob on load, but keep the sealed payload inthe blob field so that every subsequent read (export) will simplyconvert this field to hex and send it to userspace.With DCP-based trusted keys, we decrypt the blob encryption key (BEK)in the Kernel due hardware limitations and then decrypt the blob payload.BEK decryption is done in-place which means that the trusted key blobfield is modified and it consequently holds the BEK in plain text.Every subsequent read of that key thus send the plain text BEK insteadof the encrypted BEK to userspace.This issue only occurs when importing a trusted DCP-based key andthen exporting it again. This should rarely happen as the common use casesare to either create a new trusted key and export it, or import a keyblob and then just use it without exporting it again.Fix this by performing BEK decryption and encryption in a dedicatedbuffer. Further always wipe the plain text BEK buffer to prevent leakingthe key via uninitialized memory.\n\n    Update Instructions:\n\n    Run `sudo pro fix CVE-2024-45004` to fix the vulnerability. The problem can be corrected\n    by updating your system to the following package versions:\n\nlinux-image-4.4.0-1003-fips - 4.4.0-1003.3\nlinux-image-extra-4.4.0-1003-fips - 4.4.0-1003.3\nlinux-image-hmac-4.4.0-1003-fips - 4.4.0-1003.3\nAvailable with Ubuntu Pro: https://ubuntu.com/pro",
		"affected": {
			"family": "unix",
			"platform": "Ubuntu 16.04 FIPS Compliant"
		},
		"reference": {
			"source": "CVE",
			"ref_id": "CVE-2024-45004",
			"ref_url": "https://www.cve.org/CVERecord?id=CVE-2024-45004"
		},
		"advisory": {
			"severity": "Medium",
			"rights": "Copyright (C) 2024 Canonical Ltd.",
			"public_date": "2024-09-05",
			"cve": {
				"text": "CVE-2024-45004",
				"href": "https://ubuntu.com/security/CVE-2024-45004",
				"public": "20240905"
			}
		}
	},
	"notes": {},
	"criteria": {
		"criterias": [
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:200636350000080",
						"comment": "linux-fips package in fips-updates/xenial, is related to the CVE in some way and has been fixed (note: '4.4.0-1003.3')."
					}
				]
			}
		]
	}
}
