{
	"class": "vulnerability",
	"id": "oval:com.ubuntu.xenial:def:2024266900000000",
	"version": "1",
	"metadata": {
		"title": "CVE-2024-26690 on Ubuntu 16.04 FIPS Compliant (xenial) - medium",
		"description": "In the Linux kernel, the following vulnerability has been resolved:net: stmmac: protect updates of 64-bit statistics countersAs explained by a comment in <linux/u64_stats_sync.h>, write side of structu64_stats_sync must ensure mutual exclusion, or one seqcount update couldbe lost on 32-bit platforms, thus blocking readers forever. Such lockupshave been observed in real world after stmmac_xmit() on one CPU raced withstmmac_napi_poll_tx() on another CPU.To fix the issue without introducing a new lock, split the statics intothree parts:1. fields updated only under the tx queue lock,2. fields updated only during NAPI poll,3. fields updated only from interrupt context,Updates to fields in the first two groups are already serialized throughother locks. It is sufficient to split the existing struct u64_stats_syncso that each group has its own.Note that tx_set_ic_bit is updated from both contexts. Split this counterso that each context gets its own, and calculate their sum to get the totalvalue in stmmac_get_ethtool_stats().For the third group, multiple interrupts may be processed by different CPUsat the same time, but interrupts on the same CPU will not nest. Move fieldsfrom this group to a newly created per-cpu struct stmmac_pcpu_stats.",
		"affected": {
			"family": "unix",
			"platform": "Ubuntu 16.04 FIPS Compliant"
		},
		"reference": {
			"source": "CVE",
			"ref_id": "CVE-2024-26690",
			"ref_url": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-26690"
		},
		"advisory": {
			"severity": "Medium",
			"rights": "Copyright (C) 2024 Canonical Ltd.",
			"public_date": "2024-04-04",
			"cve": {
				"text": "CVE-2024-26690",
				"href": "https://ubuntu.com/security/CVE-2024-26690",
				"public": "20240404"
			}
		}
	},
	"notes": {},
	"criteria": {
		"criterias": [
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201585530000000",
						"comment": "linux-fips package in fips-updates/xenial is affected and may need fixing."
					}
				]
			}
		]
	}
}
