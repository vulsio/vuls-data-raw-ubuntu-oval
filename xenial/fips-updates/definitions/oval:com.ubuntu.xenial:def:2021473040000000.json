{
	"class": "vulnerability",
	"id": "oval:com.ubuntu.xenial:def:2021473040000000",
	"version": "1",
	"metadata": {
		"title": "CVE-2021-47304 on Ubuntu 16.04 FIPS Compliant (xenial) - medium",
		"description": "In the Linux kernel, the following vulnerability has been resolved:tcp: fix tcp_init_transfer() to not reset icsk_ca_initializedThis commit fixes a bug (found by syzkaller) that could cause spuriousdouble-initializations for congestion control modules, which could causememory leaks or other problems for congestion control modules (like CDG)that allocate memory in their init functions.The buggy scenario constructed by syzkaller was something like:(1) create a TCP socket(2) initiate a TFO connect via sendto()(3) while socket is in TCP_SYN_SENT, call setsockopt(TCP_CONGESTION),    which calls:       tcp_set_congestion_control() ->         tcp_reinit_congestion_control() ->           tcp_init_congestion_control()(4) receive ACK, connection is established, call tcp_init_transfer(),    set icsk_ca_initialized=0 (without first calling cc->release()),    call tcp_init_congestion_control() again.Note that in this sequence tcp_init_congestion_control() is calledtwice without a cc->release() call in between. Thus, for CC modulesthat allocate memory in their init() function, e.g, CDG, a memory leakmay occur. The syzkaller tool managed to find a reproducer thattriggered such a leak in CDG.The bug was introduced when that commit 8919a9b31eb4 (\"tcp: Only initcongestion control if not initialized already\")introduced icsk_ca_initialized and set icsk_ca_initialized to 0 intcp_init_transfer(), missing the possibility for a sequence like theone above, where a process could call setsockopt(TCP_CONGESTION) instate TCP_SYN_SENT (i.e. after the connect() or TFO open sendmsg()),which would call tcp_init_congestion_control(). It did not intend toreset any initialization that the user had already explicitly made;it just missed the possibility of that particular sequence (whichsyzkaller managed to find).",
		"affected": {
			"family": "unix",
			"platform": "Ubuntu 16.04 FIPS Compliant"
		},
		"reference": {
			"source": "CVE",
			"ref_id": "CVE-2021-47304",
			"ref_url": "https://www.cve.org/CVERecord?id=CVE-2021-47304"
		},
		"advisory": {
			"severity": "Medium",
			"rights": "Copyright (C) 2024 Canonical Ltd.",
			"public_date": "2024-05-21 15:15:00 UTC",
			"cve": {
				"text": "CVE-2021-47304",
				"href": "https://ubuntu.com/security/CVE-2021-47304",
				"public": "20240521"
			}
		}
	},
	"notes": {},
	"criteria": {
		"criterias": [
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201585530000000",
						"comment": "linux-fips package in fips-updates/xenial is affected and may need fixing."
					}
				]
			}
		]
	}
}
