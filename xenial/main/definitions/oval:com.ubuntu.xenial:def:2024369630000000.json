{
	"class": "vulnerability",
	"id": "oval:com.ubuntu.xenial:def:2024369630000000",
	"version": "1",
	"metadata": {
		"title": "CVE-2024-36963 on Ubuntu 16.04 LTS (xenial) - medium",
		"description": "In the Linux kernel, the following vulnerability has been resolved:tracefs: Reset permissions on remount if permissions are optionsThere's an inconsistency with the way permissions are handled in tracefs.Because the permissions are generated when accessed, they default to theroot inode's permission if they were never set by the user. If the usersets the permissions, then a flag is set and the permissions are saved viathe inode (for tracefs files) or an internal attribute field (foreventfs).But if a remount happens that specify the permissions, all the files thatwere not changed by the user gets updated, but the ones that were are not.If the user were to remount the file system with a given permission, thenall files and directories within that file system should be updated.This can cause security issues if a file's permission was updated but theadmin forgot about it. They could incorrectly think that remounting withpermissions set would update all files, but miss some.For example: # cd /sys/kernel/tracing # chgrp 1002 current_tracer # ls -l[..] -rw-r-----  1 root root 0 May  1 21:25 buffer_size_kb -rw-r-----  1 root root 0 May  1 21:25 buffer_subbuf_size_kb -r--r-----  1 root root 0 May  1 21:25 buffer_total_size_kb -rw-r-----  1 root lkp  0 May  1 21:25 current_tracer -rw-r-----  1 root root 0 May  1 21:25 dynamic_events -r--r-----  1 root root 0 May  1 21:25 dyn_ftrace_total_info -r--r-----  1 root root 0 May  1 21:25 enabled_functionsWhere current_tracer now has group \"lkp\". # mount -o remount,gid=1001 . # ls -l -rw-r-----  1 root tracing 0 May  1 21:25 buffer_size_kb -rw-r-----  1 root tracing 0 May  1 21:25 buffer_subbuf_size_kb -r--r-----  1 root tracing 0 May  1 21:25 buffer_total_size_kb -rw-r-----  1 root lkp     0 May  1 21:25 current_tracer -rw-r-----  1 root tracing 0 May  1 21:25 dynamic_events -r--r-----  1 root tracing 0 May  1 21:25 dyn_ftrace_total_info -r--r-----  1 root tracing 0 May  1 21:25 enabled_functionsEverything changed but the \"current_tracer\".Add a new link list that keeps track of all the tracefs_inodes which hasthe permission flags that tell if the file/dir should use the root inode'spermission or not. Then on remount, clear all the flags so that thedefault behavior of using the root inode's permission is done for allfiles and directories.\n\n    Update Instructions:\n\n    Run `sudo pro fix CVE-2024-36963` to fix the vulnerability. The problem can be corrected\n    by updating your system to the following package versions:\n\nlinux-image-4.4.0-211-generic - 4.4.0-2.16\nlinux-image-unsigned-4.4.0-211-generic - 4.4.0-2.16\nlinux-image-unsigned-4.4.0-211-lowlatency - 4.4.0-2.16\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro\n\nlinux-image-4.15.0-143-generic - 4.8.0-39.42~16.04.1\nlinux-image-unsigned-4.15.0-143-generic - 4.8.0-39.42~16.04.1\nlinux-image-unsigned-4.15.0-143-lowlatency - 4.8.0-39.42~16.04.1\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro\n\nlinux-image-4.4.0-1094-kvm - 4.4.0-1004.9\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro\n\nlinux-image-4.4.0-1129-aws - 4.4.0-1001.10\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro\n\nlinux-image-4.15.0-1102-aws - 4.15.0-1030.31~16.04.1\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro\n\nlinux-image-unsigned-4.15.0-1114-azure - 4.11.0-1009.9\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro\n\nlinux-image-unsigned-4.15.0-1099-gcp - 4.10.0-1004.4\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro\n\nlinux-image-unsigned-4.15.0-1071-oracle - 4.15.0-1007.9~16.04.1\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro",
		"affected": {
			"family": "unix",
			"platform": "Ubuntu 16.04 LTS"
		},
		"reference": {
			"source": "CVE",
			"ref_id": "CVE-2024-36963",
			"ref_url": "https://www.cve.org/CVERecord?id=CVE-2024-36963"
		},
		"advisory": {
			"severity": "Medium",
			"rights": "Copyright (C) 2024 Canonical Ltd.",
			"public_date": "2024-06-03 08:15:00 UTC",
			"cve": {
				"text": "CVE-2024-36963",
				"href": "https://ubuntu.com/security/CVE-2024-36963",
				"public": "20240603"
			}
		}
	},
	"notes": {},
	"criteria": {
		"criterias": [
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201513390000000",
						"comment": "linux package in xenial, is related to the CVE in some way and has been fixed (note: '4.4.0-2.16')."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:2016100880000040",
						"comment": "linux-hwe package in xenial, is related to the CVE in some way and has been fixed (note: '4.8.0-39.42~16.04.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:200636350000110",
						"comment": "linux-kvm package in xenial, is related to the CVE in some way and has been fixed (note: '4.4.0-1004.9')."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:200636350000060",
						"comment": "linux-aws package in xenial, is related to the CVE in some way and has been fixed (note: '4.4.0-1001.10')."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:200747740000010",
						"comment": "linux-aws-hwe package in xenial, is related to the CVE in some way and has been fixed (note: '4.15.0-1030.31~16.04.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:200636350000090",
						"comment": "linux-azure package in xenial, is related to the CVE in some way and has been fixed (note: '4.11.0-1009.9')."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:200636350000100",
						"comment": "linux-gcp package in xenial, is related to the CVE in some way and has been fixed (note: '4.10.0-1004.4')."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:200747740000020",
						"comment": "linux-oracle package in xenial, is related to the CVE in some way and has been fixed (note: '4.15.0-1007.9~16.04.1')."
					}
				]
			}
		]
	}
}
