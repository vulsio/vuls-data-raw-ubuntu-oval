{
	"class": "vulnerability",
	"id": "oval:com.ubuntu.xenial:def:2024268150000000",
	"version": "1",
	"metadata": {
		"title": "CVE-2024-26815 on Ubuntu 16.04 LTS (xenial) - medium",
		"description": "In the Linux kernel, the following vulnerability has been resolved:net/sched: taprio: proper TCA_TAPRIO_TC_ENTRY_INDEX checktaprio_parse_tc_entry() is not correctly checkingTCA_TAPRIO_TC_ENTRY_INDEX attribute:\tint tc; // Signed value\ttc = nla_get_u32(tb[TCA_TAPRIO_TC_ENTRY_INDEX]);\tif (tc >= TC_QOPT_MAX_QUEUE) {\t\tNL_SET_ERR_MSG_MOD(extack, \"TC entry index out of range\");\t\treturn -ERANGE;\t}syzbot reported that it could fed arbitary negative values:UBSAN: shift-out-of-bounds in net/sched/sch_taprio.c:1722:18shift exponent -2147418108 is negativeCPU: 0 PID: 5066 Comm: syz-executor367 Not tainted6.8.0-rc7-syzkaller-00136-gc8a5c731fd12 #0Hardware name: Google Google Compute Engine/Google Compute Engine, BIOSGoogle 02/29/2024Call Trace: <TASK>  __dump_stack lib/dump_stack.c:88 [inline]  dump_stack_lvl+0x1e7/0x2e0 lib/dump_stack.c:106  ubsan_epilogue lib/ubsan.c:217 [inline]  __ubsan_handle_shift_out_of_bounds+0x3c7/0x420 lib/ubsan.c:386  taprio_parse_tc_entry net/sched/sch_taprio.c:1722 [inline]  taprio_parse_tc_entries net/sched/sch_taprio.c:1768 [inline]  taprio_change+0xb87/0x57d0 net/sched/sch_taprio.c:1877  taprio_init+0x9da/0xc80 net/sched/sch_taprio.c:2134  qdisc_create+0x9d4/0x1190 net/sched/sch_api.c:1355  tc_modify_qdisc+0xa26/0x1e40 net/sched/sch_api.c:1776  rtnetlink_rcv_msg+0x885/0x1040 net/core/rtnetlink.c:6617  netlink_rcv_skb+0x1e3/0x430 net/netlink/af_netlink.c:2543  netlink_unicast_kernel net/netlink/af_netlink.c:1341 [inline]  netlink_unicast+0x7ea/0x980 net/netlink/af_netlink.c:1367  netlink_sendmsg+0xa3b/0xd70 net/netlink/af_netlink.c:1908  sock_sendmsg_nosec net/socket.c:730 [inline]  __sock_sendmsg+0x221/0x270 net/socket.c:745  ____sys_sendmsg+0x525/0x7d0 net/socket.c:2584  ___sys_sendmsg net/socket.c:2638 [inline]  __sys_sendmsg+0x2b0/0x3a0 net/socket.c:2667 do_syscall_64+0xf9/0x240 entry_SYSCALL_64_after_hwframe+0x6f/0x77RIP: 0033:0x7f1b2dea3759Code: 48 83 c4 28 c3 e8 d7 19 00 00 0f 1f 80 00 00 00 00 48 89 f8 48 89 f748 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 <48> 3d 01 f0 ffff 73 01 c3 48 c7 c1 b8 ff ff ff f7 d8 64 89 01 48RSP: 002b:00007ffd4de452f8 EFLAGS: 00000246 ORIG_RAX: 000000000000002eRAX: ffffffffffffffda RBX: 00007f1b2def0390 RCX: 00007f1b2dea3759RDX: 0000000000000000 RSI: 00000000200007c0 RDI: 0000000000000004RBP: 0000000000000003 R08: 0000555500000000 R09: 0000555500000000R10: 0000555500000000 R11: 0000000000000246 R12: 00007ffd4de45340R13: 00007ffd4de45310 R14: 0000000000000001 R15: 00007ffd4de45340",
		"affected": {
			"family": "unix",
			"platform": "Ubuntu 16.04 LTS"
		},
		"reference": {
			"source": "CVE",
			"ref_id": "CVE-2024-26815",
			"ref_url": "https://www.cve.org/CVERecord?id=CVE-2024-26815"
		},
		"advisory": {
			"severity": "Medium",
			"rights": "Copyright (C) 2024 Canonical Ltd.",
			"public_date": "2024-04-11",
			"cve": {
				"text": "CVE-2024-26815",
				"href": "https://ubuntu.com/security/CVE-2024-26815",
				"public": "20240411"
			}
		}
	},
	"notes": {},
	"criteria": {
		"criterias": [
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000000",
						"comment": "linux package in xenial is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000040",
						"comment": "linux-hwe package in xenial is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000070",
						"comment": "linux-kvm package in xenial is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000030",
						"comment": "linux-aws package in xenial is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000080",
						"comment": "linux-aws-hwe package in xenial is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000050",
						"comment": "linux-azure package in xenial is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000060",
						"comment": "linux-gcp package in xenial is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000090",
						"comment": "linux-oracle package in xenial is affected and may need fixing."
					}
				]
			}
		]
	}
}
