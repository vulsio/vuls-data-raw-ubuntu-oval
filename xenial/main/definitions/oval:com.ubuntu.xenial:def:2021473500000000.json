{
	"class": "vulnerability",
	"id": "oval:com.ubuntu.xenial:def:2021473500000000",
	"version": "1",
	"metadata": {
		"title": "CVE-2021-47350 on Ubuntu 16.04 LTS (xenial) - medium",
		"description": "In the Linux kernel, the following vulnerability has been resolved:powerpc/mm: Fix lockup on kernel exec faultThe powerpc kernel is not prepared to handle exec faults from kernel.Especially, the function is_exec_fault() will return 'false' when anexec fault is taken by kernel, because the check is based on readingcurrent->thread.regs->trap which contains the trap from user.For instance, when provoking a LKDTM EXEC_USERSPACE test,current->thread.regs->trap is set to SYSCALL trap (0xc00), andthe fault taken by the kernel is not seen as an exec fault byset_access_flags_filter().Commit d7df2443cd5f (\"powerpc/mm: Fix spurious segfaults on radixwith autonuma\") made it clear and handled it properly. But later oncommit d3ca587404b3 (\"powerpc/mm: Fix reporting of kernel executefaults\") removed that handling, introducing test based on error_code.And here is the problem, because on the 603 all upper bits of SRR1get cleared when the TLB instruction miss handler bails out to ISI.Until commit cbd7e6ca0210 (\"powerpc/fault: Avoid heavysearch_exception_tables() verification\"), an exec fault from kernelat a userspace address was indirectly caught by the lack of entry forthat address in the exception tables. But after that commit thekernel mainly relies on KUAP or on core mm handling to catch wronguser accesses. Here the access is not wrong, so mm handles it.It is a minor fault because PAGE_EXEC is not set,set_access_flags_filter() should set PAGE_EXEC and voila.But as is_exec_fault() returns false as explained in the beginning,set_access_flags_filter() bails out without setting PAGE_EXEC flag,which leads to a forever minor exec fault.As the kernel is not prepared to handle such exec faults, the thing todo is to fire in bad_kernel_fault() for any exec fault taken by thekernel, as it was prior to commit d3ca587404b3.",
		"affected": {
			"family": "unix",
			"platform": "Ubuntu 16.04 LTS"
		},
		"reference": {
			"source": "CVE",
			"ref_id": "CVE-2021-47350",
			"ref_url": "https://www.cve.org/CVERecord?id=CVE-2021-47350"
		},
		"advisory": {
			"severity": "Medium",
			"rights": "Copyright (C) 2024 Canonical Ltd.",
			"public_date": "2024-05-21 15:15:00 UTC",
			"cve": {
				"text": "CVE-2021-47350",
				"href": "https://ubuntu.com/security/CVE-2021-47350",
				"public": "20240521"
			}
		}
	},
	"notes": {},
	"criteria": {
		"criterias": [
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000000",
						"comment": "linux package in xenial is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000040",
						"comment": "linux-hwe package in xenial is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000070",
						"comment": "linux-kvm package in xenial is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000030",
						"comment": "linux-aws package in xenial is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000080",
						"comment": "linux-aws-hwe package in xenial is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000050",
						"comment": "linux-azure package in xenial is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000060",
						"comment": "linux-gcp package in xenial is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000090",
						"comment": "linux-oracle package in xenial is affected and may need fixing."
					}
				]
			}
		]
	}
}
