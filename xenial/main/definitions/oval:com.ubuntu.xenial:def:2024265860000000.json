{
	"class": "vulnerability",
	"id": "oval:com.ubuntu.xenial:def:2024265860000000",
	"version": "1",
	"metadata": {
		"title": "CVE-2024-26586 on Ubuntu 16.04 LTS (xenial) - medium",
		"description": "In the Linux kernel, the following vulnerability has been resolved: mlxsw:spectrum_acl_tcam: Fix stack corruption When tc filters are first added toa net device, the corresponding local port gets bound to an ACL group inthe device. The group contains a list of ACLs. In turn, each ACL points toa different TCAM region where the filters are stored. During forwarding,the ACLs are sequentially evaluated until a match is found. One reason toplace filters in different regions is when they are added with decreasingpriorities and in an alternating order so that two consecutive filters cannever fit in the same region because of their key usage. In Spectrum-2 andnewer ASICs the firmware started to report that the maximum number of ACLsin a group is more than 16, but the layout of the register that configuresACL groups (PAGT) was not updated to account for that. It is thereforepossible to hit stack corruption [1] in the rare case where more than 16ACLs in a group are required. Fix by limiting the maximum ACL group size tothe minimum between what the firmware reports and the maximum ACLs that fitin the PAGT register. Add a test case to make sure the machine does notcrash when this condition is hit. [1] Kernel panic - not syncing:stack-protector: Kernel stack is corrupted in:mlxsw_sp_acl_tcam_group_update+0x116/0x120 [...] dump_stack_lvl+0x36/0x50panic+0x305/0x330 __stack_chk_fail+0x15/0x20mlxsw_sp_acl_tcam_group_update+0x116/0x120mlxsw_sp_acl_tcam_group_region_attach+0x69/0x110mlxsw_sp_acl_tcam_vchunk_get+0x492/0xa20mlxsw_sp_acl_tcam_ventry_add+0x25/0xe0 mlxsw_sp_acl_rule_add+0x47/0x240mlxsw_sp_flower_replace+0x1a9/0x1d0 tc_setup_cb_add+0xdc/0x1c0fl_hw_replace_filter+0x146/0x1f0 fl_change+0xc17/0x1360tc_new_tfilter+0x472/0xb90 rtnetlink_rcv_msg+0x313/0x3b0netlink_rcv_skb+0x58/0x100 netlink_unicast+0x244/0x390netlink_sendmsg+0x1e4/0x440 ____sys_sendmsg+0x164/0x260___sys_sendmsg+0x9a/0xe0 __sys_sendmsg+0x7a/0xc0 do_syscall_64+0x40/0xe0entry_SYSCALL_64_after_hwframe+0x63/0x6b",
		"affected": {
			"family": "unix",
			"platform": "Ubuntu 16.04 LTS"
		},
		"reference": {
			"source": "CVE",
			"ref_id": "CVE-2024-26586",
			"ref_url": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-26586"
		},
		"advisory": {
			"severity": "Medium",
			"rights": "Copyright (C) 2024 Canonical Ltd.",
			"public_date": "2024-02-22 17:15:00 UTC",
			"cve": {
				"text": "CVE-2024-26586",
				"href": "https://ubuntu.com/security/CVE-2024-26586",
				"public": "20240222"
			}
		}
	},
	"notes": {},
	"criteria": {
		"criterias": [
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000000",
						"comment": "linux package in xenial is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000040",
						"comment": "linux-hwe package in xenial is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000070",
						"comment": "linux-kvm package in xenial is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000030",
						"comment": "linux-aws package in xenial is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000080",
						"comment": "linux-aws-hwe package in xenial is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000050",
						"comment": "linux-azure package in xenial is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000060",
						"comment": "linux-gcp package in xenial is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:200767620000010",
						"comment": "linux-gke: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of standard support')."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000090",
						"comment": "linux-oracle package in xenial is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:200767620000030",
						"comment": "linux-oem: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of standard support')."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000010",
						"comment": "linux-raspi2: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of standard support')."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000020",
						"comment": "linux-snapdragon: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of standard support')."
					}
				]
			}
		]
	}
}
