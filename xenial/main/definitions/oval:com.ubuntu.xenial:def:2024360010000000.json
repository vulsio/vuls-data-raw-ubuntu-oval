{
	"class": "vulnerability",
	"id": "oval:com.ubuntu.xenial:def:2024360010000000",
	"version": "1",
	"metadata": {
		"title": "CVE-2024-36001 on Ubuntu 16.04 LTS (xenial) - medium",
		"description": "In the Linux kernel, the following vulnerability has been resolved:netfs: Fix the pre-flush when appending to a file in writethrough modeIn netfs_perform_write(), when the file is marked NETFS_ICTX_WRITETHROUGHor O_*SYNC or RWF_*SYNC was specified, write-through caching is performedon a buffered file.  When setting up for write-through, we flush anyconflicting writes in the region and wait for the write to complete,failing if there's a write error to return.The issue arises if we're writing at or above the EOF position because weskip the flush and - more importantly - the wait.  This becomes a problemif there's a partial folio at the end of the file that is being written outand we want to make a write to it too.  Both the already-running write andthe write we start both want to clear the writeback mark, but whoever issecond causes a warning looking something like:    ------------[ cut here ]------------    R=00000012: folio 11 is not under writeback    WARNING: CPU: 34 PID: 654 at fs/netfs/write_collect.c:105    ...    CPU: 34 PID: 654 Comm: kworker/u386:27 Tainted: G S ...    ...    Workqueue: events_unbound netfs_write_collection_worker    ...    RIP: 0010:netfs_writeback_lookup_folioFix this by making the flush-and-wait unconditional.  It will do nothing ifthere are no folios in the pagecache and will return quickly if there areno folios in the region specified.Further, move the WBC attachment above the flush call as the flush is goingto attach a WBC and detach it again if it is not present - and since weneed one anyway we might as well share it.",
		"affected": {
			"family": "unix",
			"platform": "Ubuntu 16.04 LTS"
		},
		"reference": {
			"source": "CVE",
			"ref_id": "CVE-2024-36001",
			"ref_url": "https://www.cve.org/CVERecord?id=CVE-2024-36001"
		},
		"advisory": {
			"severity": "Medium",
			"rights": "Copyright (C) 2024 Canonical Ltd.",
			"public_date": "2024-05-20 10:15:00 UTC",
			"cve": {
				"text": "CVE-2024-36001",
				"href": "https://ubuntu.com/security/CVE-2024-36001",
				"public": "20240520"
			}
		}
	},
	"notes": {},
	"criteria": {
		"criterias": [
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000000",
						"comment": "linux package in xenial is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000040",
						"comment": "linux-hwe package in xenial is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000070",
						"comment": "linux-kvm package in xenial is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000030",
						"comment": "linux-aws package in xenial is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000080",
						"comment": "linux-aws-hwe package in xenial is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000050",
						"comment": "linux-azure package in xenial is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000060",
						"comment": "linux-gcp package in xenial is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000090",
						"comment": "linux-oracle package in xenial is affected and may need fixing."
					}
				]
			}
		]
	}
}
