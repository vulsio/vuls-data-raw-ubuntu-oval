{
	"class": "vulnerability",
	"id": "oval:com.ubuntu.xenial:def:2021474820000000",
	"version": "1",
	"metadata": {
		"title": "CVE-2021-47482 on Ubuntu 16.04 LTS (xenial) - medium",
		"description": "In the Linux kernel, the following vulnerability has been resolved:net: batman-adv: fix error handlingSyzbot reported ODEBUG warning in batadv_nc_mesh_free(). The problem wasin wrong error handling in batadv_mesh_init().Before this patch batadv_mesh_init() was calling batadv_mesh_free() in caseof any batadv_*_init() calls failure. This approach may work well, whenthere is some kind of indicator, which can tell which parts of batadv areinitialized; but there isn't any.All written above lead to cleaning up uninitialized fields. Even if we hideODEBUG warning by initializing bat_priv->nc.work, syzbot was able to hitGPF in batadv_nc_purge_paths(), because hash pointer in still NULL. [1]To fix these bugs we can unwind batadv_*_init() calls one by one.It is good approach for 2 reasons: 1) It fixes bugs on error handlingpath 2) It improves the performance, since we won't call unneededbatadv_*_free() functions.So, this patch makes all batadv_*_init() clean up all allocated memorybefore returning with an error to no call correspoing batadv_*_free()and open-codes batadv_mesh_free() with proper order to avoid touchinguninitialized fields.",
		"affected": {
			"family": "unix",
			"platform": "Ubuntu 16.04 LTS"
		},
		"reference": {
			"source": "CVE",
			"ref_id": "CVE-2021-47482",
			"ref_url": "https://www.cve.org/CVERecord?id=CVE-2021-47482"
		},
		"advisory": {
			"severity": "Medium",
			"rights": "Copyright (C) 2024 Canonical Ltd.",
			"public_date": "2024-05-23",
			"cve": {
				"text": "CVE-2021-47482",
				"href": "https://ubuntu.com/security/CVE-2021-47482",
				"public": "20240523"
			}
		}
	},
	"notes": {},
	"criteria": {
		"criterias": [
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000000",
						"comment": "linux package in xenial is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000040",
						"comment": "linux-hwe package in xenial is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000070",
						"comment": "linux-kvm package in xenial is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000030",
						"comment": "linux-aws package in xenial is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000080",
						"comment": "linux-aws-hwe package in xenial is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000050",
						"comment": "linux-azure package in xenial is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000060",
						"comment": "linux-gcp package in xenial is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000090",
						"comment": "linux-oracle package in xenial is affected and may need fixing."
					}
				]
			}
		]
	}
}
