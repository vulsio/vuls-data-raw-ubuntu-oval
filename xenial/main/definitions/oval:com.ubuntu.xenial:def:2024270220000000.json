{
	"class": "vulnerability",
	"id": "oval:com.ubuntu.xenial:def:2024270220000000",
	"version": "1",
	"metadata": {
		"title": "CVE-2024-27022 on Ubuntu 16.04 LTS (xenial) - medium",
		"description": "In the Linux kernel, the following vulnerability has been resolved: fork:defer linking file vma until vma is fully initialized Thorvald reported aWARNING [1]. And the root cause is below race: CPU 1 CPU 2 forkhugetlbfs_fallocate dup_mmap hugetlbfs_punch_holei_mmap_lock_write(mapping); vma_interval_tree_insert_after -- Child vma isvisible through i_mmap tree. i_mmap_unlock_write(mapping);hugetlb_dup_vma_private -- Clear vma_lock outside i_mmap_rwsem!i_mmap_lock_write(mapping); hugetlb_vmdelete_list vma_interval_tree_foreachhugetlb_vma_trylock_write -- Vma_lock is cleared. tmp->vm_ops->open --Alloc new vma_lock outside i_mmap_rwsem! hugetlb_vma_unlock_write --Vma_lock is assigned!!! i_mmap_unlock_write(mapping);hugetlb_dup_vma_private() and hugetlb_vm_op_open() are called outsidei_mmap_rwsem lock while vma lock can be used in the same time. Fix this bydeferring linking file vma until vma is fully initialized. Those vmasshould be initialized first before they can be used.",
		"affected": {
			"family": "unix",
			"platform": "Ubuntu 16.04 LTS"
		},
		"reference": {
			"source": "CVE",
			"ref_id": "CVE-2024-27022",
			"ref_url": "https://www.cve.org/CVERecord?id=CVE-2024-27022"
		},
		"advisory": {
			"severity": "Medium",
			"rights": "Copyright (C) 2024 Canonical Ltd.",
			"public_date": "2024-05-01 06:15:00 UTC",
			"cve": {
				"text": "CVE-2024-27022",
				"href": "https://ubuntu.com/security/CVE-2024-27022",
				"public": "20240501",
				"cvss_score": "7.8",
				"cvss_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H"
			}
		}
	},
	"notes": {},
	"criteria": {
		"criterias": [
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000000",
						"comment": "linux package in xenial is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000040",
						"comment": "linux-hwe package in xenial is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000070",
						"comment": "linux-kvm package in xenial is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000030",
						"comment": "linux-aws package in xenial is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000080",
						"comment": "linux-aws-hwe package in xenial is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000050",
						"comment": "linux-azure package in xenial is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000060",
						"comment": "linux-gcp package in xenial is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000090",
						"comment": "linux-oracle package in xenial is affected and may need fixing."
					}
				]
			}
		]
	}
}
