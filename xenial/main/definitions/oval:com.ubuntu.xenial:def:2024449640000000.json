{
	"class": "vulnerability",
	"id": "oval:com.ubuntu.xenial:def:2024449640000000",
	"version": "1",
	"metadata": {
		"title": "CVE-2024-44964 on Ubuntu 16.04 LTS (xenial) - medium",
		"description": "In the Linux kernel, the following vulnerability has been resolved:idpf: fix memory leaks and crashes while performing a soft resetThe second tagged commit introduced a UAF, as it removed restoringq_vector->vport pointers after reinitializating the structures.This is due to that all queue allocation functions are performed herewith the new temporary vport structure and those functions rewritethe backpointers to the vport. Then, this new struct is freed andthe pointers start leading to nowhere.But generally speaking, the current logic is very fragile. It claimsto be more reliable when the system is low on memory, but in fact, itconsumes two times more memory as at the moment of running thisfunction, there are two vports allocated with their queues and vectors.Moreover, it claims to prevent the driver from running into \"bad state\",but in fact, any error during the rebuild leaves the old vport in thepartially allocated state.Finally, if the interface is down when the function is called, it alwaysallocates a new queue set, but when the user decides to enable theinterface later on, vport_open() allocates them once again, IOW there'sa clear memory leak here.Just don't allocate a new queue set when performing a reset, that solvescrashes and memory leaks. Readd the old queue number and reopen theinterface on rollback - that solves limbo states when the device is leftdisabled and/or without HW queues enabled.",
		"affected": {
			"family": "unix",
			"platform": "Ubuntu 16.04 LTS"
		},
		"reference": {
			"source": "CVE",
			"ref_id": "CVE-2024-44964",
			"ref_url": "https://www.cve.org/CVERecord?id=CVE-2024-44964"
		},
		"advisory": {
			"severity": "Medium",
			"rights": "Copyright (C) 2024 Canonical Ltd.",
			"public_date": "2024-09-05",
			"cve": {
				"text": "CVE-2024-44964",
				"href": "https://ubuntu.com/security/CVE-2024-44964",
				"public": "20240905"
			}
		}
	},
	"notes": {},
	"criteria": {
		"criterias": [
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000000",
						"comment": "linux package in xenial is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000040",
						"comment": "linux-hwe package in xenial is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000070",
						"comment": "linux-kvm package in xenial is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000030",
						"comment": "linux-aws package in xenial is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000080",
						"comment": "linux-aws-hwe package in xenial is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000050",
						"comment": "linux-azure package in xenial is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000060",
						"comment": "linux-gcp package in xenial is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000090",
						"comment": "linux-oracle package in xenial is affected and may need fixing."
					}
				]
			}
		]
	}
}
