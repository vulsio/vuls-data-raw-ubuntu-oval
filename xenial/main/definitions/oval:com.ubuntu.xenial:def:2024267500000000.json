{
	"class": "vulnerability",
	"id": "oval:com.ubuntu.xenial:def:2024267500000000",
	"version": "1",
	"metadata": {
		"title": "CVE-2024-26750 on Ubuntu 16.04 LTS (xenial) - medium",
		"description": "In the Linux kernel, the following vulnerability has been resolved:af_unix: Drop oob_skb ref before purging queue in GC. syzbot reportedanother task hung in __unix_gc(). [0] The current while loop assumes thatall of the left candidates have oob_skb and calling kfree_skb(oob_skb)releases the remaining candidates. However, I missed a case that oob_skbhas self-referencing fd and another fd and the latter sk is placed beforethe former in the candidate list. Then, the while loop never proceeds,resulting the task hung. __unix_gc() has the same loop just before purgingthe collected skb, so we can call kfree_skb(oob_skb) there and let__skb_queue_purge() release all inflight sockets. [0]: Sending NMI from CPU0 to CPUs 1: NMI backtrace for cpu 1 CPU: 1 PID: 2784 Comm: kworker/u4:8Not tainted 6.8.0-rc4-syzkaller-01028-g71b605d32017 #0 Hardware name:Google Google Compute Engine/Google Compute Engine, BIOS Google 01/25/2024Workqueue: events_unbound __unix_gc RIP:0010:__sanitizer_cov_trace_pc+0x0/0x70 kernel/kcov.c:200 Code: 89 fb e8 2300 00 00 48 8b 3d 84 f5 1a 0c 48 89 de 5b e9 43 26 57 00 0f 1f 00 90 90 9090 90 90 90 90 90 90 90 90 90 90 90 90 <f3> 0f 1e fa 48 8b 04 24 65 48 8b0d 90 52 70 7e 65 8b 15 91 52 70 RSP: 0018:ffffc9000a17fa78 EFLAGS:00000287 RAX: ffffffff8a0a6108 RBX: ffff88802b6c2640 RCX: ffff88802c0b3b80RDX: 0000000000000000 RSI: 0000000000000002 RDI: 0000000000000000 RBP:ffffc9000a17fbf0 R08: ffffffff89383f1d R09: 1ffff1100ee5ff84 R10:dffffc0000000000 R11: ffffed100ee5ff85 R12: 1ffff110056d84ee R13:ffffc9000a17fae0 R14: 0000000000000000 R15: ffffffff8f47b840 FS:0000000000000000(0000) GS:ffff8880b9500000(0000) knlGS:0000000000000000 CS:0010 DS: 0000 ES: 0000 CR0: 0000000080050033 CR2: 00007ffef5687ff8 CR3:0000000029b34000 CR4: 00000000003506f0 DR0: 0000000000000000 DR1:0000000000000000 DR2: 0000000000000000 DR3: 0000000000000000 DR6:00000000fffe0ff0 DR7: 0000000000000400 Call Trace: <NMI> </NMI> <TASK>__unix_gc+0xe69/0xf40 net/unix/garbage.c:343 process_one_workkernel/workqueue.c:2633 [inline] process_scheduled_works+0x913/0x1420kernel/workqueue.c:2706 worker_thread+0xa5f/0x1000 kernel/workqueue.c:2787kthread+0x2ef/0x390 kernel/kthread.c:388 ret_from_fork+0x4b/0x80arch/x86/kernel/process.c:147 ret_from_fork_asm+0x1b/0x30arch/x86/entry/entry_64.S:242 </TASK>",
		"affected": {
			"family": "unix",
			"platform": "Ubuntu 16.04 LTS"
		},
		"reference": {
			"source": "CVE",
			"ref_id": "CVE-2024-26750",
			"ref_url": "https://www.cve.org/CVERecord?id=CVE-2024-26750"
		},
		"advisory": {
			"severity": "Medium",
			"rights": "Copyright (C) 2024 Canonical Ltd.",
			"public_date": "2024-04-04 09:15:00 UTC",
			"cve": {
				"text": "CVE-2024-26750",
				"href": "https://ubuntu.com/security/CVE-2024-26750",
				"public": "20240404"
			},
			"public_date_at_usn": "2024-04-04 09:15:00 UTC",
			"ref": [
				"https://ubuntu.com/security/notices/USN-6820-1",
				"https://ubuntu.com/security/notices/USN-6821-1",
				"https://ubuntu.com/security/notices/USN-6821-2",
				"https://ubuntu.com/security/notices/USN-6828-1",
				"https://ubuntu.com/security/notices/USN-6820-2",
				"https://ubuntu.com/security/notices/USN-6821-3",
				"https://ubuntu.com/security/notices/USN-6821-4"
			]
		}
	},
	"notes": {},
	"criteria": {
		"criterias": [
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000000",
						"comment": "linux package in xenial is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000040",
						"comment": "linux-hwe package in xenial is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000070",
						"comment": "linux-kvm package in xenial is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000030",
						"comment": "linux-aws package in xenial is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000080",
						"comment": "linux-aws-hwe package in xenial is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000050",
						"comment": "linux-azure package in xenial is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000060",
						"comment": "linux-gcp package in xenial is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000090",
						"comment": "linux-oracle package in xenial is affected and may need fixing."
					}
				]
			}
		]
	}
}
