{
	"class": "vulnerability",
	"id": "oval:com.ubuntu.xenial:def:2024385820000000",
	"version": "1",
	"metadata": {
		"title": "CVE-2024-38582 on Ubuntu 16.04 FIPS Certified (xenial) - medium",
		"description": "In the Linux kernel, the following vulnerability has been resolved:nilfs2: fix potential hang in nilfs_detach_log_writer()Syzbot has reported a potential hang in nilfs_detach_log_writer() calledduring nilfs2 unmount.Analysis revealed that this is because nilfs_segctor_sync(), whichsynchronizes with the log writer thread, can be called afternilfs_segctor_destroy() terminates that thread, as shown in the call tracebelow:nilfs_detach_log_writer  nilfs_segctor_destroy    nilfs_segctor_kill_thread  --> Shut down log writer thread    flush_work      nilfs_iput_work_func        nilfs_dispose_list          iput            nilfs_evict_inode              nilfs_transaction_commit                nilfs_construct_segment (if inode needs sync)                  nilfs_segctor_sync  --> Attempt to synchronize with                                          log writer thread                           *** DEADLOCK ***Fix this issue by changing nilfs_segctor_sync() so that the log writerthread returns normally without synchronizing after it terminates, and byforcing tasks that are already waiting to complete once after the threadterminates.The skipped inode metadata flushout will then be processed together in thesubsequent cleanup work in nilfs_segctor_destroy().",
		"affected": {
			"family": "unix",
			"platform": "Ubuntu 16.04 FIPS Certified"
		},
		"reference": {
			"source": "CVE",
			"ref_id": "CVE-2024-38582",
			"ref_url": "https://www.cve.org/CVERecord?id=CVE-2024-38582"
		},
		"advisory": {
			"severity": "Medium",
			"rights": "Copyright (C) 2024 Canonical Ltd.",
			"public_date": "2024-06-20",
			"cve": {
				"text": "CVE-2024-38582",
				"href": "https://ubuntu.com/security/CVE-2024-38582",
				"public": "20240620"
			}
		}
	},
	"notes": {},
	"criteria": {
		"criterias": [
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201585530000000",
						"comment": "linux-fips package in fips/xenial is affected and may need fixing."
					}
				]
			}
		]
	}
}
