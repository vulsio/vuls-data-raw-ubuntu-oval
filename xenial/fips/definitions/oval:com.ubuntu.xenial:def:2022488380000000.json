{
	"class": "vulnerability",
	"id": "oval:com.ubuntu.xenial:def:2022488380000000",
	"version": "1",
	"metadata": {
		"title": "CVE-2022-48838 on Ubuntu Pro FIPS 16.04 LTS (xenial) - medium",
		"description": "In the Linux kernel, the following vulnerability has been resolved:usb: gadget: Fix use-after-free bug by not setting udc->dev.driverThe syzbot fuzzer found a use-after-free bug:BUG: KASAN: use-after-free in dev_uevent+0x712/0x780drivers/base/core.c:2320Read of size 8 at addr ffff88802b934098 by task udevd/3689CPU: 2 PID: 3689 Comm: udevd Not tainted5.17.0-rc4-syzkaller-00229-g4f12b742eb2b #0Hardware name: QEMU Standard PC (Q35 + ICH9, 2009), BIOS 1.14.0-204/01/2014Call Trace: <TASK> __dump_stack lib/dump_stack.c:88 [inline] dump_stack_lvl+0xcd/0x134 lib/dump_stack.c:106 print_address_description.constprop.0.cold+0x8d/0x303mm/kasan/report.c:255 __kasan_report mm/kasan/report.c:442 [inline] kasan_report.cold+0x83/0xdf mm/kasan/report.c:459 dev_uevent+0x712/0x780 drivers/base/core.c:2320 uevent_show+0x1b8/0x380 drivers/base/core.c:2391 dev_attr_show+0x4b/0x90 drivers/base/core.c:2094Although the bug manifested in the driver core, the real cause was arace with the gadget core.  dev_uevent() does:\tif (dev->driver)\t\tadd_uevent_var(env, \"DRIVER=%s\", dev->driver->name);and between the test and the dereference of dev->driver, the gadgetcore sets dev->driver to NULL.The race wouldn't occur if the gadget core registered its devices ona real bus, using the standard synchronization techniques of thedriver core.  However, it's not necessary to make such a large changein order to fix this bug; all we need to do is make sure thatudc->dev.driver is always NULL.In fact, there is no reason for udc->dev.driver ever to be set toanything, let alone to the value it currently gets: the address of thegadget's driver.  After all, a gadget driver only knows how to managea gadget, not how to manage a UDC.This patch simply removes the statements in the gadget core that touchudc->dev.driver.\n\n    Update Instructions:\n\n    Run `sudo pro fix CVE-2022-48838` to fix the vulnerability. The problem can be corrected\n    by updating your system to the following package versions:\n\nlinux-image-4.15.0-184-generic - 4.15.0-184.194~16.04.1\nlinux-image-unsigned-4.15.0-184-generic - 4.15.0-184.194~16.04.1\nlinux-image-unsigned-4.15.0-184-lowlatency - 4.15.0-184.194~16.04.1\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro\n\nlinux-image-unsigned-4.15.0-1133-aws - 4.15.0-1133.143~16.04.1\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro\n\nlinux-image-unsigned-4.15.0-1142-azure - 4.15.0-1142.156~16.04.1\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro\n\nlinux-image-unsigned-4.15.0-1127-gcp - 4.15.0-1127.142~16.04.1\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro\n\nlinux-image-unsigned-4.15.0-1098-oracle - 4.15.0-1098.108~16.04.1\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro",
		"affected": {
			"family": "unix",
			"platform": "Ubuntu Pro FIPS 16.04 LTS"
		},
		"reference": {
			"source": "CVE",
			"ref_id": "CVE-2022-48838",
			"ref_url": "https://www.cve.org/CVERecord?id=CVE-2022-48838"
		},
		"advisory": {
			"severity": "Medium",
			"rights": "Copyright (C) 2024 Canonical Ltd.",
			"public_date": "2024-07-16 13:15:00 UTC",
			"cve": {
				"text": "CVE-2022-48838",
				"href": "https://ubuntu.com/security/CVE-2022-48838",
				"public": "20240716",
				"cvss_score": "5.5",
				"cvss_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H"
			}
		}
	},
	"notes": {},
	"criteria": {
		"criterias": [
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000000",
						"comment": "linux package in xenial is affected. An update containing the fix has been completed and is pending publication (note: '4.4.0-259.293')."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:202137720000000",
						"comment": "linux-hwe package in xenial was vulnerable but has been fixed (note: '4.15.0-184.194~16.04.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000070",
						"comment": "linux-kvm package in xenial is affected. An update containing the fix has been completed and is pending publication (note: '4.4.0-1137.147')."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000030",
						"comment": "linux-aws package in xenial is affected. An update containing the fix has been completed and is pending publication (note: '4.4.0-1174.189')."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:202137720000010",
						"comment": "linux-aws-hwe package in xenial was vulnerable but has been fixed (note: '4.15.0-1133.143~16.04.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:202137720000020",
						"comment": "linux-azure package in xenial was vulnerable but has been fixed (note: '4.15.0-1142.156~16.04.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000100",
						"comment": "linux-fips: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'ESM criteria, was needed')."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:202137720000030",
						"comment": "linux-gcp package in xenial was vulnerable but has been fixed (note: '4.15.0-1127.142~16.04.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:200767620000010",
						"comment": "linux-gke: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of standard support')."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:202137720000040",
						"comment": "linux-oracle package in xenial was vulnerable but has been fixed (note: '4.15.0-1098.108~16.04.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:200767620000030",
						"comment": "linux-oem: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of standard support')."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000010",
						"comment": "linux-raspi2: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of standard support')."
					}
				]
			}
		]
	}
}
