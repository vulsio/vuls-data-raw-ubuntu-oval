{
  "class": "vulnerability",
  "id": "oval:com.ubuntu.xenial:def:201973030000000",
  "version": "1",
  "metadata": {
    "Title": "CVE-2019-7303 on Ubuntu 16.04 FIPS Certified (xenial) - medium.",
    "Description": "A vulnerability in the seccomp filters of Canonical snapd before version 2.37.4 allows a strict mode snap to insert characters into a terminal on a 64-bit host. The seccomp rules were generated to match 64-bit ioctl(2) commands on a 64-bit platform; however, the Linux kernel only uses the lower 32 bits to determine which ioctl(2) commands to run. This issue affects: Canonical snapd versions prior to 2.37.4.\n\nUpdate Instructions:\n\nRun `sudo pro fix CVE-2019-7303` to fix the vulnerability. The problem can be corrected\nby updating your system to the following package versions:\n\nsnap-confine - 2.37.4\nsnapd - 2.37.4\nsnapd-xdg-open - 2.37.4\nubuntu-core-launcher - 2.37.4\nubuntu-core-snapd-units - 2.37.4\nubuntu-snappy - 2.37.4\nubuntu-snappy-cli - 2.37.4\nNo subscription required",
    "affected": {
      "family": "unix",
      "Platform": "Ubuntu 16.04 FIPS Certified"
    },
    "reference": {
      "source": "CVE",
      "ref_id": "CVE-2019-7303",
      "ref_url": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-7303"
    },
    "advisory": {
      "Severity": "Medium",
      "Rights": "Copyright (C) 2019 Canonical Ltd.",
      "PublicDate": "2019-03-21",
      "Bug": [
        "https://launchpad.net/bugs/1812973"
      ],
      "cve": {
        "text": "CVE-2019-7303",
        "href": "https://ubuntu.com/security/CVE-2019-7303",
        "public": "20190321",
        "cvss_score": "7.5",
        "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N",
        "usns": "3917-1"
      },
      "PublicDateAtUsn": "2019-03-21",
      "AssignedTo": "zyga",
      "DiscoveredBy": "Jann Horn",
      "Crd": "",
      "Ref": null
    }
  },
  "notes": {
    "Note": "jdstrand> this is a kernel limitation that is documented in the seccomp man page, but arguably the kernel should perform the seccomp filter check on the value that it is ultimately going to process (which likely means an improvement to libseccomp to generate the appropriate BPF to do this) this was further complicated by the fact that the kernel and glibc disagree on the function prototype of ioctl, where the glibc man page documents it as unsigned long and the kernel treats it as int (note, the tty_ioctl man page (which is the one that documents TIOCSTI) lists the ioctl second argument as an int) due to miscoordination, 2.37.4 is going to -updates first as part of the regular SRU cycle. Once that passes, we'll rebuild and publish to the security pocket and issue a USN. once this issue is public, the global profile initialization code that is used to address this issue will also be made public"
  },
  "criteria": {
    "criterions": [
      {
        "test_ref": "oval:com.ubuntu.xenial:tst:201973030000000",
        "comment": "snapd package in xenial was vulnerable but has been fixed (note: '2.37.4')."
      }
    ]
  }
}
