{
	"class": "vulnerability",
	"id": "oval:com.ubuntu.xenial:def:2024268120000000",
	"version": "1",
	"metadata": {
		"title": "CVE-2024-26812 on Ubuntu Pro FIPS 16.04 LTS (xenial) - medium",
		"description": "In the Linux kernel, the following vulnerability has been resolved:vfio/pci: Create persistent INTx handler A vulnerability exists where theeventfd for INTx signaling can be deconfigured, which unregisters the IRQhandler but still allows eventfds to be signaled with a NULL contextthrough the SET_IRQS ioctl or through unmask irqfd if the device interruptis pending. Ideally this could be solved with some additional locking; theigate mutex serializes the ioctl and config space accesses, and theinterrupt handler is unregistered relative to the trigger, but the irqfdpath runs asynchronous to those. The igate mutex cannot be acquired fromthe atomic context of the eventfd wake function. Disabling the irqfdrelative to the eventfd registration is potentially incompatible withexisting userspace. As a result, the solution implemented here movesconfiguration of the INTx interrupt handler to track the lifetime of theINTx context object and irq_type configuration, rather than registration ofa particular trigger eventfd. Synchronization is added between the ioctlpath and eventfd_signal() wrapper such that the eventfd trigger can bedynamically updated relative to in-flight interrupts or irqfd callbacks.\n\n    Update Instructions:\n\n    Run `sudo pro fix CVE-2024-26812` to fix the vulnerability. The problem can be corrected\n    by updating your system to the following package versions:\n\nlinux-image-4.15.0-230-generic - 4.15.0-230.242~16.04.1\nlinux-image-unsigned-4.15.0-230-generic - 4.15.0-230.242~16.04.1\nlinux-image-unsigned-4.15.0-230-lowlatency - 4.15.0-230.242~16.04.1\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro\n\nlinux-image-unsigned-4.15.0-1174-aws - 4.15.0-1174.187~16.04.1\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro\n\nlinux-image-unsigned-4.15.0-1182-azure - 4.15.0-1182.197~16.04.1\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro\n\nlinux-image-unsigned-4.15.0-1167-gcp - 4.15.0-1167.184~16.04.2\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro\n\nlinux-image-unsigned-4.15.0-1136-oracle - 4.15.0-1136.147~16.04.1\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro",
		"affected": {
			"family": "unix",
			"platform": "Ubuntu Pro FIPS 16.04 LTS"
		},
		"reference": {
			"source": "CVE",
			"ref_id": "CVE-2024-26812",
			"ref_url": "https://www.cve.org/CVERecord?id=CVE-2024-26812"
		},
		"advisory": {
			"severity": "Medium",
			"rights": "Copyright (C) 2024 Canonical Ltd.",
			"public_date": "2024-04-05 09:15:00 UTC",
			"cve": {
				"text": "CVE-2024-26812",
				"href": "https://ubuntu.com/security/CVE-2024-26812",
				"public": "20240405"
			},
			"public_date_at_usn": "2024-04-05 09:15:00 UTC",
			"ref": [
				"https://ubuntu.com/security/notices/USN-6816-1",
				"https://ubuntu.com/security/notices/USN-6817-1",
				"https://ubuntu.com/security/notices/USN-6817-2",
				"https://ubuntu.com/security/notices/USN-6817-3",
				"https://ubuntu.com/security/notices/USN-6878-1",
				"https://ubuntu.com/security/notices/USN-6896-1",
				"https://ubuntu.com/security/notices/USN-6898-1",
				"https://ubuntu.com/security/notices/USN-6896-2",
				"https://ubuntu.com/security/notices/USN-6898-2",
				"https://ubuntu.com/security/notices/USN-6896-3",
				"https://ubuntu.com/security/notices/USN-6898-3",
				"https://ubuntu.com/security/notices/USN-6896-4",
				"https://ubuntu.com/security/notices/USN-6896-5",
				"https://ubuntu.com/security/notices/USN-6898-4",
				"https://ubuntu.com/security/notices/USN-6917-1",
				"https://ubuntu.com/security/notices/USN-6919-1",
				"https://ubuntu.com/security/notices/USN-6927-1",
				"https://ubuntu.com/security/notices/USN-7019-1",
				"https://ubuntu.com/security/notices/USN-7069-1",
				"https://ubuntu.com/security/notices/USN-7069-2"
			]
		}
	},
	"notes": {},
	"criteria": {
		"criterias": [
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000000",
						"comment": "linux package in xenial is affected. An update containing the fix has been completed and is pending publication (note: '4.4.0-260.294')."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:2023525100000000",
						"comment": "linux-hwe package in xenial was vulnerable but has been fixed (note: '4.15.0-230.242~16.04.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000070",
						"comment": "linux-kvm package in xenial is affected. An update containing the fix has been completed and is pending publication (note: '4.4.0-1138.148')."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000030",
						"comment": "linux-aws package in xenial is affected. An update containing the fix has been completed and is pending publication (note: '4.4.0-1175.190')."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:2023525100000010",
						"comment": "linux-aws-hwe package in xenial was vulnerable but has been fixed (note: '4.15.0-1174.187~16.04.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:2023525100000020",
						"comment": "linux-azure package in xenial was vulnerable but has been fixed (note: '4.15.0-1182.197~16.04.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000100",
						"comment": "linux-fips package in fips-updates/xenial is affected. An update containing the fix has been completed and is pending publication (note: '4.4.0-1106.113')."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:2023525100000030",
						"comment": "linux-gcp package in xenial was vulnerable but has been fixed (note: '4.15.0-1167.184~16.04.2')."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:200767620000010",
						"comment": "linux-gke: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of standard support')."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:2022211230000010",
						"comment": "linux-oracle package in xenial was vulnerable but has been fixed (note: '4.15.0-1136.147~16.04.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:200767620000030",
						"comment": "linux-oem: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of standard support')."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000010",
						"comment": "linux-raspi2: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of standard support')."
					}
				]
			}
		]
	}
}
