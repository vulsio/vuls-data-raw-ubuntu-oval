{
	"class": "vulnerability",
	"id": "oval:com.ubuntu.xenial:def:2024502540000000",
	"version": "1",
	"metadata": {
		"title": "CVE-2024-50254 on Ubuntu Pro FIPS 16.04 LTS (xenial) - medium",
		"description": "In the Linux kernel, the following vulnerability has been resolved:bpf: Free dynamically allocated bits in bpf_iter_bits_destroy()bpf_iter_bits_destroy() uses \"kit->nr_bits <= 64\" to check whether thebits are dynamically allocated. However, the check is incorrect and maycause a kmemleak as shown below:unreferenced object 0xffff88812628c8c0 (size 32):  comm \"swapper/0\", pid 1, jiffies 4294727320  hex dump (first 32 bytes):\tb0 c1 55 f5 81 88 ff ff f0 f0 f0 f0 f0 f0 f0 f0  ..U...........\tf0 f0 f0 f0 f0 f0 f0 f0 00 00 00 00 00 00 00 00  ..............  backtrace (crc 781e32cc):\t[<00000000c452b4ab>] kmemleak_alloc+0x4b/0x80\t[<0000000004e09f80>] __kmalloc_node_noprof+0x480/0x5c0\t[<00000000597124d6>] __alloc.isra.0+0x89/0xb0\t[<000000004ebfffcd>] alloc_bulk+0x2af/0x720\t[<00000000d9c10145>] prefill_mem_cache+0x7f/0xb0\t[<00000000ff9738ff>] bpf_mem_alloc_init+0x3e2/0x610\t[<000000008b616eac>] bpf_global_ma_init+0x19/0x30\t[<00000000fc473efc>] do_one_initcall+0xd3/0x3c0\t[<00000000ec81498c>] kernel_init_freeable+0x66a/0x940\t[<00000000b119f72f>] kernel_init+0x20/0x160\t[<00000000f11ac9a7>] ret_from_fork+0x3c/0x70\t[<0000000004671da4>] ret_from_fork_asm+0x1a/0x30That is because nr_bits will be set as zero in bpf_iter_bits_next()after all bits have been iterated.Fix the issue by setting kit->bit to kit->nr_bits instead of settingkit->nr_bits to zero when the iteration completes inbpf_iter_bits_next(). In addition, use \"!nr_bits || bits >= nr_bits\" tocheck whether the iteration is complete and still use \"nr_bits > 64\" toindicate whether bits are dynamically allocated. The \"!nr_bits\" check isnecessary because bpf_iter_bits_new() may fail before settingkit->nr_bits, and this condition will stop the iteration early insteadof accessing the zeroed or freed kit->bits.Considering the initial value of kit->bits is -1 and the type ofkit->nr_bits is unsigned int, change the type of kit->nr_bits to int.The potential overflow problem will be handled in the following patch.",
		"affected": {
			"family": "unix",
			"platform": "Ubuntu Pro FIPS 16.04 LTS"
		},
		"reference": {
			"source": "CVE",
			"ref_id": "CVE-2024-50254",
			"ref_url": "https://www.cve.org/CVERecord?id=CVE-2024-50254"
		},
		"advisory": {
			"severity": "Medium",
			"rights": "Copyright (C) 2024 Canonical Ltd.",
			"public_date": "2024-11-11",
			"cve": {
				"text": "CVE-2024-50254",
				"href": "https://ubuntu.com/security/CVE-2024-50254",
				"public": "20241111"
			}
		}
	},
	"notes": {},
	"criteria": {
		"criterias": [
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000000",
						"comment": "linux package in xenial is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000040",
						"comment": "linux-hwe package in xenial is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000070",
						"comment": "linux-kvm package in xenial is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000030",
						"comment": "linux-aws package in xenial is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000080",
						"comment": "linux-aws-hwe package in xenial is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000050",
						"comment": "linux-azure package in xenial is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000100",
						"comment": "linux-fips package in fips-updates/xenial is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000060",
						"comment": "linux-gcp package in xenial is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000090",
						"comment": "linux-oracle package in xenial is affected and may need fixing."
					}
				]
			}
		]
	}
}
