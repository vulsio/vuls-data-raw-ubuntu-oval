{
	"class": "vulnerability",
	"id": "oval:com.ubuntu.xenial:def:2024531520000000",
	"version": "1",
	"metadata": {
		"title": "CVE-2024-53152 on Ubuntu Pro FIPS 16.04 LTS (xenial) - medium",
		"description": "In the Linux kernel, the following vulnerability has been resolved:PCI: tegra194: Move controller cleanups to pex_ep_event_pex_rst_deassert()Currently, the endpoint cleanup function dw_pcie_ep_cleanup() and EPFdeinit notify function pci_epc_deinit_notify() are called during theexecution of pex_ep_event_pex_rst_assert() i.e., when the host has assertedPERST#. But quickly after this step, refclk will also be disabled by thehost.All of the tegra194 endpoint SoCs supported as of now depend on the refclkfrom the host for keeping the controller operational. Due to thislimitation, any access to the hardware registers in the absence of refclkwill result in a whole endpoint crash. Unfortunately, most of thecontroller cleanups require accessing the hardware registers (like eDMAcleanup performed in dw_pcie_ep_cleanup(), etc...). So these cleanupfunctions can cause the crash in the endpoint SoC once host asserts PERST#.One way to address this issue is by generating the refclk in the endpointitself and not depending on the host. But that is not always possible assome of the endpoint designs do require the endpoint to consume refclk fromthe host.Thus, fix this crash by moving the controller cleanups to the start ofthe pex_ep_event_pex_rst_deassert() function. This function is calledwhenever the host has deasserted PERST# and it is guaranteed that therefclk would be active at this point. So at the start of this function(after enabling resources) the controller cleanup can be performed. Oncefinished, rest of the code execution for PERST# deassert can continue asusual.",
		"affected": {
			"family": "unix",
			"platform": "Ubuntu Pro FIPS 16.04 LTS"
		},
		"reference": {
			"source": "CVE",
			"ref_id": "CVE-2024-53152",
			"ref_url": "https://www.cve.org/CVERecord?id=CVE-2024-53152"
		},
		"advisory": {
			"severity": "Medium",
			"rights": "Copyright (C) 2024 Canonical Ltd.",
			"public_date": "2024-12-24 12:15:00 UTC",
			"cve": {
				"text": "CVE-2024-53152",
				"href": "https://ubuntu.com/security/CVE-2024-53152",
				"public": "20241224"
			}
		}
	},
	"notes": {},
	"criteria": {
		"criterias": [
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000000",
						"comment": "linux package in xenial is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000040",
						"comment": "linux-hwe package in xenial is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000070",
						"comment": "linux-kvm package in xenial is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000030",
						"comment": "linux-aws package in xenial is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000080",
						"comment": "linux-aws-hwe package in xenial is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000050",
						"comment": "linux-azure package in xenial is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000100",
						"comment": "linux-fips package in fips-updates/xenial is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000060",
						"comment": "linux-gcp package in xenial is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000090",
						"comment": "linux-oracle package in xenial is affected and may need fixing."
					}
				]
			}
		]
	}
}
