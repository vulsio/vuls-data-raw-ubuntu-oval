{
	"class": "vulnerability",
	"id": "oval:com.ubuntu.xenial:def:2024565520000000",
	"version": "1",
	"metadata": {
		"title": "CVE-2024-56552 on Ubuntu 16.04 LTS (xenial) - medium",
		"description": "In the Linux kernel, the following vulnerability has been resolved:drm/xe/guc_submit: fix race around suspend_pendingCurrently in some testcases we can trigger:xe 0000:03:00.0: [drm] Assertion `exec_queue_destroyed(q)` failed!....WARNING: CPU: 18 PID: 2640 at drivers/gpu/drm/xe/xe_guc_submit.c:1826xe_guc_sched_done_handler+0xa54/0xef0 [xe]xe 0000:03:00.0: [drm] *ERROR* GT1: DEREGISTER_DONE: Unexpected enginestate 0x00a1, guc_id=57Looking at a snippet of corresponding ftrace for this GuC id we can see:162.673311: xe_sched_msg_add:     dev=0000:03:00.0, gt=1 guc_id=57,opcode=3162.673317: xe_sched_msg_recv:    dev=0000:03:00.0, gt=1 guc_id=57,opcode=3162.673319: xe_exec_queue_scheduling_disable: dev=0000:03:00.0, 1:0x2,gt=1, width=1, guc_id=57, guc_state=0x29, flags=0x0162.674089: xe_exec_queue_kill:   dev=0000:03:00.0, 1:0x2, gt=1, width=1,guc_id=57, guc_state=0x29, flags=0x0162.674108: xe_exec_queue_close:  dev=0000:03:00.0, 1:0x2, gt=1, width=1,guc_id=57, guc_state=0xa9, flags=0x0162.674488: xe_exec_queue_scheduling_done: dev=0000:03:00.0, 1:0x2, gt=1,width=1, guc_id=57, guc_state=0xa9, flags=0x0162.678452: xe_exec_queue_deregister: dev=0000:03:00.0, 1:0x2, gt=1,width=1, guc_id=57, guc_state=0xa1, flags=0x0It looks like we try to suspend the queue (opcode=3), settingsuspend_pending and triggering a disable_scheduling. The user thencloses the queue. However the close will also forcefully signal thesuspend fence after killing the queue, later when the G2H response fordisable_scheduling comes back we have now cleared suspend_pending whensignalling the suspend fence, so the disable_scheduling now incorrectlytries to also deregister the queue. This leads to warnings since the queuehas yet to even be marked for destruction. We also seem to triggererrors later with trying to double unregister the same queue.To fix this tweak the ordering when handling the response to ensure wedon't race with a disable_scheduling that didn't actually intend toperform an unregister.  The destruction path should now also correctlywait for any pending_disable before marking as destroyed.(cherry picked from commit f161809b362f027b6d72bd998e47f8f0bad60a2e)\n\n    Update Instructions:\n\n    Run `sudo pro fix CVE-2024-56552` to fix the vulnerability. The problem can be corrected\n    by updating your system to the following package versions:\n\nlinux-image-4.4.0-2-generic - 4.4.0-2.16\nlinux-image-4.4.0-2-generic-lpae - 4.4.0-2.16\nlinux-image-4.4.0-2-lowlatency - 4.4.0-2.16\nlinux-image-4.4.0-2-powerpc-e500mc - 4.4.0-2.16\nlinux-image-4.4.0-2-powerpc-smp - 4.4.0-2.16\nlinux-image-4.4.0-2-powerpc64-emb - 4.4.0-2.16\nlinux-image-4.4.0-2-powerpc64-smp - 4.4.0-2.16\nlinux-image-extra-4.4.0-2-generic - 4.4.0-2.16\nNo subscription required\n\nlinux-image-4.8.0-39-generic - 4.8.0-39.42~16.04.1\nlinux-image-4.8.0-39-generic-lpae - 4.8.0-39.42~16.04.1\nlinux-image-4.8.0-39-lowlatency - 4.8.0-39.42~16.04.1\nlinux-image-extra-4.8.0-39-generic - 4.8.0-39.42~16.04.1\nNo subscription required\n\nlinux-image-4.4.0-1004-kvm - 4.4.0-1004.9\nNo subscription required\n\nlinux-image-4.4.0-1001-aws - 4.4.0-1001.10\nlinux-image-extra-4.4.0-1001-aws - 4.4.0-1001.10\nNo subscription required\n\nlinux-image-4.15.0-1030-aws - 4.15.0-1030.31~16.04.1\nNo subscription required\n\nlinux-image-4.11.0-1009-azure - 4.11.0-1009.9\nlinux-image-extra-4.11.0-1009-azure - 4.11.0-1009.9\nNo subscription required\n\nlinux-image-4.10.0-1004-gcp - 4.10.0-1004.4\nlinux-image-extra-4.10.0-1004-gcp - 4.10.0-1004.4\nNo subscription required\n\nlinux-image-unsigned-4.15.0-1007-oracle - 4.15.0-1007.9~16.04.1\nNo subscription required",
		"affected": {
			"family": "unix",
			"platform": "Ubuntu 16.04 LTS"
		},
		"reference": {
			"source": "CVE",
			"ref_id": "CVE-2024-56552",
			"ref_url": "https://www.cve.org/CVERecord?id=CVE-2024-56552"
		},
		"advisory": {
			"severity": "Medium",
			"rights": "Copyright (C) 2024 Canonical Ltd.",
			"public_date": "2024-12-27 15:15:00 UTC",
			"cve": {
				"text": "CVE-2024-56552",
				"href": "https://ubuntu.com/security/CVE-2024-56552",
				"public": "20241227"
			}
		}
	},
	"notes": {},
	"criteria": {
		"criterias": [
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201431800000000",
						"comment": "linux package in xenial, is related to the CVE in some way and has been fixed (note: '4.4.0-2.16')."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201431800000010",
						"comment": "linux-hwe package in xenial, is related to the CVE in some way and has been fixed (note: '4.8.0-39.42~16.04.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:200636350000110",
						"comment": "linux-kvm package in xenial, is related to the CVE in some way and has been fixed (note: '4.4.0-1004.9')."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:200636350000060",
						"comment": "linux-aws package in xenial, is related to the CVE in some way and has been fixed (note: '4.4.0-1001.10')."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:200747740000010",
						"comment": "linux-aws-hwe package in xenial, is related to the CVE in some way and has been fixed (note: '4.15.0-1030.31~16.04.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:200636350000090",
						"comment": "linux-azure package in xenial, is related to the CVE in some way and has been fixed (note: '4.11.0-1009.9')."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:200636350000100",
						"comment": "linux-gcp package in xenial, is related to the CVE in some way and has been fixed (note: '4.10.0-1004.4')."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:200767620000010",
						"comment": "linux-gke: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of standard support')."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:200747740000020",
						"comment": "linux-oracle package in xenial, is related to the CVE in some way and has been fixed (note: '4.15.0-1007.9~16.04.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:200767620000030",
						"comment": "linux-oem: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of standard support')."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000010",
						"comment": "linux-raspi2: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of standard support')."
					}
				]
			}
		]
	}
}
