{
	"class": "vulnerability",
	"id": "oval:com.ubuntu.xenial:def:2024502540000000",
	"version": "1",
	"metadata": {
		"title": "CVE-2024-50254 on Ubuntu 16.04 LTS (xenial) - medium",
		"description": "In the Linux kernel, the following vulnerability has been resolved:bpf: Free dynamically allocated bits in bpf_iter_bits_destroy()bpf_iter_bits_destroy() uses \"kit->nr_bits <= 64\" to check whether thebits are dynamically allocated. However, the check is incorrect and maycause a kmemleak as shown below:unreferenced object 0xffff88812628c8c0 (size 32):  comm \"swapper/0\", pid 1, jiffies 4294727320  hex dump (first 32 bytes):\tb0 c1 55 f5 81 88 ff ff f0 f0 f0 f0 f0 f0 f0 f0  ..U...........\tf0 f0 f0 f0 f0 f0 f0 f0 00 00 00 00 00 00 00 00  ..............  backtrace (crc 781e32cc):\t[<00000000c452b4ab>] kmemleak_alloc+0x4b/0x80\t[<0000000004e09f80>] __kmalloc_node_noprof+0x480/0x5c0\t[<00000000597124d6>] __alloc.isra.0+0x89/0xb0\t[<000000004ebfffcd>] alloc_bulk+0x2af/0x720\t[<00000000d9c10145>] prefill_mem_cache+0x7f/0xb0\t[<00000000ff9738ff>] bpf_mem_alloc_init+0x3e2/0x610\t[<000000008b616eac>] bpf_global_ma_init+0x19/0x30\t[<00000000fc473efc>] do_one_initcall+0xd3/0x3c0\t[<00000000ec81498c>] kernel_init_freeable+0x66a/0x940\t[<00000000b119f72f>] kernel_init+0x20/0x160\t[<00000000f11ac9a7>] ret_from_fork+0x3c/0x70\t[<0000000004671da4>] ret_from_fork_asm+0x1a/0x30That is because nr_bits will be set as zero in bpf_iter_bits_next()after all bits have been iterated.Fix the issue by setting kit->bit to kit->nr_bits instead of settingkit->nr_bits to zero when the iteration completes inbpf_iter_bits_next(). In addition, use \"!nr_bits || bits >= nr_bits\" tocheck whether the iteration is complete and still use \"nr_bits > 64\" toindicate whether bits are dynamically allocated. The \"!nr_bits\" check isnecessary because bpf_iter_bits_new() may fail before settingkit->nr_bits, and this condition will stop the iteration early insteadof accessing the zeroed or freed kit->bits.Considering the initial value of kit->bits is -1 and the type ofkit->nr_bits is unsigned int, change the type of kit->nr_bits to int.The potential overflow problem will be handled in the following patch.\n\n    Update Instructions:\n\n    Run `sudo pro fix CVE-2024-50254` to fix the vulnerability. The problem can be corrected\n    by updating your system to the following package versions:\n\nlinux-image-4.4.0-2-generic - 4.4.0-2.16\nlinux-image-4.4.0-2-generic-lpae - 4.4.0-2.16\nlinux-image-4.4.0-2-lowlatency - 4.4.0-2.16\nlinux-image-4.4.0-2-powerpc-e500mc - 4.4.0-2.16\nlinux-image-4.4.0-2-powerpc-smp - 4.4.0-2.16\nlinux-image-4.4.0-2-powerpc64-emb - 4.4.0-2.16\nlinux-image-4.4.0-2-powerpc64-smp - 4.4.0-2.16\nlinux-image-extra-4.4.0-2-generic - 4.4.0-2.16\nNo subscription required\n\nlinux-image-4.8.0-39-generic - 4.8.0-39.42~16.04.1\nlinux-image-4.8.0-39-generic-lpae - 4.8.0-39.42~16.04.1\nlinux-image-4.8.0-39-lowlatency - 4.8.0-39.42~16.04.1\nlinux-image-extra-4.8.0-39-generic - 4.8.0-39.42~16.04.1\nNo subscription required\n\nlinux-image-4.4.0-1004-kvm - 4.4.0-1004.9\nNo subscription required\n\nlinux-image-4.4.0-1001-aws - 4.4.0-1001.10\nlinux-image-extra-4.4.0-1001-aws - 4.4.0-1001.10\nNo subscription required\n\nlinux-image-4.15.0-1030-aws - 4.15.0-1030.31~16.04.1\nNo subscription required\n\nlinux-image-4.11.0-1009-azure - 4.11.0-1009.9\nlinux-image-extra-4.11.0-1009-azure - 4.11.0-1009.9\nNo subscription required\n\nlinux-image-4.10.0-1004-gcp - 4.10.0-1004.4\nlinux-image-extra-4.10.0-1004-gcp - 4.10.0-1004.4\nNo subscription required\n\nlinux-image-unsigned-4.15.0-1007-oracle - 4.15.0-1007.9~16.04.1\nNo subscription required",
		"affected": {
			"family": "unix",
			"platform": "Ubuntu 16.04 LTS"
		},
		"reference": {
			"source": "CVE",
			"ref_id": "CVE-2024-50254",
			"ref_url": "https://www.cve.org/CVERecord?id=CVE-2024-50254"
		},
		"advisory": {
			"severity": "Medium",
			"rights": "Copyright (C) 2024 Canonical Ltd.",
			"public_date": "2024-11-09 11:15:00 UTC",
			"cve": {
				"text": "CVE-2024-50254",
				"href": "https://ubuntu.com/security/CVE-2024-50254",
				"public": "20241109",
				"cvss_score": "5.5",
				"cvss_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H"
			}
		}
	},
	"notes": {},
	"criteria": {
		"criterias": [
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201513390000000",
						"comment": "linux package in xenial, is related to the CVE in some way and has been fixed (note: '4.4.0-2.16')."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201589440000000",
						"comment": "linux-hwe package in xenial, is related to the CVE in some way and has been fixed (note: '4.8.0-39.42~16.04.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:200636350000110",
						"comment": "linux-kvm package in xenial, is related to the CVE in some way and has been fixed (note: '4.4.0-1004.9')."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:200636350000060",
						"comment": "linux-aws package in xenial, is related to the CVE in some way and has been fixed (note: '4.4.0-1001.10')."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:200747740000010",
						"comment": "linux-aws-hwe package in xenial, is related to the CVE in some way and has been fixed (note: '4.15.0-1030.31~16.04.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:200636350000090",
						"comment": "linux-azure package in xenial, is related to the CVE in some way and has been fixed (note: '4.11.0-1009.9')."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:200636350000100",
						"comment": "linux-gcp package in xenial, is related to the CVE in some way and has been fixed (note: '4.10.0-1004.4')."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:200767620000010",
						"comment": "linux-gke: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of standard support')."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:200747740000020",
						"comment": "linux-oracle package in xenial, is related to the CVE in some way and has been fixed (note: '4.15.0-1007.9~16.04.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:200767620000030",
						"comment": "linux-oem: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of standard support')."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:201245420000010",
						"comment": "linux-raspi2: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of standard support')."
					}
				]
			}
		]
	}
}
