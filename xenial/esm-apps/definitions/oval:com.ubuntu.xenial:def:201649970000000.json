{
  "class": "vulnerability",
  "id": "oval:com.ubuntu.xenial:def:201649970000000",
  "version": "1",
  "metadata": {
    "Title": "CVE-2016-4997 on Ubuntu 16.04 ESM (xenial) - high.",
    "Description": "The compat IPT_SO_SET_REPLACE and IP6T_SO_SET_REPLACE setsockopt implementations in the netfilter subsystem in the Linux kernel before 4.6.3 allow local users to gain privileges or cause a denial of service (memory corruption) by leveraging in-container root access to provide a crafted offset value that triggers an unintended decrement. Jesse Hertz and Tim Newsham discovered that the Linux netfilter implementation did not correctly perform validation when handling 32 bit compatibility IPT_SO_SET_REPLACE events on 64 bit platforms. A local unprivileged attacker could use this to cause a denial of service (system crash) or execute arbitrary code with administrative privileges.\n\nUpdate Instructions:\n\nRun `sudo pro fix CVE-2016-4997` to fix the vulnerability. The problem can be corrected\nby updating your system to the following package versions:\n\nlinux-image-4.4.0-28-generic - 4.4.0-28.47\nlinux-image-4.4.0-28-generic-lpae - 4.4.0-28.47\nlinux-image-4.4.0-28-lowlatency - 4.4.0-28.47\nlinux-image-4.4.0-28-powerpc-e500mc - 4.4.0-28.47\nlinux-image-4.4.0-28-powerpc-smp - 4.4.0-28.47\nlinux-image-4.4.0-28-powerpc64-emb - 4.4.0-28.47\nlinux-image-4.4.0-28-powerpc64-smp - 4.4.0-28.47\nlinux-image-extra-4.4.0-28-generic - 4.4.0-28.47\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro\n\nlinux-image-4.4.0-1001-aws - 4.4.0-1001.10\nlinux-image-extra-4.4.0-1001-aws - 4.4.0-1001.10\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro\n\nlinux-image-4.11.0-1009-azure - 4.11.0-1009.9\nlinux-image-extra-4.11.0-1009-azure - 4.11.0-1009.9\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro\n\nlinux-image-4.4.0-9019-euclid - 4.4.0-9019.20\nlinux-image-extra-4.4.0-9019-euclid - 4.4.0-9019.20\nNo subscription required\n\nlinux-image-4.10.0-1004-gcp - 4.10.0-1004.4\nlinux-image-extra-4.10.0-1004-gcp - 4.10.0-1004.4\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro\n\nlinux-image-4.4.0-1003-gke - 4.4.0-1003.3\nlinux-image-extra-4.4.0-1003-gke - 4.4.0-1003.3\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro\n\nlinux-image-4.8.0-36-generic - 4.8.0-36.36~16.04.1\nlinux-image-4.8.0-36-generic-lpae - 4.8.0-36.36~16.04.1\nlinux-image-4.8.0-36-lowlatency - 4.8.0-36.36~16.04.1\nlinux-image-extra-4.8.0-36-generic - 4.8.0-36.36~16.04.1\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro\n\nlinux-image-4.4.0-1004-kvm - 4.4.0-1004.9\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro\n\nlinux-image-4.13.0-1008-oem - 4.13.0-1008.9\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro\n\nlinux-image-4.4.0-1016-raspi2 - 4.4.0-1016.22\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro\n\nlinux-image-4.4.0-28-generic - 4.4.0-28.47\nlinux-image-4.4.0-28-generic-lpae - 4.4.0-28.47\nlinux-image-4.4.0-28-lowlatency - 4.4.0-28.47\nlinux-image-4.4.0-28-powerpc-e500mc - 4.4.0-28.47\nlinux-image-4.4.0-28-powerpc-smp - 4.4.0-28.47\nlinux-image-4.4.0-28-powerpc64-emb - 4.4.0-28.47\nlinux-image-4.4.0-28-powerpc64-smp - 4.4.0-28.47\nlinux-image-extra-4.4.0-28-generic - 4.4.0-28.47\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro\n\nlinux-image-4.11.0-1009-azure - 4.11.0-1009.9\nlinux-image-extra-4.11.0-1009-azure - 4.11.0-1009.9\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro\n\nlinux-image-4.10.0-1004-gcp - 4.10.0-1004.4\nlinux-image-extra-4.10.0-1004-gcp - 4.10.0-1004.4\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro\n\nlinux-image-4.8.0-36-generic - 4.8.0-36.36~16.04.1\nlinux-image-4.8.0-36-generic-lpae - 4.8.0-36.36~16.04.1\nlinux-image-4.8.0-36-lowlatency - 4.8.0-36.36~16.04.1\nlinux-image-extra-4.8.0-36-generic - 4.8.0-36.36~16.04.1\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro\n\nlinux-image-4.13.0-1008-oem - 4.13.0-1008.9\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro\n\nlinux-image-4.4.0-1019-snapdragon - 4.4.0-1019.22\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro",
    "affected": {
      "family": "unix",
      "Platform": "Ubuntu 16.04 ESM"
    },
    "reference": {
      "source": "CVE",
      "ref_id": "CVE-2016-4997",
      "ref_url": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-4997"
    },
    "advisory": {
      "Severity": "High",
      "Rights": "Copyright (C) 2016 Canonical Ltd.",
      "PublicDate": "2016-06-24",
      "Bug": null,
      "cve": {
        "text": "CVE-2016-4997",
        "href": "https://ubuntu.com/security/CVE-2016-4997",
        "public": "20160624",
        "cvss_score": "7.8",
        "cvss_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
        "usns": "3016-1,3016-2,3017-1,3017-3,3016-3,3016-4,3017-2,3020-1,3018-2,3018-1,3019-1,3338-1"
      },
      "PublicDateAtUsn": "2016-06-24",
      "AssignedTo": "",
      "DiscoveredBy": "Jesse Hertz and Tim Newsham",
      "Crd": "",
      "Ref": null
    }
  },
  "notes": {
    "Note": "jdstrand> android kernels (flo, goldfish, grouper, maguro, mako and manta) are not supported on the Ubuntu Touch 14.10 and earlier preview kernels linux-lts-saucy no longer receives official support linux-lts-quantal no longer receives official support sbeattie> priority is negligible on precise's 3.2 kernels, as user namespaces are a privileged operation there. For xenial and linux-lts-xenial on trusty, this can be mitigated against by setting the kernel.unprivileged_userns_clone sysctl to 0 to disable userns support. When we fix the netfilter issue we will also add this sysctl to all other supported kernels to allow disabling unprivileged user namespaces. Disabling user namespace may impact chromium-browser, lxc, lxd, docker, and other tools."
  },
  "criteria": {
    "criterias": [
      {
        "operator": "OR",
        "criterions": [
          {
            "test_ref": "oval:com.ubuntu.xenial:tst:201631340000000",
            "comment": "linux package in xenial was vulnerable but has been fixed (note: '4.4.0-28.47')."
          },
          {
            "test_ref": "oval:com.ubuntu.xenial:tst:2018126330000010",
            "comment": "linux-aws package in xenial, is related to the CVE in some way and has been fixed (note: '4.4.0-1001.10')."
          },
          {
            "test_ref": "oval:com.ubuntu.xenial:tst:2017109110000030",
            "comment": "linux-azure package in xenial, is related to the CVE in some way and has been fixed (note: '4.11.0-1009.9')."
          },
          {
            "test_ref": "oval:com.ubuntu.xenial:tst:2018126330000040",
            "comment": "linux-euclid package in xenial, is related to the CVE in some way and has been fixed (note: '4.4.0-9019.20')."
          },
          {
            "test_ref": "oval:com.ubuntu.xenial:tst:201245420000050",
            "comment": "linux-flo: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'abandoned')."
          },
          {
            "test_ref": "oval:com.ubuntu.xenial:tst:2018126330000060",
            "comment": "linux-gcp package in xenial, is related to the CVE in some way and has been fixed (note: '4.10.0-1004.4')."
          },
          {
            "test_ref": "oval:com.ubuntu.xenial:tst:200636350000060",
            "comment": "linux-gke package in xenial, is related to the CVE in some way and has been fixed (note: '4.4.0-1003.3')."
          },
          {
            "test_ref": "oval:com.ubuntu.xenial:tst:201245420000080",
            "comment": "linux-goldfish: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'abandoned')."
          },
          {
            "test_ref": "oval:com.ubuntu.xenial:tst:200636350000080",
            "comment": "linux-hwe package in xenial, is related to the CVE in some way and has been fixed (note: '4.8.0-36.36~16.04.1')."
          },
          {
            "test_ref": "oval:com.ubuntu.xenial:tst:2018126330000100",
            "comment": "linux-kvm package in xenial, is related to the CVE in some way and has been fixed (note: '4.4.0-1004.9')."
          },
          {
            "test_ref": "oval:com.ubuntu.xenial:tst:201245420000110",
            "comment": "linux-mako: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'abandoned')."
          },
          {
            "test_ref": "oval:com.ubuntu.xenial:tst:2017109110000120",
            "comment": "linux-oem package in xenial, is related to the CVE in some way and has been fixed (note: '4.13.0-1008.9')."
          },
          {
            "test_ref": "oval:com.ubuntu.xenial:tst:201631340000070",
            "comment": "linux-raspi2 package in xenial was vulnerable but has been fixed (note: '4.4.0-1016.22')."
          },
          {
            "test_ref": "oval:com.ubuntu.xenial:tst:201631340000080",
            "comment": "linux-signed package in xenial was vulnerable but has been fixed (note: '4.4.0-28.47')."
          },
          {
            "test_ref": "oval:com.ubuntu.xenial:tst:2017109110000170",
            "comment": "linux-signed-azure package in xenial, is related to the CVE in some way and has been fixed (note: '4.11.0-1009.9')."
          },
          {
            "test_ref": "oval:com.ubuntu.xenial:tst:2018126330000170",
            "comment": "linux-signed-gcp package in xenial, is related to the CVE in some way and has been fixed (note: '4.10.0-1004.4')."
          },
          {
            "test_ref": "oval:com.ubuntu.xenial:tst:200636350000160",
            "comment": "linux-signed-hwe package in xenial, is related to the CVE in some way and has been fixed (note: '4.8.0-36.36~16.04.1')."
          },
          {
            "test_ref": "oval:com.ubuntu.xenial:tst:2017109110000200",
            "comment": "linux-signed-oem package in xenial, is related to the CVE in some way and has been fixed (note: '4.13.0-1008.9')."
          },
          {
            "test_ref": "oval:com.ubuntu.xenial:tst:201631340000100",
            "comment": "linux-snapdragon package in xenial was vulnerable but has been fixed (note: '4.4.0-1019.22')."
          }
        ]
      }
    ]
  }
}
