{
	"class": "vulnerability",
	"id": "oval:com.ubuntu.xenial:def:201417370000000",
	"version": "1",
	"metadata": {
		"Title": "CVE-2014-1737 on Ubuntu 16.04 ESM (xenial) - high.",
		"Description": "The raw_cmd_copyin function in drivers/block/floppy.c in the Linux kernel through 3.14.3 does not properly handle error conditions during processing of an FDRAWCMD ioctl call, which allows local users to trigger kfree operations and gain privileges by leveraging write access to a /dev/fd device. First, raw_cmd_ioctl calls raw_cmd_copyin. This function kmallocs space for a floppy_raw_cmd structure and stores the resulting allocation in the \"rcmd\" pointer argument. It then attempts to copy_from_user the structure from userspace. If this fails, an early EFAULT return is taken. The problem is that even if the early return is taken, the pointer to the non-/partially-initialized floppy_raw_cmd structure has already been returned via the \"rcmd\" pointer. Back out in raw_cmd_ioctl, it attempts to raw_cmd_free this pointer. raw_cmd_free attempts to free any DMA pages allocated for the raw command, kfrees the raw command structure itself, and follows the linked list, if any, of further raw commands (a user can specify the FD_RAW_MORE flag to signal that there are more raw commands to follow in a single FDRAWCMD ioctl). So, a malicious user can send a FDRAWCMD ioctl with a raw command argument structure that has some bytes inaccessible (ie. off the end of an allocated page). The copy_from_user will fail but raw_cmd_free will attempt to process the floppy_raw_cmd as if it had been fully initialized by the rest of raw_cmd_copyin. The user can control the arguments passed to fd_dma_mem_free and kfree (by making use of the linked-list feature and specifying the target address as a next-in-list structure). Matthew Daley reported a flaw in the handling of ioctl commands by the floppy disk driver in the Linux kernel. An unprivileged local user could exploit this flaw to gain administrative privileges if the floppy disk module is loaded.\n\nUpdate Instructions:\n\nRun `sudo pro fix CVE-2014-1737` to fix the vulnerability. The problem can be corrected\nby updating your system to the following package versions:\n\nlinux-image-4.2.0-16-generic - 4.2.0-16.19\nlinux-image-4.2.0-16-generic-lpae - 4.2.0-16.19\nlinux-image-4.2.0-16-lowlatency - 4.2.0-16.19\nlinux-image-4.2.0-16-powerpc-e500mc - 4.2.0-16.19\nlinux-image-4.2.0-16-powerpc-smp - 4.2.0-16.19\nlinux-image-4.2.0-16-powerpc64-emb - 4.2.0-16.19\nlinux-image-4.2.0-16-powerpc64-smp - 4.2.0-16.19\nlinux-image-extra-4.2.0-16-generic - 4.2.0-16.19\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro\n\nlinux-image-4.4.0-1001-aws - 4.4.0-1001.10\nlinux-image-extra-4.4.0-1001-aws - 4.4.0-1001.10\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro\n\nlinux-image-3.4.0-5-flo - 3.4.0-5.22\nNo subscription required\n\nlinux-image-4.4.0-1003-gke - 4.4.0-1003.3\nlinux-image-extra-4.4.0-1003-gke - 4.4.0-1003.3\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro\n\nlinux-image-3.4.0-4-goldfish - 3.4.0-4.27\nNo subscription required\n\nlinux-image-4.8.0-36-generic - 4.8.0-36.36~16.04.1\nlinux-image-4.8.0-36-generic-lpae - 4.8.0-36.36~16.04.1\nlinux-image-4.8.0-36-lowlatency - 4.8.0-36.36~16.04.1\nlinux-image-extra-4.8.0-36-generic - 4.8.0-36.36~16.04.1\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro\n\nlinux-image-3.4.0-7-mako - 3.4.0-7.40\nNo subscription required\n\nlinux-image-4.2.0-1013-raspi2 - 4.2.0-1013.19\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro\n\nlinux-image-4.2.0-16-generic - 4.2.0-16.19\nlinux-image-4.2.0-16-generic-lpae - 4.2.0-16.19\nlinux-image-4.2.0-16-lowlatency - 4.2.0-16.19\nlinux-image-4.2.0-16-powerpc-e500mc - 4.2.0-16.19\nlinux-image-4.2.0-16-powerpc-smp - 4.2.0-16.19\nlinux-image-4.2.0-16-powerpc64-emb - 4.2.0-16.19\nlinux-image-4.2.0-16-powerpc64-smp - 4.2.0-16.19\nlinux-image-extra-4.2.0-16-generic - 4.2.0-16.19\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro\n\nlinux-image-4.8.0-36-generic - 4.8.0-36.36~16.04.1\nlinux-image-4.8.0-36-generic-lpae - 4.8.0-36.36~16.04.1\nlinux-image-4.8.0-36-lowlatency - 4.8.0-36.36~16.04.1\nlinux-image-extra-4.8.0-36-generic - 4.8.0-36.36~16.04.1\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro\n\nlinux-image-4.4.0-1012-snapdragon - 4.4.0-1012.12\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro",
		"affected": {
			"family": "unix",
			"Platform": "Ubuntu 16.04 ESM"
		},
		"reference": {
			"source": "CVE",
			"ref_id": "CVE-2014-1737",
			"ref_url": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-1737"
		},
		"advisory": {
			"Severity": "High",
			"Rights": "Copyright (C) 2014 Canonical Ltd.",
			"PublicDate": "2014-05-11",
			"Bug": [
				"https://launchpad.net/bugs/1316729"
			],
			"cve": {
				"text": "CVE-2014-1737",
				"href": "https://ubuntu.com/security/CVE-2014-1737",
				"public": "20140511",
				"usns": "2219-1,2220-1,2221-1,2223-1,2224-1,2225-1,2226-1,2227-1,2228-1,2260-1"
			},
			"PublicDateAtUsn": "2014-05-11",
			"AssignedTo": "",
			"DiscoveredBy": "",
			"Crd": "",
			"Ref": null
		}
	},
	"notes": {
		"Note": "jdstrand> android kernels (goldfish, grouper, maguro, mako and manta) are not supported on the Ubuntu Touch 13.10 preview kernels android kernels (flo, goldfish, grouper, maguro, mako and manta) are not supported on the Ubuntu Touch 14.04 preview kernels"
	},
	"criteria": {
		"criterias": [
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:200636350000000",
						"comment": "linux package in xenial, is related to the CVE in some way and has been fixed (note: '4.2.0-16.19')."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:2018126330000010",
						"comment": "linux-aws package in xenial, is related to the CVE in some way and has been fixed (note: '4.4.0-1001.10')."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:200737320000010",
						"comment": "linux-flo package in xenial, is related to the CVE in some way and has been fixed (note: '3.4.0-5.22')."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:200636350000060",
						"comment": "linux-gke package in xenial, is related to the CVE in some way and has been fixed (note: '4.4.0-1003.3')."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:200636350000070",
						"comment": "linux-goldfish package in xenial, is related to the CVE in some way and has been fixed (note: '3.4.0-4.27')."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:200636350000080",
						"comment": "linux-hwe package in xenial, is related to the CVE in some way and has been fixed (note: '4.8.0-36.36~16.04.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:200737320000030",
						"comment": "linux-mako package in xenial, is related to the CVE in some way and has been fixed (note: '3.4.0-7.40')."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:2018126330000130",
						"comment": "linux-raspi2 package in xenial, is related to the CVE in some way and has been fixed (note: '4.2.0-1013.19')."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:200636350000130",
						"comment": "linux-signed package in xenial, is related to the CVE in some way and has been fixed (note: '4.2.0-16.19')."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:200636350000160",
						"comment": "linux-signed-hwe package in xenial, is related to the CVE in some way and has been fixed (note: '4.8.0-36.36~16.04.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.xenial:tst:200636350000180",
						"comment": "linux-snapdragon package in xenial, is related to the CVE in some way and has been fixed (note: '4.4.0-1012.12')."
					}
				]
			}
		]
	}
}
