{
	"class": "vulnerability",
	"id": "oval:com.ubuntu.mantic:def:2024369630000000",
	"version": "1",
	"metadata": {
		"title": "CVE-2024-36963 on Ubuntu 23.10 (mantic) - medium",
		"description": "In the Linux kernel, the following vulnerability has been resolved:tracefs: Reset permissions on remount if permissions are optionsThere's an inconsistency with the way permissions are handled in tracefs.Because the permissions are generated when accessed, they default to theroot inode's permission if they were never set by the user. If the usersets the permissions, then a flag is set and the permissions are saved viathe inode (for tracefs files) or an internal attribute field (foreventfs).But if a remount happens that specify the permissions, all the files thatwere not changed by the user gets updated, but the ones that were are not.If the user were to remount the file system with a given permission, thenall files and directories within that file system should be updated.This can cause security issues if a file's permission was updated but theadmin forgot about it. They could incorrectly think that remounting withpermissions set would update all files, but miss some.For example: # cd /sys/kernel/tracing # chgrp 1002 current_tracer # ls -l[..] -rw-r-----  1 root root 0 May  1 21:25 buffer_size_kb -rw-r-----  1 root root 0 May  1 21:25 buffer_subbuf_size_kb -r--r-----  1 root root 0 May  1 21:25 buffer_total_size_kb -rw-r-----  1 root lkp  0 May  1 21:25 current_tracer -rw-r-----  1 root root 0 May  1 21:25 dynamic_events -r--r-----  1 root root 0 May  1 21:25 dyn_ftrace_total_info -r--r-----  1 root root 0 May  1 21:25 enabled_functionsWhere current_tracer now has group \"lkp\". # mount -o remount,gid=1001 . # ls -l -rw-r-----  1 root tracing 0 May  1 21:25 buffer_size_kb -rw-r-----  1 root tracing 0 May  1 21:25 buffer_subbuf_size_kb -r--r-----  1 root tracing 0 May  1 21:25 buffer_total_size_kb -rw-r-----  1 root lkp     0 May  1 21:25 current_tracer -rw-r-----  1 root tracing 0 May  1 21:25 dynamic_events -r--r-----  1 root tracing 0 May  1 21:25 dyn_ftrace_total_info -r--r-----  1 root tracing 0 May  1 21:25 enabled_functionsEverything changed but the \"current_tracer\".Add a new link list that keeps track of all the tracefs_inodes which hasthe permission flags that tell if the file/dir should use the root inode'spermission or not. Then on remount, clear all the flags so that thedefault behavior of using the root inode's permission is done for allfiles and directories.",
		"affected": {
			"family": "unix",
			"platform": "Ubuntu 23.10"
		},
		"reference": {
			"source": "CVE",
			"ref_id": "CVE-2024-36963",
			"ref_url": "https://www.cve.org/CVERecord?id=CVE-2024-36963"
		},
		"advisory": {
			"severity": "Medium",
			"rights": "Copyright (C) 2024 Canonical Ltd.",
			"public_date": "2024-06-03 08:15:00 UTC",
			"cve": {
				"text": "CVE-2024-36963",
				"href": "https://ubuntu.com/security/CVE-2024-36963",
				"public": "20240603"
			}
		}
	},
	"notes": {},
	"criteria": {
		"criterias": [
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:com.ubuntu.mantic:tst:201245420000000",
						"comment": "linux package in mantic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.mantic:tst:201245420000010",
						"comment": "linux-aws package in mantic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.mantic:tst:201245420000020",
						"comment": "linux-azure package in mantic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.mantic:tst:201245420000030",
						"comment": "linux-gcp package in mantic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.mantic:tst:201245420000060",
						"comment": "linux-ibm: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of kernel support')."
					},
					{
						"test_ref": "oval:com.ubuntu.mantic:tst:201245420000090",
						"comment": "linux-laptop package in mantic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.mantic:tst:201245420000070",
						"comment": "linux-lowlatency package in mantic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.mantic:tst:201245420000040",
						"comment": "linux-oracle package in mantic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.mantic:tst:201245420000050",
						"comment": "linux-raspi package in mantic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.mantic:tst:201245420000080",
						"comment": "linux-starfive package in mantic is affected and may need fixing."
					}
				]
			}
		]
	}
}
