{
	"class": "vulnerability",
	"id": "oval:com.ubuntu.mantic:def:202340390000000",
	"version": "1",
	"metadata": {
		"Title": "CVE-2023-4039 on Ubuntu 23.10 (mantic) - medium.",
		"Description": "A failure in the -fstack-protector feature in GCC-based toolchains that target AArch64 allows an attacker to exploit an existing buffer overflow in dynamically-sized local variables in your application without this being detected. This stack-protector failure only applies to C99-style dynamically-sized local variables or those created using alloca(). The stack-protector operates as intended for statically-sized local variables. The default behavior when the stack-protector detects an overflow is to terminate your application, resulting in controlled loss of availability. An attacker who can exploit a buffer overflow without triggering the stack-protector might be able to change program flow control to cause an uncontrolled loss of availability or to go further and affect confidentiality or integrity.\n\nUpdate Instructions:\n\nRun `sudo pro fix CVE-2023-4039` to fix the vulnerability. The problem can be corrected\nby updating your system to the following package versions:\n\ncpp-11 - 11.4.0-4ubuntu1\ng++-11 - 11.4.0-4ubuntu1\ng++-11-multilib - 11.4.0-4ubuntu1\ngcc-11 - 11.4.0-4ubuntu1\ngcc-11-base - 11.4.0-4ubuntu1\ngcc-11-hppa64-linux-gnu - 11.4.0-4ubuntu1\ngcc-11-locales - 11.4.0-4ubuntu1\ngcc-11-multilib - 11.4.0-4ubuntu1\ngcc-11-offload-amdgcn - 11.4.0-4ubuntu1\ngcc-11-offload-nvptx - 11.4.0-4ubuntu1\ngcc-11-source - 11.4.0-4ubuntu1\ngcc-11-test-results - 11.4.0-4ubuntu1\ngccbrig-11 - 11.4.0-4ubuntu1\ngccgo-11 - 11.4.0-4ubuntu1\ngccgo-11-multilib - 11.4.0-4ubuntu1\ngdc-11 - 11.4.0-4ubuntu1\ngdc-11-multilib - 11.4.0-4ubuntu1\ngfortran-11 - 11.4.0-4ubuntu1\ngfortran-11-multilib - 11.4.0-4ubuntu1\ngm2-11 - 11.4.0-4ubuntu1\ngnat-11 - 11.4.0-4ubuntu1\ngobjc++-11 - 11.4.0-4ubuntu1\ngobjc++-11-multilib - 11.4.0-4ubuntu1\ngobjc-11 - 11.4.0-4ubuntu1\ngobjc-11-multilib - 11.4.0-4ubuntu1\nlib32asan6 - 11.4.0-4ubuntu1\nlib32go19 - 11.4.0-4ubuntu1\nlib32gphobos2 - 11.4.0-4ubuntu1\nlib64asan6 - 11.4.0-4ubuntu1\nlib64go19 - 11.4.0-4ubuntu1\nlib64gphobos2 - 11.4.0-4ubuntu1\nlibasan6 - 11.4.0-4ubuntu1\nlibgnat-11 - 11.4.0-4ubuntu1\nlibgo19 - 11.4.0-4ubuntu1\nlibgphobos2 - 11.4.0-4ubuntu1\nlibhsail-rt0 - 11.4.0-4ubuntu1\nlibstdc++-11-pic - 11.4.0-4ubuntu1\nlibtsan0 - 11.4.0-4ubuntu1\nlibx32asan6 - 11.4.0-4ubuntu1\nlibx32go19 - 11.4.0-4ubuntu1\nlibx32gphobos2 - 11.4.0-4ubuntu1\nNo subscription required\n\ncpp-12 - 12.3.0-9ubuntu1\ng++-12 - 12.3.0-9ubuntu1\ng++-12-multilib - 12.3.0-9ubuntu1\ngcc-12 - 12.3.0-9ubuntu1\ngcc-12-base - 12.3.0-9ubuntu1\ngcc-12-hppa64-linux-gnu - 12.3.0-9ubuntu1\ngcc-12-locales - 12.3.0-9ubuntu1\ngcc-12-multilib - 12.3.0-9ubuntu1\ngcc-12-offload-amdgcn - 12.3.0-9ubuntu1\ngcc-12-offload-nvptx - 12.3.0-9ubuntu1\ngcc-12-source - 12.3.0-9ubuntu1\ngcc-12-test-results - 12.3.0-9ubuntu1\ngccgo-12 - 12.3.0-9ubuntu1\ngccgo-12-multilib - 12.3.0-9ubuntu1\ngdc-12 - 12.3.0-9ubuntu1\ngdc-12-multilib - 12.3.0-9ubuntu1\ngfortran-12 - 12.3.0-9ubuntu1\ngfortran-12-multilib - 12.3.0-9ubuntu1\ngm2-12 - 12.3.0-9ubuntu1\ngnat-12 - 12.3.0-9ubuntu1\ngobjc++-12 - 12.3.0-9ubuntu1\ngobjc++-12-multilib - 12.3.0-9ubuntu1\ngobjc-12 - 12.3.0-9ubuntu1\ngobjc-12-multilib - 12.3.0-9ubuntu1\nlib32go21 - 12.3.0-9ubuntu1\nlib32gphobos3 - 12.3.0-9ubuntu1\nlib64go21 - 12.3.0-9ubuntu1\nlib64gphobos3 - 12.3.0-9ubuntu1\nlibgm2-17 - 12.3.0-9ubuntu1\nlibgnat-12 - 12.3.0-9ubuntu1\nlibgo21 - 12.3.0-9ubuntu1\nlibgphobos3 - 12.3.0-9ubuntu1\nlibstdc++-12-pic - 12.3.0-9ubuntu1\nlibx32go21 - 12.3.0-9ubuntu1\nlibx32gphobos3 - 12.3.0-9ubuntu1\nNo subscription required\n\ncpp-13 - 13.2.0-4ubuntu1\ng++-13 - 13.2.0-4ubuntu1\ng++-13-multilib - 13.2.0-4ubuntu1\ngcc-13 - 13.2.0-4ubuntu1\ngcc-13-base - 13.2.0-4ubuntu1\ngcc-13-hppa64-linux-gnu - 13.2.0-4ubuntu1\ngcc-13-locales - 13.2.0-4ubuntu1\ngcc-13-multilib - 13.2.0-4ubuntu1\ngcc-13-offload-amdgcn - 13.2.0-4ubuntu1\ngcc-13-offload-nvptx - 13.2.0-4ubuntu1\ngcc-13-source - 13.2.0-4ubuntu1\ngcc-13-test-results - 13.2.0-4ubuntu1\ngccgo-13 - 13.2.0-4ubuntu1\ngccgo-13-multilib - 13.2.0-4ubuntu1\ngdc-13 - 13.2.0-4ubuntu1\ngdc-13-multilib - 13.2.0-4ubuntu1\ngfortran-13 - 13.2.0-4ubuntu1\ngfortran-13-multilib - 13.2.0-4ubuntu1\ngm2-13 - 13.2.0-4ubuntu1\ngnat-13 - 13.2.0-4ubuntu1\ngobjc++-13 - 13.2.0-4ubuntu1\ngobjc++-13-multilib - 13.2.0-4ubuntu1\ngobjc-13 - 13.2.0-4ubuntu1\ngobjc-13-multilib - 13.2.0-4ubuntu1\nlib32asan8 - 13.2.0-4ubuntu1\nlib32atomic1 - 13.2.0-4ubuntu1\nlib32gcc-s1 - 13.2.0-4ubuntu1\nlib32gfortran5 - 13.2.0-4ubuntu1\nlib32go22 - 13.2.0-4ubuntu1\nlib32gomp1 - 13.2.0-4ubuntu1\nlib32gphobos4 - 13.2.0-4ubuntu1\nlib32itm1 - 13.2.0-4ubuntu1\nlib32objc4 - 13.2.0-4ubuntu1\nlib32quadmath0 - 13.2.0-4ubuntu1\nlib32stdc++6 - 13.2.0-4ubuntu1\nlib32ubsan1 - 13.2.0-4ubuntu1\nlib64asan8 - 13.2.0-4ubuntu1\nlib64atomic1 - 13.2.0-4ubuntu1\nlib64gcc-s1 - 13.2.0-4ubuntu1\nlib64gfortran5 - 13.2.0-4ubuntu1\nlib64go22 - 13.2.0-4ubuntu1\nlib64gomp1 - 13.2.0-4ubuntu1\nlib64gphobos4 - 13.2.0-4ubuntu1\nlib64itm1 - 13.2.0-4ubuntu1\nlib64objc4 - 13.2.0-4ubuntu1\nlib64quadmath0 - 13.2.0-4ubuntu1\nlib64stdc++6 - 13.2.0-4ubuntu1\nlib64ubsan1 - 13.2.0-4ubuntu1\nlibasan8 - 13.2.0-4ubuntu1\nlibatomic1 - 13.2.0-4ubuntu1\nlibcc1-0 - 13.2.0-4ubuntu1\nlibgcc-s1 - 13.2.0-4ubuntu1\nlibgccjit0 - 13.2.0-4ubuntu1\nlibgfortran5 - 13.2.0-4ubuntu1\nlibgm2-18 - 13.2.0-4ubuntu1\nlibgnat-13 - 13.2.0-4ubuntu1\nlibgo22 - 13.2.0-4ubuntu1\nlibgomp-plugin-amdgcn1 - 13.2.0-4ubuntu1\nlibgomp-plugin-nvptx1 - 13.2.0-4ubuntu1\nlibgomp1 - 13.2.0-4ubuntu1\nlibgphobos4 - 13.2.0-4ubuntu1\nlibhwasan0 - 13.2.0-4ubuntu1\nlibitm1 - 13.2.0-4ubuntu1\nliblsan0 - 13.2.0-4ubuntu1\nlibobjc4 - 13.2.0-4ubuntu1\nlibquadmath0 - 13.2.0-4ubuntu1\nlibstdc++-13-pic - 13.2.0-4ubuntu1\nlibstdc++6 - 13.2.0-4ubuntu1\nlibtsan2 - 13.2.0-4ubuntu1\nlibubsan1 - 13.2.0-4ubuntu1\nlibx32asan8 - 13.2.0-4ubuntu1\nlibx32atomic1 - 13.2.0-4ubuntu1\nlibx32gcc-s1 - 13.2.0-4ubuntu1\nlibx32gfortran5 - 13.2.0-4ubuntu1\nlibx32go22 - 13.2.0-4ubuntu1\nlibx32gomp1 - 13.2.0-4ubuntu1\nlibx32gphobos4 - 13.2.0-4ubuntu1\nlibx32itm1 - 13.2.0-4ubuntu1\nlibx32objc4 - 13.2.0-4ubuntu1\nlibx32quadmath0 - 13.2.0-4ubuntu1\nlibx32stdc++6 - 13.2.0-4ubuntu1\nlibx32ubsan1 - 13.2.0-4ubuntu1\nNo subscription required",
		"affected": {
			"family": "unix",
			"Platform": "Ubuntu 23.10"
		},
		"reference": {
			"source": "CVE",
			"ref_id": "CVE-2023-4039",
			"ref_url": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-4039"
		},
		"advisory": {
			"Severity": "Medium",
			"Rights": "Copyright (C) 2023 Canonical Ltd.",
			"PublicDate": "2023-09-12 15:00:00 UTC",
			"Bug": null,
			"cve": {
				"text": "CVE-2023-4039",
				"href": "https://ubuntu.com/security/CVE-2023-4039",
				"public": "20230912",
				"cvss_score": "4.8",
				"cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:N"
			},
			"PublicDateAtUsn": "",
			"AssignedTo": "",
			"DiscoveredBy": "",
			"Crd": "2023-09-12 15:00:00 UTC",
			"Ref": null
		}
	},
	"notes": {
		"Note": "sbeattie> gcc-3.3 only provides libstdc++5 alexmurray> patches are expected to be provided for upstream versions 11, 12, 13 and trunk Any possible package on arm64 in Ubuntu could be affected by this and would therefore need to be recompiled by a new version of gcc containing this fix - however, performing a whole-of-archive rebuild is not feasible. It might be possible to detect which packages need to be rebuilt by looking for those with the -fstack-clash-protection mitigation via hardening-check (as since Ubuntu 20.04 LTS nearly all packages are compiled with this by default). This is still likely to be quite a large subset of the archive and still not feasible to rebuild. Instead as regular security / SRU updates are performed for packages, they will opportunistically receive this fix. sbeattie> 14.04 LTS (trusty) Pro Infra and 16.04 LTS (xenial) Pro Infra do not support Arm64 as an architecture."
	},
	"criteria": {
		"criterias": [
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:com.ubuntu.mantic:tst:202340390000000",
						"comment": "gcc-10 package in mantic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.mantic:tst:202340390000010",
						"comment": "gcc-10-cross package in mantic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.mantic:tst:202340390000020",
						"comment": "gcc-10-cross-mipsen package in mantic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.mantic:tst:202340390000030",
						"comment": "gcc-10-cross-ports package in mantic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.mantic:tst:202340390000040",
						"comment": "gcc-11 package in mantic is affected. An update containing the fix has been completed and is pending publication (note: '11.4.0-4ubuntu1')."
					},
					{
						"test_ref": "oval:com.ubuntu.mantic:tst:202340390000050",
						"comment": "gcc-11-cross package in mantic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.mantic:tst:202340390000060",
						"comment": "gcc-11-cross-mipsen package in mantic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.mantic:tst:202340390000070",
						"comment": "gcc-11-cross-ports package in mantic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.mantic:tst:202340390000080",
						"comment": "gcc-12 package in mantic is affected. An update containing the fix has been completed and is pending publication (note: '12.3.0-9ubuntu1')."
					},
					{
						"test_ref": "oval:com.ubuntu.mantic:tst:202340390000090",
						"comment": "gcc-12-cross package in mantic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.mantic:tst:202340390000100",
						"comment": "gcc-12-cross-mipsen package in mantic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.mantic:tst:202340390000110",
						"comment": "gcc-12-cross-ports package in mantic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.mantic:tst:202340390000120",
						"comment": "gcc-13 package in mantic is affected. An update containing the fix has been completed and is pending publication (note: '13.2.0-4ubuntu1')."
					},
					{
						"test_ref": "oval:com.ubuntu.mantic:tst:202340390000130",
						"comment": "gcc-13-cross package in mantic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.mantic:tst:202340390000140",
						"comment": "gcc-13-cross-ports package in mantic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.mantic:tst:202340390000150",
						"comment": "gcc-9 package in mantic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.mantic:tst:2019158470000020",
						"comment": "gcc-9-cross package in mantic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.mantic:tst:202340390000170",
						"comment": "gcc-9-cross-mipsen package in mantic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.mantic:tst:2019158470000030",
						"comment": "gcc-9-cross-ports package in mantic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.mantic:tst:200224390000000",
						"comment": "gcc-arm-none-eabi package in mantic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.mantic:tst:2017116710000020",
						"comment": "gcc-avr package in mantic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.mantic:tst:2019158470000040",
						"comment": "gcc-defaults package in mantic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.mantic:tst:200224390000010",
						"comment": "gcc-h8300-hms package in mantic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.mantic:tst:200224390000020",
						"comment": "gcc-mingw-w64 package in mantic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.mantic:tst:200224390000030",
						"comment": "gcc-msp430 package in mantic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.mantic:tst:2020138440000110",
						"comment": "gcc-opt package in mantic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.mantic:tst:202340390000260",
						"comment": "gcc-or1k-elf package in mantic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.mantic:tst:202340390000270",
						"comment": "gcc-riscv64-unknown-elf package in mantic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.mantic:tst:2018128860000020",
						"comment": "gcc-snapshot package in mantic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.mantic:tst:202340390000290",
						"comment": "gcc-xtensa-lx106 package in mantic is affected and may need fixing."
					}
				]
			}
		]
	}
}
