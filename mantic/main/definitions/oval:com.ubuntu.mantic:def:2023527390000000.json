{
	"class": "vulnerability",
	"id": "oval:com.ubuntu.mantic:def:2023527390000000",
	"version": "1",
	"metadata": {
		"title": "CVE-2023-52739 on Ubuntu 23.10 (mantic) - medium",
		"description": "In the Linux kernel, the following vulnerability has been resolved:Fix page corruption caused by racy check in __free_pagesWhen we upgraded our kernel, we started seeing some page corruption likethe following consistently:  BUG: Bad page state in process ganesha.nfsd  pfn:1304ca  page:0000000022261c55 refcount:0 mapcount:-128 mapping:0000000000000000index:0x0 pfn:0x1304ca  flags: 0x17ffffc0000000()  raw: 0017ffffc0000000 ffff8a513ffd4c98 ffffeee24b35ec08 0000000000000000  raw: 0000000000000000 0000000000000001 00000000ffffff7f 0000000000000000  page dumped because: nonzero mapcount  CPU: 0 PID: 15567 Comm: ganesha.nfsd Kdump: loaded Tainted: P    B      O     5.10.158-1.nutanix.20221209.el7.x86_64 #1  Hardware name: VMware, Inc. VMware Virtual Platform/440BX DesktopReference Platform, BIOS 6.00 04/05/2016  Call Trace:   dump_stack+0x74/0x96   bad_page.cold+0x63/0x94   check_new_page_bad+0x6d/0x80   rmqueue+0x46e/0x970   get_page_from_freelist+0xcb/0x3f0   ? _cond_resched+0x19/0x40   __alloc_pages_nodemask+0x164/0x300   alloc_pages_current+0x87/0xf0   skb_page_frag_refill+0x84/0x110   ...Sometimes, it would also show up as corruption in the free list pointerand cause crashes.After bisecting the issue, we found the issue started from commite320d3012d25 (\"mm/page_alloc.c: fix freeing non-compound pages\"):\tif (put_page_testzero(page))\t\tfree_the_page(page, order);\telse if (!PageHead(page))\t\twhile (order-- > 0)\t\t\tfree_the_page(page + (1 << order), order);So the problem is the check PageHead is racy because at this point wealready dropped our reference to the page.  So even if we came in withcompound page, the page can already be freed and PageHead can returnfalse and we will end up freeing all the tail pages causing double free.",
		"affected": {
			"family": "unix",
			"platform": "Ubuntu 23.10"
		},
		"reference": {
			"source": "CVE",
			"ref_id": "CVE-2023-52739",
			"ref_url": "https://www.cve.org/CVERecord?id=CVE-2023-52739"
		},
		"advisory": {
			"severity": "Medium",
			"rights": "Copyright (C) 2024 Canonical Ltd.",
			"public_date": "2024-05-21 16:15:00 UTC",
			"cve": {
				"text": "CVE-2023-52739",
				"href": "https://ubuntu.com/security/CVE-2023-52739",
				"public": "20240521"
			}
		}
	},
	"notes": {},
	"criteria": {
		"criterias": [
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:com.ubuntu.mantic:tst:201245420000000",
						"comment": "linux package in mantic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.mantic:tst:201245420000010",
						"comment": "linux-aws package in mantic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.mantic:tst:201245420000020",
						"comment": "linux-azure package in mantic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.mantic:tst:201245420000030",
						"comment": "linux-gcp package in mantic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.mantic:tst:201245420000060",
						"comment": "linux-ibm: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of kernel support')."
					},
					{
						"test_ref": "oval:com.ubuntu.mantic:tst:201245420000090",
						"comment": "linux-laptop package in mantic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.mantic:tst:201245420000070",
						"comment": "linux-lowlatency package in mantic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.mantic:tst:201245420000040",
						"comment": "linux-oracle package in mantic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.mantic:tst:201245420000050",
						"comment": "linux-raspi package in mantic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.mantic:tst:201245420000080",
						"comment": "linux-starfive package in mantic is affected and may need fixing."
					}
				]
			}
		]
	}
}
