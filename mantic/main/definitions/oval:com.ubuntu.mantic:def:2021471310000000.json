{
	"class": "vulnerability",
	"id": "oval:com.ubuntu.mantic:def:2021471310000000",
	"version": "1",
	"metadata": {
		"title": "CVE-2021-47131 on Ubuntu 23.10 (mantic) - medium",
		"description": "In the Linux kernel, the following vulnerability has been resolved:net/tls: Fix use-after-free after the TLS device goes down and up When anetdev with active TLS offload goes down, tls_device_down is called to stopthe offload and tear down the TLS context. However, the socket stays alive,and it still points to the TLS context, which is now deallocated. If anetdev goes up, while the connection is still active, and the data flowresumes after a number of TCP retransmissions, it will lead to ause-after-free of the TLS context. This commit addresses this bug bykeeping the context alive until its normal destruction, and implements thenecessary fallbacks, so that the connection can resume in software(non-offloaded) kTLS mode. On the TX side tls_sw_fallback is used toencrypt all packets. The RX side already has all the necessary fallbacks,because receiving non-decrypted packets is supported. The thing needed onthe RX side is to block resync requests, which are normally produced afterreceiving non-decrypted packets. The necessary synchronization isimplemented for a graceful teardown: first the fallbacks are deployed, thenthe driver resources are released (it used to be possible to have atls_dev_resync after tls_dev_del). A new flag called TLS_RX_DEV_DEGRADED isadded to indicate the fallback mode. It's used to skip the RX resync logiccompletely, as it becomes useless, and some objects may be released (forexample, resync_async, which is allocated and freed by the driver).",
		"affected": {
			"family": "unix",
			"platform": "Ubuntu 23.10"
		},
		"reference": {
			"source": "CVE",
			"ref_id": "CVE-2021-47131",
			"ref_url": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-47131"
		},
		"advisory": {
			"severity": "Medium",
			"rights": "Copyright (C) 2024 Canonical Ltd.",
			"public_date": "2024-03-15 21:15:00 UTC",
			"cve": {
				"text": "CVE-2021-47131",
				"href": "https://ubuntu.com/security/CVE-2021-47131",
				"public": "20240315"
			}
		}
	},
	"notes": {},
	"criteria": {
		"criterias": [
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:com.ubuntu.mantic:tst:201245420000000",
						"comment": "linux package in mantic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.mantic:tst:201245420000010",
						"comment": "linux-aws package in mantic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.mantic:tst:201245420000020",
						"comment": "linux-azure package in mantic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.mantic:tst:201245420000030",
						"comment": "linux-gcp package in mantic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.mantic:tst:201245420000060",
						"comment": "linux-ibm: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of kernel support')."
					},
					{
						"test_ref": "oval:com.ubuntu.mantic:tst:201245420000090",
						"comment": "linux-laptop package in mantic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.mantic:tst:201245420000070",
						"comment": "linux-lowlatency package in mantic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.mantic:tst:201245420000040",
						"comment": "linux-oracle package in mantic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.mantic:tst:201245420000050",
						"comment": "linux-raspi package in mantic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.mantic:tst:201245420000080",
						"comment": "linux-starfive package in mantic is affected and may need fixing."
					}
				]
			}
		]
	}
}
