{
	"class": "vulnerability",
	"id": "oval:com.ubuntu.mantic:def:2022486900000000",
	"version": "1",
	"metadata": {
		"title": "CVE-2022-48690 on Ubuntu 23.10 (mantic) - medium",
		"description": "In the Linux kernel, the following vulnerability has been resolved:ice: Fix DMA mappings leakFix leak, when user changes ring parameters.During reallocation of RX buffers, new DMA mappings are created forthose buffers. New buffers with different RX ring count shouldsubstitute older ones, but those buffers were freed in ice_vsi_cfg_rxqand reallocated again with ice_alloc_rx_buf. kfree on rx_buf causedleak of already mapped DMA.Reallocate ZC with xdp_buf struct, when BPF program loads. Reallocateback to rx_buf, when BPF program unloads.If BPF program is loaded/unloaded and XSK pools are created, reallocateRX queues accordingly in XDP_SETUP_XSK_POOL handler.Steps for reproduction:while :do\tfor ((i=0; i<=8160; i=i+32))\tdo\t\tethtool -G enp130s0f0 rx $i tx $i\t\tsleep 0.5\t\tethtool -g enp130s0f0\tdonedone",
		"affected": {
			"family": "unix",
			"platform": "Ubuntu 23.10"
		},
		"reference": {
			"source": "CVE",
			"ref_id": "CVE-2022-48690",
			"ref_url": "https://www.cve.org/CVERecord?id=CVE-2022-48690"
		},
		"advisory": {
			"severity": "Medium",
			"rights": "Copyright (C) 2024 Canonical Ltd.",
			"public_date": "2024-05-03 18:15:00 UTC",
			"cve": {
				"text": "CVE-2022-48690",
				"href": "https://ubuntu.com/security/CVE-2022-48690",
				"public": "20240503"
			}
		}
	},
	"notes": {},
	"criteria": {
		"criterias": [
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:com.ubuntu.mantic:tst:201245420000000",
						"comment": "linux package in mantic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.mantic:tst:201245420000010",
						"comment": "linux-aws package in mantic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.mantic:tst:201245420000020",
						"comment": "linux-azure package in mantic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.mantic:tst:201245420000030",
						"comment": "linux-gcp package in mantic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.mantic:tst:201245420000060",
						"comment": "linux-ibm: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of kernel support')."
					},
					{
						"test_ref": "oval:com.ubuntu.mantic:tst:201245420000090",
						"comment": "linux-laptop package in mantic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.mantic:tst:201245420000070",
						"comment": "linux-lowlatency package in mantic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.mantic:tst:201245420000040",
						"comment": "linux-oracle package in mantic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.mantic:tst:201245420000050",
						"comment": "linux-raspi package in mantic is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.mantic:tst:201245420000080",
						"comment": "linux-starfive package in mantic is affected and may need fixing."
					}
				]
			}
		]
	}
}
