{
	"class": "vulnerability",
	"id": "oval:com.ubuntu.noble:def:2022487460000000",
	"version": "1",
	"metadata": {
		"title": "CVE-2022-48746 on Ubuntu 24.04 LTS (noble) - medium",
		"description": "In the Linux kernel, the following vulnerability has been resolved:net/mlx5e: Fix handling of wrong devices during bond netevent Currentimplementation of bond netevent handler only check if the handled netdev isVF representor and it missing a check if the VF representor is on the samephys device of the bond handling the netevent. Fix by adding the missingcheck and optimizing the check if the netdev is VF representor so it willnot access uninitialized private data and crashes. BUG: kernel NULL pointerdereference, address: 000000000000036c PGD 0 P4D 0 Oops: 0000 [#1] SMPNOPTI Workqueue: eth3bond0 bond_mii_monitor [bonding] RIP:0010:mlx5e_is_uplink_rep+0xc/0x50 [mlx5_core] RSP: 0018:ffff88812d69fd60EFLAGS: 00010282 RAX: 0000000000000000 RBX: ffff8881cf800000 RCX:0000000000000000 RDX: ffff88812d69fe10 RSI: 000000000000001b RDI:ffff8881cf800880 RBP: ffff8881cf800000 R08: 00000445cabccf2b R09:0000000000000008 R10: 0000000000000004 R11: 0000000000000008 R12:ffff88812d69fe10 R13: 00000000fffffffe R14: ffff88820c0f9000 R15:0000000000000000 FS: 0000000000000000(0000) GS:ffff88846fb00000(0000)knlGS:0000000000000000 CS: 0010 DS: 0000 ES: 0000 CR0: 0000000080050033CR2: 000000000000036c CR3: 0000000103d80006 CR4: 0000000000370ea0 DR0:0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000 DR3:0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400 Call Trace:mlx5e_eswitch_uplink_rep+0x31/0x40 [mlx5_core]mlx5e_rep_is_lag_netdev+0x94/0xc0 [mlx5_core]mlx5e_rep_esw_bond_netevent+0xeb/0x3d0 [mlx5_core]raw_notifier_call_chain+0x41/0x60 call_netdevice_notifiers_info+0x34/0x80netdev_lower_state_changed+0x4e/0xa0 bond_mii_monitor+0x56b/0x640 [bonding]process_one_work+0x1b9/0x390 worker_thread+0x4d/0x3d0 ?rescuer_thread+0x350/0x350 kthread+0x124/0x150 ?set_kthread_struct+0x40/0x40 ret_from_fork+0x1f/0x30\n\n    Update Instructions:\n\n    Run `sudo pro fix CVE-2022-48746` to fix the vulnerability. The problem can be corrected\n    by updating your system to the following package versions:\n\nlinux-image-6.5.0-9-generic - 6.5.0-9.9\nlinux-image-unsigned-6.5.0-9-generic - 6.5.0-9.9\nlinux-image-unsigned-6.5.0-9-generic-64k - 6.5.0-9.9\nNo subscription required\n\nlinux-image-unsigned-6.5.0-1008-aws - 6.5.0-1008.8\nNo subscription required\n\nlinux-image-unsigned-6.5.0-1007-azure - 6.5.0-1007.7\nNo subscription required\n\nlinux-image-unsigned-6.5.0-1007-gcp - 6.5.0-1007.7\nNo subscription required\n\nlinux-image-unsigned-6.8.0-1003-gke - 6.8.0-1003.5\nNo subscription required\n\nlinux-image-unsigned-6.5.0-1009-ibm - 6.5.0-1009.9\nNo subscription required\n\nlinux-image-unsigned-6.5.0-9-lowlatency - 6.5.0-9.9.1\nlinux-image-unsigned-6.5.0-9-lowlatency-64k - 6.5.0-9.9.1\nNo subscription required\n\nlinux-image-unsigned-6.5.0-1010-oracle - 6.5.0-1010.10\nNo subscription required\n\nlinux-image-unsigned-6.8.0-1003-oem - 6.8.0-1003.3\nNo subscription required\n\nlinux-image-6.5.0-1005-raspi - 6.5.0-1005.7\nNo subscription required\n\nlinux-image-unsigned-6.8.0-1005-intel - 6.8.0-1001.6\nNo subscription required\n\nlinux-image-6.7.0-2001-raspi-realtime - 6.7.0-2001.1\nAvailable with Ubuntu Pro: https://ubuntu.com/pro\n\nlinux-image-unsigned-6.8.0-1008-realtime - 6.8.0-1008.19\nAvailable with Ubuntu Pro: https://ubuntu.com/pro",
		"affected": {
			"family": "unix",
			"platform": "Ubuntu 24.04 LTS"
		},
		"reference": {
			"source": "CVE",
			"ref_id": "CVE-2022-48746",
			"ref_url": "https://www.cve.org/CVERecord?id=CVE-2022-48746"
		},
		"advisory": {
			"severity": "Medium",
			"rights": "Copyright (C) 2024 Canonical Ltd.",
			"public_date": "2024-06-20 12:15:00 UTC",
			"cve": {
				"text": "CVE-2022-48746",
				"href": "https://ubuntu.com/security/CVE-2022-48746",
				"public": "20240620"
			}
		}
	},
	"notes": {},
	"criteria": {
		"criterias": [
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201499000000000",
						"comment": "linux package in noble, is related to the CVE in some way and has been fixed (note: '6.5.0-9.9')."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201499000000010",
						"comment": "linux-aws package in noble, is related to the CVE in some way and has been fixed (note: '6.5.0-1008.8')."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201499000000030",
						"comment": "linux-azure package in noble, is related to the CVE in some way and has been fixed (note: '6.5.0-1007.7')."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201499000000030",
						"comment": "linux-gcp package in noble, is related to the CVE in some way and has been fixed (note: '6.5.0-1007.7')."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201499000000020",
						"comment": "linux-gke package in noble, is related to the CVE in some way and has been fixed (note: '6.8.0-1003.5')."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201499000000040",
						"comment": "linux-ibm package in noble, is related to the CVE in some way and has been fixed (note: '6.5.0-1009.9')."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201499000000060",
						"comment": "linux-lowlatency package in noble, is related to the CVE in some way and has been fixed (note: '6.5.0-9.9.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201499000000070",
						"comment": "linux-oracle package in noble, is related to the CVE in some way and has been fixed (note: '6.5.0-1010.10')."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201499000000080",
						"comment": "linux-oem-6.8 package in noble, is related to the CVE in some way and has been fixed (note: '6.8.0-1003.3')."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201499000000090",
						"comment": "linux-raspi package in noble, is related to the CVE in some way and has been fixed (note: '6.5.0-1005.7')."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201499000000050",
						"comment": "linux-intel package in noble, is related to the CVE in some way and has been fixed (note: '6.8.0-1001.6')."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201499000000100",
						"comment": "linux-raspi-realtime package in noble, is related to the CVE in some way and has been fixed (note: '6.7.0-2001.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201499000000110",
						"comment": "linux-realtime package in noble, is related to the CVE in some way and has been fixed (note: '6.8.0-1008.19')."
					}
				]
			}
		]
	}
}
