{
	"class": "vulnerability",
	"id": "oval:com.ubuntu.noble:def:2024467380000000",
	"version": "1",
	"metadata": {
		"title": "CVE-2024-46738 on Ubuntu 24.04 LTS (noble) - medium",
		"description": "In the Linux kernel, the following vulnerability has been resolved:VMCI: Fix use-after-free when removing resource in vmci_resource_remove()When removing a resource from vmci_resource_table invmci_resource_remove(), the search is performed using the resourcehandle by comparing context and resource fields.It is possible though to create two resources with different typesbut same handle (same context and resource fields).When trying to remove one of the resources, vmci_resource_remove()may not remove the intended one, but the object will still be freedas in the case of the datagram type in vmci_datagram_destroy_handle().vmci_resource_table will still hold a pointer to this freed resourceleading to a use-after-free vulnerability.BUG: KASAN: use-after-free in vmci_handle_is_equalinclude/linux/vmw_vmci_defs.h:142 [inline]BUG: KASAN: use-after-free in vmci_resource_remove+0x3a1/0x410drivers/misc/vmw_vmci/vmci_resource.c:147Read of size 4 at addr ffff88801c16d800 by task syz-executor197/1592Call Trace: <TASK> __dump_stack lib/dump_stack.c:88 [inline] dump_stack_lvl+0x82/0xa9 lib/dump_stack.c:106 print_address_description.constprop.0+0x21/0x366 mm/kasan/report.c:239 __kasan_report.cold+0x7f/0x132 mm/kasan/report.c:425 kasan_report+0x38/0x51 mm/kasan/report.c:442 vmci_handle_is_equal include/linux/vmw_vmci_defs.h:142 [inline] vmci_resource_remove+0x3a1/0x410 drivers/misc/vmw_vmci/vmci_resource.c:147 vmci_qp_broker_detach+0x89a/0x11b9drivers/misc/vmw_vmci/vmci_queue_pair.c:2182 ctx_free_ctx+0x473/0xbe1 drivers/misc/vmw_vmci/vmci_context.c:444 kref_put include/linux/kref.h:65 [inline] vmci_ctx_put drivers/misc/vmw_vmci/vmci_context.c:497 [inline] vmci_ctx_destroy+0x170/0x1d6 drivers/misc/vmw_vmci/vmci_context.c:195 vmci_host_close+0x125/0x1ac drivers/misc/vmw_vmci/vmci_host.c:143 __fput+0x261/0xa34 fs/file_table.c:282 task_work_run+0xf0/0x194 kernel/task_work.c:164 tracehook_notify_resume include/linux/tracehook.h:189 [inline] exit_to_user_mode_loop+0x184/0x189 kernel/entry/common.c:187 exit_to_user_mode_prepare+0x11b/0x123 kernel/entry/common.c:220 __syscall_exit_to_user_mode_work kernel/entry/common.c:302 [inline] syscall_exit_to_user_mode+0x18/0x42 kernel/entry/common.c:313 do_syscall_64+0x41/0x85 arch/x86/entry/common.c:86 entry_SYSCALL_64_after_hwframe+0x6e/0x0This change ensures the type is also checked when removingthe resource from vmci_resource_table in vmci_resource_remove().\n\n    Update Instructions:\n\n    Run `sudo pro fix CVE-2024-46738` to fix the vulnerability. The problem can be corrected\n    by updating your system to the following package versions:\n\nlinux-image-6.8.0-50-generic - 6.8.0-50.51\nlinux-image-unsigned-6.8.0-50-generic - 6.8.0-50.51\nlinux-image-unsigned-6.8.0-50-generic-64k - 6.8.0-50.51\nNo subscription required\n\nlinux-image-unsigned-6.8.0-1020-aws - 6.8.0-1020.22\nNo subscription required\n\nlinux-image-unsigned-6.8.0-1020-azure - 6.8.0-1020.23\nNo subscription required\n\nlinux-image-unsigned-6.8.0-1019-gcp - 6.8.0-1019.21\nNo subscription required\n\nlinux-image-unsigned-6.8.0-1015-gke - 6.8.0-1015.19\nNo subscription required\n\nlinux-image-unsigned-6.8.0-1017-ibm - 6.8.0-1017.17\nNo subscription required\n\nlinux-image-unsigned-6.8.0-50-lowlatency - 6.8.0-50.51.1\nlinux-image-unsigned-6.8.0-50-lowlatency-64k - 6.8.0-50.51.1\nNo subscription required\n\nlinux-image-unsigned-6.8.0-1017-oracle - 6.8.0-1017.18\nlinux-image-unsigned-6.8.0-1017-oracle-64k - 6.8.0-1017.18\nNo subscription required\n\nlinux-image-unsigned-6.8.0-1018-oem - 6.8.0-1018.18\nNo subscription required\n\nlinux-image-6.8.0-1016-raspi - 6.8.0-1016.18\nNo subscription required\n\nlinux-image-6.8.0-2015-raspi-realtime - 6.8.0-2015.16\nAvailable with Ubuntu Pro: https://ubuntu.com/pro\n\nlinux-image-unsigned-6.8.1-1013-realtime - 6.8.1-1013.14\nAvailable with Ubuntu Pro: https://ubuntu.com/pro\n\nlinux-image-unsigned-6.8.0-1005-intel - 6.8.0-1016.23\nNo subscription required",
		"affected": {
			"family": "unix",
			"platform": "Ubuntu 24.04 LTS"
		},
		"reference": {
			"source": "CVE",
			"ref_id": "CVE-2024-46738",
			"ref_url": "https://www.cve.org/CVERecord?id=CVE-2024-46738"
		},
		"advisory": {
			"severity": "Medium",
			"rights": "Copyright (C) 2024 Canonical Ltd.",
			"public_date": "2024-09-18 08:15:00 UTC",
			"cve": {
				"text": "CVE-2024-46738",
				"href": "https://ubuntu.com/security/CVE-2024-46738",
				"public": "20240918",
				"cvss_score": "7.8",
				"cvss_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
				"usns": "7088-1,7088-2,7088-3,7088-4,7100-1,7100-2,7088-5,7121-1,7119-1,7121-2,7123-1,7121-3,7144-1,7148-1,7154-1,7155-1,7156-1,7154-2,7194-1,7196-1"
			},
			"public_date_at_usn": "2024-09-18 08:15:00 UTC",
			"ref": [
				"https://ubuntu.com/security/notices/USN-7088-1",
				"https://ubuntu.com/security/notices/USN-7088-2",
				"https://ubuntu.com/security/notices/USN-7088-3",
				"https://ubuntu.com/security/notices/USN-7088-4",
				"https://ubuntu.com/security/notices/USN-7100-1",
				"https://ubuntu.com/security/notices/USN-7100-2",
				"https://ubuntu.com/security/notices/USN-7088-5",
				"https://ubuntu.com/security/notices/USN-7121-1",
				"https://ubuntu.com/security/notices/USN-7119-1",
				"https://ubuntu.com/security/notices/USN-7121-2",
				"https://ubuntu.com/security/notices/USN-7123-1",
				"https://ubuntu.com/security/notices/USN-7121-3",
				"https://ubuntu.com/security/notices/USN-7144-1",
				"https://ubuntu.com/security/notices/USN-7148-1",
				"https://ubuntu.com/security/notices/USN-7154-1",
				"https://ubuntu.com/security/notices/USN-7155-1",
				"https://ubuntu.com/security/notices/USN-7156-1",
				"https://ubuntu.com/security/notices/USN-7154-2",
				"https://ubuntu.com/security/notices/USN-7194-1",
				"https://ubuntu.com/security/notices/USN-7196-1"
			]
		}
	},
	"notes": {},
	"criteria": {
		"criterias": [
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:com.ubuntu.noble:tst:2023528890000000",
						"comment": "linux package in noble was vulnerable but has been fixed (note: '6.8.0-50.51')."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:2023528890000010",
						"comment": "linux-aws package in noble was vulnerable but has been fixed (note: '6.8.0-1020.22')."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:2023528890000020",
						"comment": "linux-azure package in noble was vulnerable but has been fixed (note: '6.8.0-1020.23')."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:2023528890000030",
						"comment": "linux-gcp package in noble was vulnerable but has been fixed (note: '6.8.0-1019.21')."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:2023528890000040",
						"comment": "linux-gke package in noble was vulnerable but has been fixed (note: '6.8.0-1015.19')."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:2023528890000050",
						"comment": "linux-ibm package in noble was vulnerable but has been fixed (note: '6.8.0-1017.17')."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:2023528890000060",
						"comment": "linux-lowlatency package in noble was vulnerable but has been fixed (note: '6.8.0-50.51.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:2023528890000070",
						"comment": "linux-oracle package in noble was vulnerable but has been fixed (note: '6.8.0-1017.18')."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:2023528890000080",
						"comment": "linux-oem-6.8 package in noble was vulnerable but has been fixed (note: '6.8.0-1018.18')."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:2023528890000090",
						"comment": "linux-raspi package in noble was vulnerable but has been fixed (note: '6.8.0-1016.18')."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:2023528890000110",
						"comment": "linux-raspi-realtime package in realtime/noble was vulnerable but has been fixed (note: '6.8.0-2015.16')."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:2023528890000120",
						"comment": "linux-realtime package in realtime/noble was vulnerable but has been fixed (note: '6.8.1-1013.14')."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:2023528890000100",
						"comment": "linux-intel package in noble, is related to the CVE in some way and has been fixed (note: '6.8.0-1016.23')."
					}
				]
			}
		]
	}
}
