{
	"class": "vulnerability",
	"id": "oval:com.ubuntu.noble:def:2024270220000000",
	"version": "1",
	"metadata": {
		"title": "CVE-2024-27022 on Ubuntu 24.04 LTS (noble) - medium",
		"description": "In the Linux kernel, the following vulnerability has been resolved:fork: defer linking file vma until vma is fully initializedThorvald reported a WARNING [1]. And the root cause is below race: CPU 1\t\t\t\t\tCPU 2 fork\t\t\t\t\thugetlbfs_fallocate  dup_mmap\t\t\t\t hugetlbfs_punch_hole   i_mmap_lock_write(mapping);   vma_interval_tree_insert_after -- Child vma is visible through i_mmaptree.   i_mmap_unlock_write(mapping);   hugetlb_dup_vma_private -- Clear vma_lock outside i_mmap_rwsem!\t\t\t\t\t i_mmap_lock_write(mapping);   \t\t\t\t\t hugetlb_vmdelete_list\t\t\t\t\t  vma_interval_tree_foreach\t\t\t\t\t   hugetlb_vma_trylock_write -- Vma_lock is cleared.   tmp->vm_ops->open -- Alloc new vma_lock outside i_mmap_rwsem!\t\t\t\t\t   hugetlb_vma_unlock_write -- Vma_lock is assigned!!!\t\t\t\t\t i_mmap_unlock_write(mapping);hugetlb_dup_vma_private() and hugetlb_vm_op_open() are called outsidei_mmap_rwsem lock while vma lock can be used in the same time.  Fix thisby deferring linking file vma until vma is fully initialized.  Those vmasshould be initialized first before they can be used.",
		"affected": {
			"family": "unix",
			"platform": "Ubuntu 24.04 LTS"
		},
		"reference": {
			"source": "CVE",
			"ref_id": "CVE-2024-27022",
			"ref_url": "https://www.cve.org/CVERecord?id=CVE-2024-27022"
		},
		"advisory": {
			"severity": "Medium",
			"rights": "Copyright (C) 2024 Canonical Ltd.",
			"public_date": "2024-05-01 06:15:00 UTC",
			"cve": {
				"text": "CVE-2024-27022",
				"href": "https://ubuntu.com/security/CVE-2024-27022",
				"public": "20240501"
			}
		}
	},
	"notes": {},
	"criteria": {
		"criterias": [
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201245420000000",
						"comment": "linux package in noble is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201245420000010",
						"comment": "linux-aws package in noble is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201245420000030",
						"comment": "linux-azure package in noble is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201245420000040",
						"comment": "linux-gcp package in noble is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201245420000020",
						"comment": "linux-gke package in noble is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201245420000070",
						"comment": "linux-ibm package in noble is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201245420000080",
						"comment": "linux-lowlatency package in noble is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201245420000050",
						"comment": "linux-oracle package in noble is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201245420000060",
						"comment": "linux-raspi package in noble is affected and may need fixing."
					}
				]
			}
		]
	}
}
