{
	"class": "vulnerability",
	"id": "oval:com.ubuntu.noble:def:2021474060000000",
	"version": "1",
	"metadata": {
		"title": "CVE-2021-47406 on Ubuntu 24.04 LTS (noble) - medium",
		"description": "In the Linux kernel, the following vulnerability has been resolved:ext4: add error checking to ext4_ext_replay_set_iblocks()If the call to ext4_map_blocks() fails due to an corrupted filesystem, ext4_ext_replay_set_iblocks() can get stuck in an infiniteloop.  This could be reproduced by running generic/526 with a filesystem that has inline_data and fast_commit enabled.  The system willrepeatedly log to the console:EXT4-fs warning (device dm-3): ext4_block_to_path:105: block 1074800922 >max in inode 131076and the stack that it gets stuck in is:   ext4_block_to_path+0xe3/0x130   ext4_ind_map_blocks+0x93/0x690   ext4_map_blocks+0x100/0x660   skip_hole+0x47/0x70   ext4_ext_replay_set_iblocks+0x223/0x440   ext4_fc_replay_inode+0x29e/0x3b0   ext4_fc_replay+0x278/0x550   do_one_pass+0x646/0xc10   jbd2_journal_recover+0x14a/0x270   jbd2_journal_load+0xc4/0x150   ext4_load_journal+0x1f3/0x490   ext4_fill_super+0x22d4/0x2c00With this patch, generic/526 still fails, but system is no longerlocking up in a tight loop.  It's likely the root casue is thatfast_commit replay is corrupting file systems with inline_data, and weprobably need to add better error handling in the fast commit replaycode path beyond what is done here, which essentially just breaks theinfinite loop without reporting the to the higher levels of the code.",
		"affected": {
			"family": "unix",
			"platform": "Ubuntu 24.04 LTS"
		},
		"reference": {
			"source": "CVE",
			"ref_id": "CVE-2021-47406",
			"ref_url": "https://www.cve.org/CVERecord?id=CVE-2021-47406"
		},
		"advisory": {
			"severity": "Medium",
			"rights": "Copyright (C) 2024 Canonical Ltd.",
			"public_date": "2024-05-21 15:15:00 UTC",
			"cve": {
				"text": "CVE-2021-47406",
				"href": "https://ubuntu.com/security/CVE-2021-47406",
				"public": "20240521"
			}
		}
	},
	"notes": {},
	"criteria": {
		"criterias": [
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201245420000000",
						"comment": "linux package in noble is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201245420000010",
						"comment": "linux-aws package in noble is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201245420000030",
						"comment": "linux-azure package in noble is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201245420000040",
						"comment": "linux-gcp package in noble is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201245420000020",
						"comment": "linux-gke package in noble is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201245420000070",
						"comment": "linux-ibm package in noble is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201245420000080",
						"comment": "linux-lowlatency package in noble is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201245420000050",
						"comment": "linux-oracle package in noble is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201245420000060",
						"comment": "linux-raspi package in noble is affected and may need fixing."
					}
				]
			}
		]
	}
}
