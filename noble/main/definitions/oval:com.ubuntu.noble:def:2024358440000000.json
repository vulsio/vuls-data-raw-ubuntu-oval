{
	"class": "vulnerability",
	"id": "oval:com.ubuntu.noble:def:2024358440000000",
	"version": "1",
	"metadata": {
		"title": "CVE-2024-35844 on Ubuntu 24.04 LTS (noble) - medium",
		"description": "In the Linux kernel, the following vulnerability has been resolved: f2fs:compress: fix reserve_cblocks counting error when out of space When a fileonly needs one direct_node, performing the following operations will causethe file to be unrepairable: unisoc # ./f2fs_io compress test.apk unisoc#df -h | grep dm-48 /dev/block/dm-48 112G 112G 1.2M 100% /data unisoc #./f2fs_io release_cblocks test.apk 924 unisoc # df -h | grep dm-48/dev/block/dm-48 112G 112G 4.8M 100% /data unisoc # dd if=/dev/randomof=file4 bs=1M count=3 3145728 bytes (3.0 M) copied, 0.025 s, 120 M/sunisoc # df -h | grep dm-48 /dev/block/dm-48 112G 112G 1.8M 100% /dataunisoc # ./f2fs_io reserve_cblocks test.apkF2FS_IOC_RESERVE_COMPRESS_BLOCKS failed: No space left on device adb rebootunisoc # df -h | grep dm-48 /dev/block/dm-48 112G 112G 11M 100% /dataunisoc # ./f2fs_io reserve_cblocks test.apk 0 This is because the file hasonly one direct_node. After returning to -ENOSPC, reserved_blocks += retwill not be executed. As a result, the reserved_blocks at this time isstill 0, which is not the real number of reserved blocks. Therefore, fsckcannot be set to repair the file. After this patch, the fsck flag will beset to fix this problem. unisoc # df -h | grep dm-48 /dev/block/dm-48 112G112G 1.8M 100% /data unisoc # ./f2fs_io reserve_cblocks test.apkF2FS_IOC_RESERVE_COMPRESS_BLOCKS failed: No space left on device adb rebootthen fsck will be executed unisoc # df -h | grep dm-48 /dev/block/dm-48112G 112G 11M 100% /data unisoc # ./f2fs_io reserve_cblocks test.apk 924\n\n    Update Instructions:\n\n    Run `sudo pro fix CVE-2024-35844` to fix the vulnerability. The problem can be corrected\n    by updating your system to the following package versions:\n\nlinux-image-6.8.0-35-generic - 6.8.0-35.35\nlinux-image-unsigned-6.8.0-35-generic - 6.8.0-35.35\nlinux-image-unsigned-6.8.0-35-generic-64k - 6.8.0-35.35\nNo subscription required\n\nlinux-image-unsigned-6.8.0-1009-aws - 6.8.0-1009.9\nNo subscription required\n\nlinux-image-unsigned-6.8.0-1008-azure - 6.8.0-1008.8\nNo subscription required\n\nlinux-image-unsigned-6.8.0-1008-gcp - 6.8.0-1008.9\nNo subscription required\n\nlinux-image-unsigned-6.8.0-1004-gke - 6.8.0-1004.7\nNo subscription required\n\nlinux-image-unsigned-6.8.0-1006-ibm - 6.8.0-1006.6\nNo subscription required\n\nlinux-image-unsigned-6.8.0-35-lowlatency - 6.8.0-35.35.1\nlinux-image-unsigned-6.8.0-35-lowlatency-64k - 6.8.0-35.35.1\nNo subscription required\n\nlinux-image-6.8.0-1005-raspi - 6.8.0-1005.5\nNo subscription required\n\nlinux-image-unsigned-6.8.0-1006-oem - 6.8.0-1006.6\nNo subscription required\n\nlinux-image-unsigned-6.8.0-1005-intel - 6.8.0-1005.12\nNo subscription required",
		"affected": {
			"family": "unix",
			"platform": "Ubuntu 24.04 LTS"
		},
		"reference": {
			"source": "CVE",
			"ref_id": "CVE-2024-35844",
			"ref_url": "https://www.cve.org/CVERecord?id=CVE-2024-35844"
		},
		"advisory": {
			"severity": "Medium",
			"rights": "Copyright (C) 2024 Canonical Ltd.",
			"public_date": "2024-05-17 15:15:00 UTC",
			"cve": {
				"text": "CVE-2024-35844",
				"href": "https://ubuntu.com/security/CVE-2024-35844",
				"public": "20240517"
			},
			"public_date_at_usn": "2024-05-17 15:15:00 UTC",
			"ref": [
				"https://ubuntu.com/security/notices/USN-6816-1",
				"https://ubuntu.com/security/notices/USN-6817-1",
				"https://ubuntu.com/security/notices/USN-6820-1",
				"https://ubuntu.com/security/notices/USN-6821-1",
				"https://ubuntu.com/security/notices/USN-6821-2",
				"https://ubuntu.com/security/notices/USN-6817-2",
				"https://ubuntu.com/security/notices/USN-6828-1",
				"https://ubuntu.com/security/notices/USN-6820-2",
				"https://ubuntu.com/security/notices/USN-6821-3",
				"https://ubuntu.com/security/notices/USN-6817-3",
				"https://ubuntu.com/security/notices/USN-6821-4"
			]
		}
	},
	"notes": {},
	"criteria": {
		"criterias": [
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:com.ubuntu.noble:tst:2022380960000000",
						"comment": "linux package in noble was vulnerable but has been fixed (note: '6.8.0-35.35')."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:2022380960000010",
						"comment": "linux-aws package in noble was vulnerable but has been fixed (note: '6.8.0-1009.9')."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:2022380960000020",
						"comment": "linux-azure package in noble was vulnerable but has been fixed (note: '6.8.0-1008.8')."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:2022380960000030",
						"comment": "linux-gcp package in noble was vulnerable but has been fixed (note: '6.8.0-1008.9')."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:2022486690000000",
						"comment": "linux-gke package in noble was vulnerable but has been fixed (note: '6.8.0-1004.7')."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:2022380960000040",
						"comment": "linux-ibm package in noble was vulnerable but has been fixed (note: '6.8.0-1006.6')."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:2022380960000050",
						"comment": "linux-lowlatency package in noble was vulnerable but has been fixed (note: '6.8.0-35.35.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201245420000050",
						"comment": "linux-oracle package in noble is affected. An update containing the fix has been completed and is pending publication (note: '6.8.0-1006.6')."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:2022380960000060",
						"comment": "linux-raspi package in noble was vulnerable but has been fixed (note: '6.8.0-1005.5')."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:2022380960000040",
						"comment": "linux-oem-6.8 package in noble was vulnerable but has been fixed (note: '6.8.0-1006.6')."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:2016107230000090",
						"comment": "linux-intel package in noble, is related to the CVE in some way and has been fixed (note: '6.8.0-1005.12')."
					}
				]
			}
		]
	}
}
