{
	"class": "vulnerability",
	"id": "oval:com.ubuntu.noble:def:2022488220000000",
	"version": "1",
	"metadata": {
		"title": "CVE-2022-48822 on Ubuntu 24.04 LTS (noble) - medium",
		"description": "In the Linux kernel, the following vulnerability has been resolved:usb: f_fs: Fix use-after-free for epfileConsider a case where ffs_func_eps_disable is called fromffs_func_disable as part of composition switch and at thesame time ffs_epfile_release get called from userspace.ffs_epfile_release will free up the read buffer and callffs_data_closed which in turn destroys ffs->epfiles andmark it as NULL. While this was happening the driver hasalready initialized the local epfile in ffs_func_eps_disablewhich is now freed and waiting to acquire the spinlock. Oncespinlock is acquired the driver proceeds with the stale valueof epfile and tries to free the already freed read buffercausing use-after-free.Following is the illustration of the race:      CPU1                                  CPU2   ffs_func_eps_disable   epfiles (local copy)\t\t\t\t\tffs_epfile_release\t\t\t\t\tffs_data_closed\t\t\t\t\tif (last file closed)\t\t\t\t\tffs_data_reset\t\t\t\t\tffs_data_clear\t\t\t\t\tffs_epfiles_destroyspin_lockdereference epfilesFix this races by taking epfiles local copy & assigning it underspinlock and if epfiles(local) is null then update it in ffs->epfilesthen finally destroy it.Extending the scope further from the race, protecting the ep relatedstructures, and concurrent accesses.",
		"affected": {
			"family": "unix",
			"platform": "Ubuntu 24.04 LTS"
		},
		"reference": {
			"source": "CVE",
			"ref_id": "CVE-2022-48822",
			"ref_url": "https://www.cve.org/CVERecord?id=CVE-2022-48822"
		},
		"advisory": {
			"severity": "Medium",
			"rights": "Copyright (C) 2024 Canonical Ltd.",
			"public_date": "2024-07-16 12:15:00 UTC",
			"cve": {
				"text": "CVE-2022-48822",
				"href": "https://ubuntu.com/security/CVE-2022-48822",
				"public": "20240716"
			}
		}
	},
	"notes": {},
	"criteria": {
		"criterias": [
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201245420000000",
						"comment": "linux package in noble is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201245420000010",
						"comment": "linux-aws package in noble is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201245420000030",
						"comment": "linux-azure package in noble is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201245420000040",
						"comment": "linux-gcp package in noble is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201245420000020",
						"comment": "linux-gke package in noble is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201245420000070",
						"comment": "linux-ibm package in noble is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201245420000100",
						"comment": "linux-intel package in noble is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201245420000080",
						"comment": "linux-lowlatency package in noble is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201245420000050",
						"comment": "linux-oracle package in noble is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201245420000090",
						"comment": "linux-oem-6.8 package in noble is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201245420000060",
						"comment": "linux-raspi package in noble is affected and may need fixing."
					}
				]
			}
		]
	}
}
