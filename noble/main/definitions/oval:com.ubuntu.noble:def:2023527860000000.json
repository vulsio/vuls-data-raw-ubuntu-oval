{
	"class": "vulnerability",
	"id": "oval:com.ubuntu.noble:def:2023527860000000",
	"version": "1",
	"metadata": {
		"title": "CVE-2023-52786 on Ubuntu 24.04 LTS (noble) - medium",
		"description": "In the Linux kernel, the following vulnerability has been resolved: ext4:fix racy may inline data check in dio write syzbot reports that thefollowing warning from ext4_iomap_begin() triggers as of the commitreferenced below: if (WARN_ON_ONCE(ext4_has_inline_data(inode))) return-ERANGE; This occurs during a dio write, which is never expected toencounter an inode with inline data. To enforce this behavior,ext4_dio_write_iter() checks the current inline state of the inode andclears the MAY_INLINE_DATA state flag to either fall back to bufferedwrites, or enforce that any other writers in progress on the inode are notallowed to create inline data. The problem is that the check for existinginline data and the state flag can span a lock cycle. For example, if theilock is originally locked shared and subsequently upgraded to exclusive,another writer may have reacquired the lock and created inline data beforethe dio write task acquires the lock and proceeds. The commit referencedbelow loosens the lock requirements to allow some forms of unaligned diowrites to occur under shared lock, but AFAICT the inline data check wastechnically already racy for any dio write that would have involved a lockcycle. Regardless, lift clearing of the state bit to the same lock criticalsection that checks for preexisting inline data on the inode to close therace.",
		"affected": {
			"family": "unix",
			"platform": "Ubuntu 24.04 LTS"
		},
		"reference": {
			"source": "CVE",
			"ref_id": "CVE-2023-52786",
			"ref_url": "https://www.cve.org/CVERecord?id=CVE-2023-52786"
		},
		"advisory": {
			"severity": "Medium",
			"rights": "Copyright (C) 2024 Canonical Ltd.",
			"public_date": "2024-05-21 16:15:00 UTC",
			"cve": {
				"text": "CVE-2023-52786",
				"href": "https://ubuntu.com/security/CVE-2023-52786",
				"public": "20240521"
			}
		}
	},
	"notes": {},
	"criteria": {
		"criterias": [
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201245420000000",
						"comment": "linux package in noble is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201245420000010",
						"comment": "linux-aws package in noble is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201245420000030",
						"comment": "linux-azure package in noble is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201245420000040",
						"comment": "linux-gcp package in noble is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201245420000020",
						"comment": "linux-gke package in noble is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201245420000070",
						"comment": "linux-ibm package in noble is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201245420000080",
						"comment": "linux-lowlatency package in noble is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201245420000050",
						"comment": "linux-oracle package in noble is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201245420000060",
						"comment": "linux-raspi package in noble is affected and may need fixing."
					}
				]
			}
		]
	}
}
