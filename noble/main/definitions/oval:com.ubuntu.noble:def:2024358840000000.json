{
	"class": "vulnerability",
	"id": "oval:com.ubuntu.noble:def:2024358840000000",
	"version": "1",
	"metadata": {
		"title": "CVE-2024-35884 on Ubuntu 24.04 LTS (noble) - medium",
		"description": "In the Linux kernel, the following vulnerability has been resolved: udp: donot accept non-tunnel GSO skbs landing in a tunnel Whenrx-udp-gro-forwarding is enabled UDP packets might be GROed when beingforwarded. If such packets might land in a tunnel this can cause variousissues and udp_gro_receive makes sure this isn't the case by looking for amatching socket. This is performed in udp4/6_gro_lookup_skb but only in thecurrent netns. This is an issue with tunneled packets when the endpoint isin another netns. In such cases the packets will be GROed at the UDP level,which leads to various issues later on. The same thing can happen withrx-gro-list. We saw this with geneve packets being GROed at the UDP level.In such case gso_size is set; later the packet goes through the geneve rxpath, the geneve header is pulled, the offset are adjusted and frag_listskbs are not adjusted with regard to geneve. When those skbs hitskb_fragment, it will misbehave. Different outcomes are possible dependingon what the GROed skbs look like; from corrupted packets to kernel crashes.One example is a BUG_ON[1] triggered in skb_segment while processing thefrag_list. Because gso_size is wrong (geneve header was pulled) skb_segmentthinks there is \"geneve header size\" of data in frag_list, although it's infact the next packet. The BUG_ON itself has nothing to do with the issue.This is only one of the potential issues. Looking up for a matching socketin udp_gro_receive is fragile: the lookup could be extended to all netns(not speaking about performances) but nothing prevents those packets frombeing modified in between and we could still not find a matching socket.It's OK to keep the current logic there as it should cover most cases butwe also need to make sure we handle tunnel packets being GROed too early.This is done by extending the checks in udp_unexpected_gso: GSO packetslacking the SKB_GSO_UDP_TUNNEL/_CSUM bits and landing in a tunnel must besegmented. [1] kernel BUG at net/core/skbuff.c:4408! RIP:0010:skb_segment+0xd2a/0xf70 __udp_gso_segment+0xaa/0x560\n\n    Update Instructions:\n\n    Run `sudo pro fix CVE-2024-35884` to fix the vulnerability. The problem can be corrected\n    by updating your system to the following package versions:\n\nlinux-image-6.8.0-38-generic - 6.8.0-38.38\nlinux-image-unsigned-6.8.0-38-generic - 6.8.0-38.38\nlinux-image-unsigned-6.8.0-38-generic-64k - 6.8.0-38.38\nNo subscription required\n\nlinux-image-unsigned-6.8.0-1011-aws - 6.8.0-1011.12\nNo subscription required\n\nlinux-image-unsigned-6.8.0-1010-azure - 6.8.0-1010.10\nNo subscription required\n\nlinux-image-unsigned-6.8.0-1010-gcp - 6.8.0-1010.11\nNo subscription required\n\nlinux-image-unsigned-6.8.0-1006-gke - 6.8.0-1006.9\nNo subscription required\n\nlinux-image-unsigned-6.8.0-1008-ibm - 6.8.0-1008.8\nNo subscription required\n\nlinux-image-unsigned-6.8.0-38-lowlatency - 6.8.0-38.38.1\nlinux-image-unsigned-6.8.0-38-lowlatency-64k - 6.8.0-38.38.1\nNo subscription required\n\nlinux-image-unsigned-6.8.0-1008-oracle - 6.8.0-1008.8\nlinux-image-unsigned-6.8.0-1008-oracle-64k - 6.8.0-1008.8\nNo subscription required\n\nlinux-image-6.8.0-1007-raspi - 6.8.0-1007.7\nNo subscription required\n\nlinux-image-unsigned-6.8.0-1008-oem - 6.8.0-1008.8\nNo subscription required\n\nlinux-image-unsigned-6.8.0-1007-intel - 6.8.0-1007.14\nNo subscription required",
		"affected": {
			"family": "unix",
			"platform": "Ubuntu 24.04 LTS"
		},
		"reference": {
			"source": "CVE",
			"ref_id": "CVE-2024-35884",
			"ref_url": "https://www.cve.org/CVERecord?id=CVE-2024-35884"
		},
		"advisory": {
			"severity": "Medium",
			"rights": "Copyright (C) 2024 Canonical Ltd.",
			"public_date": "2024-05-19 09:15:00 UTC",
			"cve": {
				"text": "CVE-2024-35884",
				"href": "https://ubuntu.com/security/CVE-2024-35884",
				"public": "20240519"
			},
			"public_date_at_usn": "2024-05-19 09:15:00 UTC",
			"ref": [
				"https://ubuntu.com/security/notices/USN-6893-1",
				"https://ubuntu.com/security/notices/USN-6898-1",
				"https://ubuntu.com/security/notices/USN-6893-2",
				"https://ubuntu.com/security/notices/USN-6898-2",
				"https://ubuntu.com/security/notices/USN-6898-3",
				"https://ubuntu.com/security/notices/USN-6893-3",
				"https://ubuntu.com/security/notices/USN-6898-4",
				"https://ubuntu.com/security/notices/USN-6917-1",
				"https://ubuntu.com/security/notices/USN-6919-1",
				"https://ubuntu.com/security/notices/USN-6918-1",
				"https://ubuntu.com/security/notices/USN-6927-1",
				"https://ubuntu.com/security/notices/USN-7019-1"
			]
		}
	},
	"notes": {},
	"criteria": {
		"criterias": [
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:com.ubuntu.noble:tst:2023526990000000",
						"comment": "linux package in noble was vulnerable but has been fixed (note: '6.8.0-38.38')."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:2022487720000060",
						"comment": "linux-aws package in noble was vulnerable but has been fixed (note: '6.8.0-1011.12')."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:2023526990000010",
						"comment": "linux-azure package in noble was vulnerable but has been fixed (note: '6.8.0-1010.10')."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:2023526990000020",
						"comment": "linux-gcp package in noble was vulnerable but has been fixed (note: '6.8.0-1010.11')."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:2023526990000030",
						"comment": "linux-gke package in noble was vulnerable but has been fixed (note: '6.8.0-1006.9')."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:2022380960000020",
						"comment": "linux-ibm package in noble was vulnerable but has been fixed (note: '6.8.0-1008.8')."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:2023526990000040",
						"comment": "linux-lowlatency package in noble was vulnerable but has been fixed (note: '6.8.0-38.38.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:2022380960000020",
						"comment": "linux-oracle package in noble was vulnerable but has been fixed (note: '6.8.0-1008.8')."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:2023526990000050",
						"comment": "linux-raspi package in noble was vulnerable but has been fixed (note: '6.8.0-1007.7')."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:2022380960000020",
						"comment": "linux-oem-6.8 package in noble was vulnerable but has been fixed (note: '6.8.0-1008.8')."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:2023526990000060",
						"comment": "linux-intel package in noble was vulnerable but has been fixed (note: '6.8.0-1007.14')."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201245420000110",
						"comment": "linux-raspi-realtime package in noble is affected. An update containing the fix has been completed and is pending publication (note: '6.8.0-2006.6')."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201245420000120",
						"comment": "linux-realtime package in noble is affected. An update containing the fix has been completed and is pending publication (note: '6.8.1-1004.4')."
					}
				]
			}
		]
	}
}
