{
	"class": "vulnerability",
	"id": "oval:com.ubuntu.noble:def:2024360070000000",
	"version": "1",
	"metadata": {
		"title": "CVE-2024-36007 on Ubuntu 24.04 LTS (noble) - medium",
		"description": "In the Linux kernel, the following vulnerability has been resolved: mlxsw:spectrum_acl_tcam: Fix warning during rehash As previously explained, therehash delayed work migrates filters from one region to another. This isdone by iterating over all chunks (all the filters with the same priority)in the region and in each chunk iterating over all the filters. When thework runs out of credits it stores the current chunk and entry as markersin the per-work context so that it would know where to resume the migrationfrom the next time the work is scheduled. Upon error, the chunk marker isreset to NULL, but without resetting the entry markers despite beingrelative to it. This can result in migration being resumed from an entrythat does not belong to the chunk being migrated. In turn, this willeventually lead to a chunk being iterated over as if it is an entry.Because of how the two structures happen to be defined, this does not leadto KASAN splats, but to warnings such as [1]. Fix by creating a helper thatresets all the markers and call it from all the places the currently onlyreset the chunk marker. For good measures also call it when starting acompletely new rehash. Add a warning to avoid future cases. [1] WARNING:CPU: 7 PID: 1076 atdrivers/net/ethernet/mellanox/mlxsw/core_acl_flex_keys.c:407mlxsw_afk_encode+0x242/0x2f0 Modules linked in: CPU: 7 PID: 1076 Comm:kworker/7:24 Tainted: G W 6.9.0-rc3-custom-00880-g29e61d91b77b #29 Hardwarename: Mellanox Technologies Ltd. MSN3700/VMOD0005, BIOS 5.11 01/06/2019Workqueue: mlxsw_core mlxsw_sp_acl_tcam_vregion_rehash_work RIP:0010:mlxsw_afk_encode+0x242/0x2f0 [...] Call Trace: <TASK>mlxsw_sp_acl_atcam_entry_add+0xd9/0x3c0mlxsw_sp_acl_tcam_entry_create+0x5e/0xa0mlxsw_sp_acl_tcam_vchunk_migrate_all+0x109/0x290mlxsw_sp_acl_tcam_vregion_rehash_work+0x6c/0x470process_one_work+0x151/0x370 worker_thread+0x2cb/0x3e0 kthread+0xd0/0x100ret_from_fork+0x34/0x50 </TASK>",
		"affected": {
			"family": "unix",
			"platform": "Ubuntu 24.04 LTS"
		},
		"reference": {
			"source": "CVE",
			"ref_id": "CVE-2024-36007",
			"ref_url": "https://www.cve.org/CVERecord?id=CVE-2024-36007"
		},
		"advisory": {
			"severity": "Medium",
			"rights": "Copyright (C) 2024 Canonical Ltd.",
			"public_date": "2024-05-20 10:15:00 UTC",
			"cve": {
				"text": "CVE-2024-36007",
				"href": "https://ubuntu.com/security/CVE-2024-36007",
				"public": "20240520"
			}
		}
	},
	"notes": {},
	"criteria": {
		"criterias": [
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201245420000000",
						"comment": "linux package in noble is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201245420000010",
						"comment": "linux-aws package in noble is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201245420000030",
						"comment": "linux-azure package in noble is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201245420000040",
						"comment": "linux-gcp package in noble is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201245420000020",
						"comment": "linux-gke package in noble is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201245420000070",
						"comment": "linux-ibm package in noble is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201245420000080",
						"comment": "linux-lowlatency package in noble is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201245420000050",
						"comment": "linux-oracle package in noble is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201245420000060",
						"comment": "linux-raspi package in noble is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201245420000090",
						"comment": "linux-oem-6.8 package in noble is affected and may need fixing."
					}
				]
			}
		]
	}
}
