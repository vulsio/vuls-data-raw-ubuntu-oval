{
	"class": "vulnerability",
	"id": "oval:com.ubuntu.noble:def:2024268850000000",
	"version": "1",
	"metadata": {
		"title": "CVE-2024-26885 on Ubuntu 24.04 LTS (noble) - medium",
		"description": "In the Linux kernel, the following vulnerability has been resolved: bpf:Fix DEVMAP_HASH overflow check on 32-bit arches The devmap code allocates anumber hash buckets equal to the next power of two of the max_entries valueprovided when creating the map. When rounding up to the next power of two,the 32-bit variable storing the number of buckets can overflow, and thecode checks for overflow by checking if the truncated 32-bit value is equalto 0. However, on 32-bit arches the rounding up itself can overflow mid-waythrough, because it ends up doing a left-shift of 32 bits on an unsignedlong value. If the size of an unsigned long is four bytes, this isundefined behaviour, so there is no guarantee that we'll end up with a niceand tidy 0-value at the end. Syzbot managed to turn this into a crash onarm32 by creating a DEVMAP_HASH with max_entries > 0x80000000 and thentrying to update it. Fix this by moving the overflow check to before therounding up operation.",
		"affected": {
			"family": "unix",
			"platform": "Ubuntu 24.04 LTS"
		},
		"reference": {
			"source": "CVE",
			"ref_id": "CVE-2024-26885",
			"ref_url": "https://www.cve.org/CVERecord?id=CVE-2024-26885"
		},
		"advisory": {
			"severity": "Medium",
			"rights": "Copyright (C) 2024 Canonical Ltd.",
			"public_date": "2024-04-17 11:15:00 UTC",
			"cve": {
				"text": "CVE-2024-26885",
				"href": "https://ubuntu.com/security/CVE-2024-26885",
				"public": "20240417",
				"cvss_score": "7.8",
				"cvss_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H"
			}
		}
	},
	"notes": {},
	"criteria": {
		"criterias": [
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201245420000000",
						"comment": "linux package in noble is affected. An update containing the fix has been completed and is pending publication."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201245420000010",
						"comment": "linux-aws package in noble is affected. An update containing the fix has been completed and is pending publication."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201245420000030",
						"comment": "linux-azure package in noble is affected. An update containing the fix has been completed and is pending publication."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201245420000040",
						"comment": "linux-gcp package in noble is affected. An update containing the fix has been completed and is pending publication."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201245420000070",
						"comment": "linux-ibm package in noble is affected and needs fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201245420000080",
						"comment": "linux-lowlatency package in noble is affected and needs fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201245420000050",
						"comment": "linux-oracle package in noble is affected and needs fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201245420000060",
						"comment": "linux-raspi package in noble is affected and needs fixing."
					}
				]
			}
		]
	}
}
