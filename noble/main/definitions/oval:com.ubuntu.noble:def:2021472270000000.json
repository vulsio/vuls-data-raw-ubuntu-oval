{
	"class": "vulnerability",
	"id": "oval:com.ubuntu.noble:def:2021472270000000",
	"version": "1",
	"metadata": {
		"title": "CVE-2021-47227 on Ubuntu 24.04 LTS (noble) - medium",
		"description": "In the Linux kernel, the following vulnerability has been resolved:x86/fpu: Prevent state corruption in __fpu__restore_sig()The non-compacted slowpath uses __copy_from_user() and copies the entireuser buffer into the kernel buffer, verbatim.  This means that the kernelbuffer may now contain entirely invalid state on which XRSTOR will #GP.validate_user_xstate_header() can detect some of that corruption, but thatleaves the onus on callers to clear the buffer.Prior to XSAVES support, it was possible just to reinitialize the buffer,completely, but with supervisor states that is not longer possible as thebuffer clearing code split got it backwards. Fixing that is possible butnot corrupting the state in the first place is more robust.Avoid corruption of the kernel XSAVE buffer by using copy_user_to_xstate()which validates the XSAVE header contents before copying the actual statesto the kernel. copy_user_to_xstate() was previously only called forcompacted-format kernel buffers, but it works for both compacted andnon-compacted forms.Using it for the non-compacted form is slower because of multiple__copy_from_user() operations, but that cost is less important than robustcode in an already slow path.[ Changelog polished by Dave Hansen ]",
		"affected": {
			"family": "unix",
			"platform": "Ubuntu 24.04 LTS"
		},
		"reference": {
			"source": "CVE",
			"ref_id": "CVE-2021-47227",
			"ref_url": "https://www.cve.org/CVERecord?id=CVE-2021-47227"
		},
		"advisory": {
			"severity": "Medium",
			"rights": "Copyright (C) 2024 Canonical Ltd.",
			"public_date": "2024-05-21 15:15:00 UTC",
			"cve": {
				"text": "CVE-2021-47227",
				"href": "https://ubuntu.com/security/CVE-2021-47227",
				"public": "20240521"
			}
		}
	},
	"notes": {},
	"criteria": {
		"criterias": [
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201245420000000",
						"comment": "linux package in noble is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201245420000010",
						"comment": "linux-aws package in noble is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201245420000030",
						"comment": "linux-azure package in noble is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201245420000040",
						"comment": "linux-gcp package in noble is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201245420000020",
						"comment": "linux-gke package in noble is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201245420000070",
						"comment": "linux-ibm package in noble is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201245420000080",
						"comment": "linux-lowlatency package in noble is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201245420000050",
						"comment": "linux-oracle package in noble is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201245420000060",
						"comment": "linux-raspi package in noble is affected and may need fixing."
					}
				]
			}
		]
	}
}
