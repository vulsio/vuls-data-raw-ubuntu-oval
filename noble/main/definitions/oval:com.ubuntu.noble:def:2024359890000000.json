{
	"class": "vulnerability",
	"id": "oval:com.ubuntu.noble:def:2024359890000000",
	"version": "1",
	"metadata": {
		"title": "CVE-2024-35989 on Ubuntu 24.04 LTS (noble) - medium",
		"description": "In the Linux kernel, the following vulnerability has been resolved:dmaengine: idxd: Fix oops during rmmod on single-CPU platforms During theremoval of the idxd driver, registered offline callback is invoked as partof the clean up process. However, on systems with only one CPU online, novalid target is available to migrate the perf context, resulting in akernel oops: BUG: unable to handle page fault for address: 000000000002a2b8#PF: supervisor write access in kernel mode #PF: error_code(0x0002) -not-present page PGD 1470e1067 P4D 0 Oops: 0002 [#1] PREEMPT SMP NOPTI CPU:0 PID: 20 Comm: cpuhp/0 Not tainted 6.8.0-rc6-dsa+ #57 Hardware name: IntelCorporation AvenueCity/AvenueCity, BIOS BHSDCRB1.86B.2492.D03.230718162007/18/2023 RIP: 0010:mutex_lock+0x2e/0x50 ... Call Trace: <TASK>__die+0x24/0x70 page_fault_oops+0x82/0x160 do_user_addr_fault+0x65/0x6b0__pfx___rdmsr_safe_on_cpu+0x10/0x10 exc_page_fault+0x7d/0x170asm_exc_page_fault+0x26/0x30 mutex_lock+0x2e/0x50 mutex_lock+0x1e/0x50perf_pmu_migrate_context+0x87/0x1f0 perf_event_cpu_offline+0x76/0x90 [idxd]cpuhp_invoke_callback+0xa2/0x4f0 __pfx_perf_event_cpu_offline+0x10/0x10[idxd] cpuhp_thread_fun+0x98/0x150 smpboot_thread_fn+0x27/0x260smpboot_thread_fn+0x1af/0x260 __pfx_smpboot_thread_fn+0x10/0x10kthread+0x103/0x140 __pfx_kthread+0x10/0x10 ret_from_fork+0x31/0x50__pfx_kthread+0x10/0x10 ret_from_fork_asm+0x1b/0x30 <TASK> Fix the issue bypreventing the migration of the perf context to an invalid target.",
		"affected": {
			"family": "unix",
			"platform": "Ubuntu 24.04 LTS"
		},
		"reference": {
			"source": "CVE",
			"ref_id": "CVE-2024-35989",
			"ref_url": "https://www.cve.org/CVERecord?id=CVE-2024-35989"
		},
		"advisory": {
			"severity": "Medium",
			"rights": "Copyright (C) 2024 Canonical Ltd.",
			"public_date": "2024-05-20 10:15:00 UTC",
			"cve": {
				"text": "CVE-2024-35989",
				"href": "https://ubuntu.com/security/CVE-2024-35989",
				"public": "20240520"
			}
		}
	},
	"notes": {},
	"criteria": {
		"criterias": [
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201245420000000",
						"comment": "linux package in noble is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201245420000010",
						"comment": "linux-aws package in noble is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201245420000030",
						"comment": "linux-azure package in noble is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201245420000040",
						"comment": "linux-gcp package in noble is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201245420000020",
						"comment": "linux-gke package in noble is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201245420000070",
						"comment": "linux-ibm package in noble is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201245420000080",
						"comment": "linux-lowlatency package in noble is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201245420000050",
						"comment": "linux-oracle package in noble is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201245420000060",
						"comment": "linux-raspi package in noble is affected and may need fixing."
					}
				]
			}
		]
	}
}
