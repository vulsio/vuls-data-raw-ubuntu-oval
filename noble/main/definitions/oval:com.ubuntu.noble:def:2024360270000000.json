{
	"class": "vulnerability",
	"id": "oval:com.ubuntu.noble:def:2024360270000000",
	"version": "1",
	"metadata": {
		"title": "CVE-2024-36027 on Ubuntu 24.04 LTS (noble) - medium",
		"description": "In the Linux kernel, the following vulnerability has been resolved:btrfs: zoned: do not flag ZEROOUT on non-dirty extent bufferBtrfs clears the content of an extent buffer marked asEXTENT_BUFFER_ZONED_ZEROOUT before the bio submission. This mechanism isintroduced to prevent a write hole of an extent buffer, which is onceallocated, marked dirty, but turns out unnecessary and cleaned up withinone transaction operation.Currently, btrfs_clear_buffer_dirty() marks the extent buffer asEXTENT_BUFFER_ZONED_ZEROOUT, and skips the entry function. If this callhappens while the buffer is under IO (with the WRITEBACK flag set,without the DIRTY flag), we can add the ZEROOUT flag and clear thebuffer's content just before a bio submission. As a result:1) it can lead to adding faulty delayed reference item which leads to a   FS corrupted (EUCLEAN) error, and2) it writes out cleared tree node on diskThe former issue is previously discussed in [1]. The corruption happenswhen it runs a delayed reference update. So, on-disk data is safe.[1]https://lore.kernel.org/linux-btrfs/3f4f2a0ff1a6c818050434288925bdcf3cd719e5.1709124777.git.naohiro.aota@wdc.com/The latter one can reach on-disk data. But, as that node is alreadyprocessed by btrfs_clear_buffer_dirty(), that will be invalidated in thenext transaction commit anyway. So, the chance of hitting the corruptionis relatively small.Anyway, we should skip flagging ZEROOUT on a non-DIRTY extent buffer, tokeep the content under IO intact.",
		"affected": {
			"family": "unix",
			"platform": "Ubuntu 24.04 LTS"
		},
		"reference": {
			"source": "CVE",
			"ref_id": "CVE-2024-36027",
			"ref_url": "https://www.cve.org/CVERecord?id=CVE-2024-36027"
		},
		"advisory": {
			"severity": "Medium",
			"rights": "Copyright (C) 2024 Canonical Ltd.",
			"public_date": "2024-05-30 16:15:00 UTC",
			"cve": {
				"text": "CVE-2024-36027",
				"href": "https://ubuntu.com/security/CVE-2024-36027",
				"public": "20240530"
			}
		}
	},
	"notes": {},
	"criteria": {
		"criterias": [
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201245420000000",
						"comment": "linux package in noble is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201245420000010",
						"comment": "linux-aws package in noble is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201245420000030",
						"comment": "linux-azure package in noble is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201245420000040",
						"comment": "linux-gcp package in noble is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201245420000020",
						"comment": "linux-gke package in noble is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201245420000070",
						"comment": "linux-ibm package in noble is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201245420000080",
						"comment": "linux-lowlatency package in noble is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201245420000050",
						"comment": "linux-oracle package in noble is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201245420000060",
						"comment": "linux-raspi package in noble is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.noble:tst:201245420000090",
						"comment": "linux-oem-6.8 package in noble is affected and may need fixing."
					}
				]
			}
		]
	}
}
