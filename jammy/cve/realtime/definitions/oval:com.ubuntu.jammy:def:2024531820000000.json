{
	"class": "vulnerability",
	"id": "oval:com.ubuntu.jammy:def:2024531820000000",
	"version": "1",
	"metadata": {
		"title": "CVE-2024-53182 on Ubuntu 22.04 LTS (jammy) - medium",
		"description": "In the Linux kernel, the following vulnerability has been resolved:Revert \"block, bfq: merge bfq_release_process_ref() intobfq_put_cooperator()\"This reverts commit bc3b1e9e7c50e1de0f573eea3871db61dd4787de.The bic is associated with sync_bfqq, and bfq_release_process_ref cannotbe put into bfq_put_cooperator.kasan report:[  400.347277]==================================================================[  400.347287] BUG: KASAN: slab-use-after-free in bic_set_bfqq+0x200/0x230[  400.347420] Read of size 8 at addr ffff88881cab7d60 by task dockerd/5800[  400.347430][  400.347436] CPU: 24 UID: 0 PID: 5800 Comm: dockerd Kdump: loadedTainted: G E 6.12.0 #32[  400.347450] Tainted: [E]=UNSIGNED_MODULE[  400.347454] Hardware name: VMware, Inc. VMware20,1/440BX DesktopReference Platform, BIOS VMW201.00V.20192059.B64.2207280713 07/28/2022[  400.347460] Call Trace:[  400.347464]  <TASK>[  400.347468]  dump_stack_lvl+0x5d/0x80[  400.347490]  print_report+0x174/0x505[  400.347521]  kasan_report+0xe0/0x160[  400.347541]  bic_set_bfqq+0x200/0x230[  400.347549]  bfq_bic_update_cgroup+0x419/0x740[  400.347560]  bfq_bio_merge+0x133/0x320[  400.347584]  blk_mq_submit_bio+0x1761/0x1e20[  400.347625]  __submit_bio+0x28b/0x7b0[  400.347664]  submit_bio_noacct_nocheck+0x6b2/0xd30[  400.347690]  iomap_readahead+0x50c/0x680[  400.347731]  read_pages+0x17f/0x9c0[  400.347785]  page_cache_ra_unbounded+0x366/0x4a0[  400.347795]  filemap_fault+0x83d/0x2340[  400.347819]  __xfs_filemap_fault+0x11a/0x7d0 [xfs][  400.349256]  __do_fault+0xf1/0x610[  400.349270]  do_fault+0x977/0x11a0[  400.349281]  __handle_mm_fault+0x5d1/0x850[  400.349314]  handle_mm_fault+0x1f8/0x560[  400.349324]  do_user_addr_fault+0x324/0x970[  400.349337]  exc_page_fault+0x76/0xf0[  400.349350]  asm_exc_page_fault+0x26/0x30[  400.349360] RIP: 0033:0x55a480d77375[  400.349384] Code: cc cc cc cc cc cc cc cc cc cc cc cc cc cc cc cc cc cccc cc cc 49 3b 66 10 0f 86 ae 02 00 00 55 48 89 e5 48 83 ec 58 48 8b 10<83> 7a 10 00 0f 84 27 02 00 00 44 0f b6 42 28 44 0f b6 4a 29 41 80[  400.349392] RSP: 002b:00007f18c37fd8b8 EFLAGS: 00010216[  400.349401] RAX: 00007f18c37fd9d0 RBX: 0000000000000000 RCX:0000000000000000[  400.349407] RDX: 000055a484407d38 RSI: 000000c000e8b0c0 RDI:0000000000000000[  400.349412] RBP: 00007f18c37fd910 R08: 000055a484017f60 R09:000055a484066f80[  400.349417] R10: 0000000000194000 R11: 0000000000000005 R12:0000000000000008[  400.349422] R13: 0000000000000000 R14: 000000c000476a80 R15:0000000000000000[  400.349430]  </TASK>[  400.349452][  400.349454] Allocated by task 5800:[  400.349459]  kasan_save_stack+0x30/0x50[  400.349469]  kasan_save_track+0x14/0x30[  400.349475]  __kasan_slab_alloc+0x89/0x90[  400.349482]  kmem_cache_alloc_node_noprof+0xdc/0x2a0[  400.349492]  bfq_get_queue+0x1ef/0x1100[  400.349502]  __bfq_get_bfqq_handle_split+0x11a/0x510[  400.349511]  bfq_insert_requests+0xf55/0x9030[  400.349519]  blk_mq_flush_plug_list+0x446/0x14c0[  400.349527]  __blk_flush_plug+0x27c/0x4e0[  400.349534]  blk_finish_plug+0x52/0xa0[  400.349540]  _xfs_buf_ioapply+0x739/0xc30 [xfs][  400.350246]  __xfs_buf_submit+0x1b2/0x640 [xfs][  400.350967]  xfs_buf_read_map+0x306/0xa20 [xfs][  400.351672]  xfs_trans_read_buf_map+0x285/0x7d0 [xfs][  400.352386]  xfs_imap_to_bp+0x107/0x270 [xfs][  400.353077]  xfs_iget+0x70d/0x1eb0 [xfs][  400.353786]  xfs_lookup+0x2ca/0x3a0 [xfs][  400.354506]  xfs_vn_lookup+0x14e/0x1a0 [xfs][  400.355197]  __lookup_slow+0x19c/0x340[  400.355204]  lookup_one_unlocked+0xfc/0x120[  400.355211]  ovl_lookup_single+0x1b3/0xcf0 [overlay][  400.355255]  ovl_lookup_layer+0x316/0x490 [overlay][  400.355295]  ovl_lookup+0x844/0x1fd0 [overlay][  400.355351]  lookup_one_qstr_excl+0xef/0x150[  400.355357]  do_unlinkat+0x22a/0x620[  400.355366]  __x64_sys_unlinkat+0x109/0x1e0[  400.355375]  do_syscall_64+0x82/0x160[  400.355384]  entry_SYSCALL_64_after_hwframe+0x76/0x7---truncated---\n\n    Update Instructions:\n\n    Run `sudo pro fix CVE-2024-53182` to fix the vulnerability. The problem can be corrected\n    by updating your system to the following package versions:\n\nlinux-image-5.13.0-19-generic - 5.13.0-19.19\nlinux-image-5.13.0-19-generic-lpae - 5.13.0-19.19\nlinux-image-unsigned-5.13.0-19-generic - 5.13.0-19.19\nlinux-image-unsigned-5.13.0-19-generic-64k - 5.13.0-19.19\nlinux-image-unsigned-5.13.0-19-lowlatency - 5.13.0-19.19\nNo subscription required\n\nlinux-image-unsigned-5.13.0-1004-kvm - 5.13.0-1004.4\nNo subscription required\n\nlinux-image-5.13.0-1005-aws - 5.13.0-1005.6\nNo subscription required\n\nlinux-image-unsigned-5.13.0-1006-azure - 5.13.0-1006.7\nNo subscription required\n\nlinux-image-unsigned-5.15.0-1019-azure-fde - 5.15.0-1019.24.1\nNo subscription required\n\nlinux-image-unsigned-5.13.0-1005-gcp - 5.13.0-1005.6\nNo subscription required\n\nlinux-image-unsigned-5.15.0-1002-gke - 5.15.0-1002.2\nNo subscription required\n\nlinux-image-unsigned-5.15.0-1001-gkeop - 5.15.0-1001.2\nNo subscription required\n\nlinux-image-unsigned-5.15.0-1002-ibm - 5.15.0-1002.2\nNo subscription required\n\nlinux-image-unsigned-5.15.0-1004-intel-iotg - 5.15.0-1004.6\nNo subscription required\n\nlinux-image-unsigned-5.15.0-1021-intel-iot-realtime - 5.15.0-1021.26\nAvailable with Ubuntu Pro: https://ubuntu.com/pro\n\nlinux-image-unsigned-5.15.0-22-lowlatency - 5.15.0-22.22\nlinux-image-unsigned-5.15.0-22-lowlatency-64k - 5.15.0-22.22\nNo subscription required\n\nlinux-image-unsigned-5.15.0-1005-nvidia - 5.15.0-1005.5\nlinux-image-unsigned-5.15.0-1005-nvidia-64k - 5.15.0-1005.5\nNo subscription required\n\nlinux-image-unsigned-5.13.0-1008-oracle - 5.13.0-1008.10\nNo subscription required\n\nlinux-image-5.13.0-1008-raspi - 5.13.0-1008.9\nlinux-image-5.13.0-1008-raspi-nolpae - 5.13.0-1008.9\nNo subscription required\n\nlinux-image-5.15.0-1006-realtime - 5.15.0-1006.6\nAvailable with Ubuntu Pro: https://ubuntu.com/pro\n\nlinux-image-5.15.0-1022-xilinx-zynqmp - 5.15.0-1022.26\nNo subscription required",
		"affected": {
			"family": "unix",
			"platform": "Ubuntu 22.04 LTS"
		},
		"reference": {
			"source": "CVE",
			"ref_id": "CVE-2024-53182",
			"ref_url": "https://www.cve.org/CVERecord?id=CVE-2024-53182"
		},
		"advisory": {
			"severity": "Medium",
			"rights": "Copyright (C) 2024 Canonical Ltd.",
			"public_date": "2024-12-27 14:15:00 UTC",
			"cve": {
				"text": "CVE-2024-53182",
				"href": "https://ubuntu.com/security/CVE-2024-53182",
				"public": "20241227"
			}
		}
	},
	"notes": {},
	"criteria": {
		"criterias": [
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201431800000000",
						"comment": "linux package in jammy, is related to the CVE in some way and has been fixed (note: '5.13.0-19.19')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000160",
						"comment": "linux-hwe-5.19: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-hwe-6.2')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000270",
						"comment": "linux-hwe-6.2: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-hwe-6.5')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000350",
						"comment": "linux-hwe-6.5: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-hwe-6.8')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201431800000010",
						"comment": "linux-kvm package in jammy, is related to the CVE in some way and has been fixed (note: '5.13.0-1004.4')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000240",
						"comment": "linux-allwinner-5.19: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of kernel support')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201431800000020",
						"comment": "linux-aws package in jammy, is related to the CVE in some way and has been fixed (note: '5.13.0-1005.6')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000220",
						"comment": "linux-aws-5.19: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-aws-6.2')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000260",
						"comment": "linux-aws-6.2: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-aws-6.5')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000380",
						"comment": "linux-aws-6.5: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-aws-6.8')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201431800000030",
						"comment": "linux-azure package in jammy, is related to the CVE in some way and has been fixed (note: '5.13.0-1006.7')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000180",
						"comment": "linux-azure-5.19: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-azure-6.2')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000300",
						"comment": "linux-azure-6.2: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-azure-6.5')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000390",
						"comment": "linux-azure-6.5: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-azure-6.8')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201431800000060",
						"comment": "linux-azure-fde package in jammy, is related to the CVE in some way and has been fixed (note: '5.15.0-1019.24.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000190",
						"comment": "linux-azure-fde-5.19: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-azure-fde-6.2')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000310",
						"comment": "linux-azure-fde-6.2: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'replaced by linux-azure-6.5')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201431800000040",
						"comment": "linux-gcp package in jammy, is related to the CVE in some way and has been fixed (note: '5.13.0-1005.6')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000230",
						"comment": "linux-gcp-5.19: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-gcp-6.2')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000290",
						"comment": "linux-gcp-6.2: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-gcp-6.5')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000400",
						"comment": "linux-gcp-6.5: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-gcp-6.8')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201431800000070",
						"comment": "linux-gke package in jammy, is related to the CVE in some way and has been fixed (note: '5.15.0-1002.2')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201431800000080",
						"comment": "linux-gkeop package in jammy, is related to the CVE in some way and has been fixed (note: '5.15.0-1001.2')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201431800000090",
						"comment": "linux-ibm package in jammy, is related to the CVE in some way and has been fixed (note: '5.15.0-1002.2')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201431800000100",
						"comment": "linux-intel-iotg package in jammy, is related to the CVE in some way and has been fixed (note: '5.15.0-1004.6')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201431800000110",
						"comment": "linux-intel-iot-realtime package in realtime/jammy, is related to the CVE in some way and has been fixed (note: '5.15.0-1021.26')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201431800000120",
						"comment": "linux-lowlatency package in jammy, is related to the CVE in some way and has been fixed (note: '5.15.0-22.22')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000170",
						"comment": "linux-lowlatency-hwe-5.19: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-lowlatency-hwe-6.2')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000280",
						"comment": "linux-lowlatency-hwe-6.2: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-lowlatency-hwe-6.5')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000360",
						"comment": "linux-lowlatency-hwe-6.5: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-lowlatency-hwe-6.8')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201431800000130",
						"comment": "linux-nvidia package in jammy, is related to the CVE in some way and has been fixed (note: '5.15.0-1005.5')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000320",
						"comment": "linux-nvidia-6.2: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-nvidia-6.5')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000420",
						"comment": "linux-nvidia-6.5: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-nvidia-6.8')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201431800000050",
						"comment": "linux-oracle package in jammy, is related to the CVE in some way and has been fixed (note: '5.13.0-1008.10')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000410",
						"comment": "linux-oracle-6.5: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-oracle-6.8')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000120",
						"comment": "linux-oem-5.17: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-oem-6.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000140",
						"comment": "linux-oem-6.0: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-oem-6.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000150",
						"comment": "linux-oem-6.1: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-oem-6.5')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000340",
						"comment": "linux-oem-6.5: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-oem-6.8')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201431800000140",
						"comment": "linux-raspi package in jammy, is related to the CVE in some way and has been fixed (note: '5.13.0-1008.9')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201431800000150",
						"comment": "linux-realtime package in realtime/jammy, is related to the CVE in some way and has been fixed (note: '5.15.0-1006.6')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000250",
						"comment": "linux-starfive-5.19: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of kernel support')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000330",
						"comment": "linux-starfive-6.2: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-starfive-6.5')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000370",
						"comment": "linux-starfive-6.5: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of kernel support')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201431800000160",
						"comment": "linux-xilinx-zynqmp package in jammy, is related to the CVE in some way and has been fixed (note: '5.15.0-1022.26')."
					}
				]
			}
		]
	}
}
