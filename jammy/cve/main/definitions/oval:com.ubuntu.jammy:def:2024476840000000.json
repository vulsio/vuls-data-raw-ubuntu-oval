{
	"class": "vulnerability",
	"id": "oval:com.ubuntu.jammy:def:2024476840000000",
	"version": "1",
	"metadata": {
		"title": "CVE-2024-47684 on Ubuntu 22.04 LTS (jammy) - medium",
		"description": "In the Linux kernel, the following vulnerability has been resolved:tcp: check skb is non-NULL in tcp_rto_delta_us()We have some machines running stock Ubuntu 20.04.6 which is their5.4.0-174-generickernel that are running ceph and recently hit a null ptr dereference intcp_rearm_rto(). Initially hitting it from the TLP path, but then later wealsosaw it getting hit from the RACK case as well. Here are examples of theoopsmessages we saw in each of those cases:Jul 26 15:05:02 rx [11061395.780353] BUG: kernel NULL pointer dereference,address: 0000000000000020Jul 26 15:05:02 rx [11061395.787572] #PF: supervisor read access in kernelmodeJul 26 15:05:02 rx [11061395.792971] #PF: error_code(0x0000) - not-presentpageJul 26 15:05:02 rx [11061395.798362] PGD 0 P4D 0Jul 26 15:05:02 rx [11061395.801164] Oops: 0000 [#1] SMP NOPTIJul 26 15:05:02 rx [11061395.805091] CPU: 0 PID: 9180 Comm: msgr-worker-1Tainted: G W 5.4.0-174-generic #193-UbuntuJul 26 15:05:02 rx [11061395.814996] Hardware name: Supermicro SMC 2x26os-gen8 64C NVME-Y 256G/H12SSW-NTR, BIOS 2.5.V1.2U.NVMe.UEFI 05/09/2023Jul 26 15:05:02 rx [11061395.825952] RIP: 0010:tcp_rearm_rto+0xe4/0x160Jul 26 15:05:02 rx [11061395.830656] Code: 87 ca 04 00 00 00 5b 41 5c 41 5d5d c3 c3 49 8b bc 24 40 06 00 00 eb 8d 48 bb cf f7 53 e3 a5 9b c4 20 4c 89ef e8 0c fe 0e 00 <48> 8b 78 20 48 c1 ef 03 48 89 f8 41 8b bc 24 80 04 0000 48 f7 e3Jul 26 15:05:02 rx [11061395.849665] RSP: 0018:ffffb75d40003e08 EFLAGS:00010246Jul 26 15:05:02 rx [11061395.855149] RAX: 0000000000000000 RBX:20c49ba5e353f7cf RCX: 0000000000000000Jul 26 15:05:02 rx [11061395.862542] RDX: 0000000062177c30 RSI:000000000000231c RDI: ffff9874ad283a60Jul 26 15:05:02 rx [11061395.869933] RBP: ffffb75d40003e20 R08:0000000000000000 R09: ffff987605e20aa8Jul 26 15:05:02 rx [11061395.877318] R10: ffffb75d40003f00 R11:ffffb75d4460f740 R12: ffff9874ad283900Jul 26 15:05:02 rx [11061395.884710] R13: ffff9874ad283a60 R14:ffff9874ad283980 R15: ffff9874ad283d30Jul 26 15:05:02 rx [11061395.892095] FS: 00007f1ef4a2e700(0000)GS:ffff987605e00000(0000) knlGS:0000000000000000Jul 26 15:05:02 rx [11061395.900438] CS: 0010 DS: 0000 ES: 0000 CR0:0000000080050033Jul 26 15:05:02 rx [11061395.906435] CR2: 0000000000000020 CR3:0000003e450ba003 CR4: 0000000000760ef0Jul 26 15:05:02 rx [11061395.913822] PKRU: 55555554Jul 26 15:05:02 rx [11061395.916786] Call Trace:Jul 26 15:05:02 rx [11061395.919488]Jul 26 15:05:02 rx [11061395.921765] ? show_regs.cold+0x1a/0x1fJul 26 15:05:02 rx [11061395.925859] ? __die+0x90/0xd9Jul 26 15:05:02 rx [11061395.929169] ? no_context+0x196/0x380Jul 26 15:05:02 rx [11061395.933088] ? ip6_protocol_deliver_rcu+0x4e0/0x4e0Jul 26 15:05:02 rx [11061395.938216] ? ip6_sublist_rcv_finish+0x3d/0x50Jul 26 15:05:02 rx [11061395.943000] ? __bad_area_nosemaphore+0x50/0x1a0Jul 26 15:05:02 rx [11061395.947873] ? bad_area_nosemaphore+0x16/0x20Jul 26 15:05:02 rx [11061395.952486] ? do_user_addr_fault+0x267/0x450Jul 26 15:05:02 rx [11061395.957104] ? ipv6_list_rcv+0x112/0x140Jul 26 15:05:02 rx [11061395.961279] ? __do_page_fault+0x58/0x90Jul 26 15:05:02 rx [11061395.965458] ? do_page_fault+0x2c/0xe0Jul 26 15:05:02 rx [11061395.969465] ? page_fault+0x34/0x40Jul 26 15:05:02 rx [11061395.973217] ? tcp_rearm_rto+0xe4/0x160Jul 26 15:05:02 rx [11061395.977313] ? tcp_rearm_rto+0xe4/0x160Jul 26 15:05:02 rx [11061395.981408] tcp_send_loss_probe+0x10b/0x220Jul 26 15:05:02 rx [11061395.985937] tcp_write_timer_handler+0x1b4/0x240Jul 26 15:05:02 rx [11061395.990809] tcp_write_timer+0x9e/0xe0Jul 26 15:05:02 rx [11061395.994814] ? tcp_write_timer_handler+0x240/0x240Jul 26 15:05:02 rx [11061395.999866] call_timer_fn+0x32/0x130Jul 26 15:05:02 rx [11061396.003782] __run_timers.part.0+0x180/0x280Jul 26 15:05:02 rx [11061396.008309] ? recalibrate_cpu_khz+0x10/0x10Jul 26 15:05:02 rx [11061396.012841] ? native_x2apic_icr_write+0x30/0x30Jul 26 15:05:02 rx [11061396.017718] ? lapic_next_even---truncated---",
		"affected": {
			"family": "unix",
			"platform": "Ubuntu 22.04 LTS"
		},
		"reference": {
			"source": "CVE",
			"ref_id": "CVE-2024-47684",
			"ref_url": "https://www.cve.org/CVERecord?id=CVE-2024-47684"
		},
		"advisory": {
			"severity": "Medium",
			"rights": "Copyright (C) 2024 Canonical Ltd.",
			"public_date": "2024-10-21 12:15:00 UTC",
			"cve": {
				"text": "CVE-2024-47684",
				"href": "https://ubuntu.com/security/CVE-2024-47684",
				"public": "20241021",
				"cvss_score": "5.5",
				"cvss_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H"
			}
		}
	},
	"notes": {},
	"criteria": {
		"criterias": [
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000000",
						"comment": "linux package in jammy is affected. An update containing the fix has been completed and is pending publication (note: '5.15.0-127.137')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000160",
						"comment": "linux-hwe-5.19: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-hwe-6.2')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000270",
						"comment": "linux-hwe-6.2: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-hwe-6.5')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000350",
						"comment": "linux-hwe-6.5: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-hwe-6.8')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000050",
						"comment": "linux-kvm package in jammy is affected and needs fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000240",
						"comment": "linux-allwinner-5.19: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of kernel support')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000010",
						"comment": "linux-aws package in jammy is affected. An update containing the fix has been completed and is pending publication (note: '5.15.0-1073.79')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000220",
						"comment": "linux-aws-5.19: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-aws-6.2')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000260",
						"comment": "linux-aws-6.2: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-aws-6.5')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000380",
						"comment": "linux-aws-6.5: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-aws-6.8')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000030",
						"comment": "linux-azure package in jammy is affected. An update containing the fix has been completed and is pending publication (note: '5.15.0-1076.85')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000180",
						"comment": "linux-azure-5.19: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-azure-6.2')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000300",
						"comment": "linux-azure-6.2: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-azure-6.5')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000390",
						"comment": "linux-azure-6.5: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-azure-6.8')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000100",
						"comment": "linux-azure-fde package in jammy is affected and needs fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000190",
						"comment": "linux-azure-fde-5.19: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-azure-fde-6.2')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000310",
						"comment": "linux-azure-fde-6.2: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'replaced by linux-azure-6.5')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000040",
						"comment": "linux-gcp package in jammy is affected and needs fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000230",
						"comment": "linux-gcp-5.19: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-gcp-6.2')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000290",
						"comment": "linux-gcp-6.2: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-gcp-6.5')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000400",
						"comment": "linux-gcp-6.5: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-gcp-6.8')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000020",
						"comment": "linux-gke package in jammy is affected and needs fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000080",
						"comment": "linux-gkeop package in jammy is affected and needs fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000090",
						"comment": "linux-ibm package in jammy is affected. An update containing the fix has been completed and is pending publication (note: '5.15.0-1066.69')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000130",
						"comment": "linux-intel-iotg package in jammy is affected and needs fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000430",
						"comment": "linux-intel-iot-realtime package in jammy is affected and needs fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000110",
						"comment": "linux-lowlatency package in jammy is affected and needs fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000170",
						"comment": "linux-lowlatency-hwe-5.19: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-lowlatency-hwe-6.2')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000280",
						"comment": "linux-lowlatency-hwe-6.2: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-lowlatency-hwe-6.5')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000360",
						"comment": "linux-lowlatency-hwe-6.5: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-lowlatency-hwe-6.8')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000210",
						"comment": "linux-nvidia package in jammy is affected and needs fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000320",
						"comment": "linux-nvidia-6.2: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-nvidia-6.5')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000420",
						"comment": "linux-nvidia-6.5: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-nvidia-6.8')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000060",
						"comment": "linux-oracle package in jammy is affected. An update containing the fix has been completed and is pending publication (note: '5.15.0-1071.77')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000410",
						"comment": "linux-oracle-6.5: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-oracle-6.8')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000120",
						"comment": "linux-oem-5.17: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-oem-6.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000140",
						"comment": "linux-oem-6.0: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-oem-6.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000150",
						"comment": "linux-oem-6.1: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-oem-6.5')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000340",
						"comment": "linux-oem-6.5: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-oem-6.8')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000070",
						"comment": "linux-raspi package in jammy is affected. An update containing the fix has been completed and is pending publication (note: '5.15.0-1066.69')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000440",
						"comment": "linux-realtime package in jammy is affected and needs fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000250",
						"comment": "linux-starfive-5.19: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of kernel support')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000330",
						"comment": "linux-starfive-6.2: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-starfive-6.5')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000370",
						"comment": "linux-starfive-6.5: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of kernel support')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000200",
						"comment": "linux-xilinx-zynqmp package in jammy is affected and needs fixing."
					}
				]
			}
		]
	}
}
