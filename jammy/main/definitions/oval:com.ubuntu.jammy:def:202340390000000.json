{
  "class": "vulnerability",
  "id": "oval:com.ubuntu.jammy:def:202340390000000",
  "version": "1",
  "metadata": {
    "Title": "CVE-2023-4039 on Ubuntu 22.04 LTS (jammy) - medium.",
    "Description": "A failure in the -fstack-protector feature in GCC-based toolchains that target AArch64 allows an attacker to exploit an existing buffer overflow in dynamically-sized local variables in your application without this being detected. This stack-protector failure only applies to C99-style dynamically-sized local variables or those created using alloca(). The stack-protector operates as intended for statically-sized local variables. The default behavior when the stack-protector detects an overflow is to terminate your application, resulting in controlled loss of availability. An attacker who can exploit a buffer overflow without triggering the stack-protector might be able to change program flow control to cause an uncontrolled loss of availability or to go further and affect confidentiality or integrity.",
    "affected": {
      "family": "unix",
      "Platform": "Ubuntu 22.04 LTS"
    },
    "reference": {
      "source": "CVE",
      "ref_id": "CVE-2023-4039",
      "ref_url": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-4039"
    },
    "advisory": {
      "Severity": "Medium",
      "Rights": "Copyright (C) 2023 Canonical Ltd.",
      "PublicDate": "2023-09-12 15:00:00 UTC",
      "Bug": null,
      "cve": {
        "text": "CVE-2023-4039",
        "href": "https://ubuntu.com/security/CVE-2023-4039",
        "public": "20230912",
        "cvss_score": "4.8",
        "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:N"
      },
      "PublicDateAtUsn": "",
      "AssignedTo": "",
      "DiscoveredBy": "",
      "Crd": "2023-09-12 15:00:00 UTC",
      "Ref": null
    }
  },
  "notes": {
    "Note": "sbeattie> gcc-3.3 only provides libstdc++5 alexmurray> patches are expected to be provided for upstream versions 11, 12, 13 and trunk Any possible package on arm64 in Ubuntu could be affected by this and would therefore need to be recompiled by a new version of gcc containing this fix - however, performing a whole-of-archive rebuild is not feasible. It might be possible to detect which packages need to be rebuilt by looking for those with the -fstack-clash-protection mitigation via hardening-check (as since Ubuntu 20.04 LTS nearly all packages are compiled with this by default). This is still likely to be quite a large subset of the archive and still not feasible to rebuild. Instead as regular security / SRU updates are performed for packages, they will opportunistically receive this fix. sbeattie> 14.04 LTS (trusty) Pro Infra and 16.04 LTS (xenial) Pro Infra do not support Arm64 as an architecture."
  },
  "criteria": {
    "criterias": [
      {
        "operator": "OR",
        "criterions": [
          {
            "test_ref": "oval:com.ubuntu.jammy:tst:202340390000000",
            "comment": "gcc-10 package in jammy is affected and may need fixing."
          },
          {
            "test_ref": "oval:com.ubuntu.jammy:tst:202340390000010",
            "comment": "gcc-10-cross package in jammy is affected and may need fixing."
          },
          {
            "test_ref": "oval:com.ubuntu.jammy:tst:202340390000020",
            "comment": "gcc-10-cross-mipsen package in jammy is affected and may need fixing."
          },
          {
            "test_ref": "oval:com.ubuntu.jammy:tst:202340390000030",
            "comment": "gcc-10-cross-ports package in jammy is affected and may need fixing."
          },
          {
            "test_ref": "oval:com.ubuntu.jammy:tst:202138260000010",
            "comment": "gcc-11 package in jammy is affected and may need fixing."
          },
          {
            "test_ref": "oval:com.ubuntu.jammy:tst:202340390000050",
            "comment": "gcc-11-cross package in jammy is affected and may need fixing."
          },
          {
            "test_ref": "oval:com.ubuntu.jammy:tst:202340390000060",
            "comment": "gcc-11-cross-ports package in jammy is affected and may need fixing."
          },
          {
            "test_ref": "oval:com.ubuntu.jammy:tst:2022279430000020",
            "comment": "gcc-12 package in jammy is affected and may need fixing."
          },
          {
            "test_ref": "oval:com.ubuntu.jammy:tst:202340390000080",
            "comment": "gcc-12-cross package in jammy is affected and may need fixing."
          },
          {
            "test_ref": "oval:com.ubuntu.jammy:tst:202340390000090",
            "comment": "gcc-12-cross-ports package in jammy is affected and may need fixing."
          },
          {
            "test_ref": "oval:com.ubuntu.jammy:tst:202340390000100",
            "comment": "gcc-9 package in jammy is affected and may need fixing."
          },
          {
            "test_ref": "oval:com.ubuntu.jammy:tst:2019158470000020",
            "comment": "gcc-9-cross package in jammy is affected and may need fixing."
          },
          {
            "test_ref": "oval:com.ubuntu.jammy:tst:202340390000120",
            "comment": "gcc-9-cross-mipsen package in jammy is affected and may need fixing."
          },
          {
            "test_ref": "oval:com.ubuntu.jammy:tst:2019158470000030",
            "comment": "gcc-9-cross-ports package in jammy is affected and may need fixing."
          },
          {
            "test_ref": "oval:com.ubuntu.jammy:tst:200224390000000",
            "comment": "gcc-arm-none-eabi package in jammy is affected and may need fixing."
          },
          {
            "test_ref": "oval:com.ubuntu.jammy:tst:2017116710000020",
            "comment": "gcc-avr package in jammy is affected and may need fixing."
          },
          {
            "test_ref": "oval:com.ubuntu.jammy:tst:2019158470000040",
            "comment": "gcc-defaults package in jammy is affected and may need fixing."
          },
          {
            "test_ref": "oval:com.ubuntu.jammy:tst:200224390000010",
            "comment": "gcc-h8300-hms package in jammy is affected and may need fixing."
          },
          {
            "test_ref": "oval:com.ubuntu.jammy:tst:2017116710000040",
            "comment": "gcc-m68hc1x package in jammy is affected and may need fixing."
          },
          {
            "test_ref": "oval:com.ubuntu.jammy:tst:200224390000020",
            "comment": "gcc-mingw-w64 package in jammy is affected and may need fixing."
          },
          {
            "test_ref": "oval:com.ubuntu.jammy:tst:200224390000030",
            "comment": "gcc-msp430 package in jammy is affected and may need fixing."
          },
          {
            "test_ref": "oval:com.ubuntu.jammy:tst:2020138440000120",
            "comment": "gcc-opt package in jammy is affected and may need fixing."
          },
          {
            "test_ref": "oval:com.ubuntu.jammy:tst:202340390000220",
            "comment": "gcc-or1k-elf package in jammy is affected and may need fixing."
          },
          {
            "test_ref": "oval:com.ubuntu.jammy:tst:202340390000230",
            "comment": "gcc-riscv64-unknown-elf package in jammy is affected and may need fixing."
          },
          {
            "test_ref": "oval:com.ubuntu.jammy:tst:2018128860000020",
            "comment": "gcc-snapshot package in jammy is affected and may need fixing."
          },
          {
            "test_ref": "oval:com.ubuntu.jammy:tst:202340390000250",
            "comment": "gcc-xtensa-lx106 package in jammy is affected and may need fixing."
          }
        ]
      }
    ]
  }
}
