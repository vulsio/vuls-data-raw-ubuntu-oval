{
	"class": "vulnerability",
	"id": "oval:com.ubuntu.jammy:def:2024266200000000",
	"version": "1",
	"metadata": {
		"title": "CVE-2024-26620 on Ubuntu 22.04 LTS (jammy) - medium",
		"description": "In the Linux kernel, the following vulnerability has been resolved:s390/vfio-ap: always filter entire AP matrix The vfio_ap_mdev_filter_matrixfunction is called whenever a new adapter or domain is assigned to themdev. The purpose of the function is to update the guest's AP configurationby filtering the matrix of adapters and domains assigned to the mdev. Whenan adapter or domain is assigned, only the APQNs associated with the APIDof the new adapter or APQI of the new domain are inspected. If an APQN doesnot reference a queue device bound to the vfio_ap device driver, then it'sAPID will be filtered from the mdev's matrix when updating the guest's APconfiguration. Inspecting only the APID of the new adapter or APQI of thenew domain will result in passing AP queues through to a guest that are notbound to the vfio_ap device driver under certain circumstances. Considerthe following: guest's AP configuration (all also assigned to the mdev'smatrix): 14.0004 14.0005 14.0006 16.0004 16.0005 16.0006 unassign domain 4unbind queue 16.0005 assign domain 4 When domain 4 is re-assigned, sinceonly domain 4 will be inspected, the APQNs that will be examined will be:14.0004 16.0004 Since both of those APQNs reference queue devices that arebound to the vfio_ap device driver, nothing will get filtered from themdev's matrix when updating the guest's AP configuration. Consequently,queue 16.0005 will get passed through despite not being bound to thedriver. This violates the linux device model requirement that a guest shallonly be given access to devices bound to the device driver facilitatingtheir pass-through. To resolve this problem, every adapter and domainassigned to the mdev will be inspected when filtering the mdev's matrix.\n\n    Update Instructions:\n\n    Run `sudo pro fix CVE-2024-26620` to fix the vulnerability. The problem can be corrected\n    by updating your system to the following package versions:\n\nlinux-image-5.13.0-19-generic - 5.13.0-19.19\nlinux-image-5.13.0-19-generic-lpae - 5.13.0-19.19\nlinux-image-unsigned-5.13.0-19-generic - 5.13.0-19.19\nlinux-image-unsigned-5.13.0-19-generic-64k - 5.13.0-19.19\nlinux-image-unsigned-5.13.0-19-lowlatency - 5.13.0-19.19\nNo subscription required\n\nlinux-image-6.5.0-41-generic - 6.5.0-41.41~22.04.2\nlinux-image-unsigned-6.5.0-41-generic - 6.5.0-41.41~22.04.2\nlinux-image-unsigned-6.5.0-41-generic-64k - 6.5.0-41.41~22.04.2\nNo subscription required\n\nlinux-image-unsigned-5.13.0-1004-kvm - 5.13.0-1004.4\nNo subscription required\n\nlinux-image-5.13.0-1005-aws - 5.13.0-1005.6\nNo subscription required\n\nlinux-image-unsigned-5.13.0-1006-azure - 5.13.0-1006.7\nNo subscription required\n\nlinux-image-unsigned-6.5.0-1022-azure - 6.5.0-1022.23~22.04.1\nNo subscription required\n\nlinux-image-unsigned-5.15.0-1019-azure-fde - 5.15.0-1019.24.1\nNo subscription required\n\nlinux-image-unsigned-5.13.0-1005-gcp - 5.13.0-1005.6\nNo subscription required\n\nlinux-image-unsigned-6.5.0-1022-gcp - 6.5.0-1022.24~22.04.1\nNo subscription required\n\nlinux-image-unsigned-5.15.0-1002-gke - 5.15.0-1002.2\nNo subscription required\n\nlinux-image-unsigned-5.15.0-1001-gkeop - 5.15.0-1001.2\nNo subscription required\n\nlinux-image-unsigned-5.15.0-1002-ibm - 5.15.0-1002.2\nNo subscription required\n\nlinux-image-unsigned-5.15.0-1004-intel-iotg - 5.15.0-1004.6\nNo subscription required\n\nlinux-image-unsigned-5.15.0-22-lowlatency - 5.15.0-22.22\nlinux-image-unsigned-5.15.0-22-lowlatency-64k - 5.15.0-22.22\nNo subscription required\n\nlinux-image-unsigned-6.5.0-41-lowlatency - 6.5.0-41.41.1~22.04.1\nlinux-image-unsigned-6.5.0-41-lowlatency-64k - 6.5.0-41.41.1~22.04.1\nNo subscription required\n\nlinux-image-unsigned-5.15.0-1005-nvidia - 5.15.0-1005.5\nlinux-image-unsigned-5.15.0-1005-nvidia-64k - 5.15.0-1005.5\nNo subscription required\n\nlinux-image-unsigned-5.13.0-1008-oracle - 5.13.0-1008.10\nNo subscription required\n\nlinux-image-unsigned-6.5.0-1024-oracle - 6.5.0-1024.24~22.04.1\nlinux-image-unsigned-6.5.0-1024-oracle-64k - 6.5.0-1024.24~22.04.1\nNo subscription required\n\nlinux-image-unsigned-6.5.0-1024-oem - 6.5.0-1024.25\nNo subscription required\n\nlinux-image-5.13.0-1008-raspi - 5.13.0-1008.9\nlinux-image-5.13.0-1008-raspi-nolpae - 5.13.0-1008.9\nNo subscription required\n\nlinux-image-6.5.0-1015-starfive - 6.5.0-1015.16~22.04.1\nNo subscription required\n\nlinux-image-5.15.0-1022-xilinx-zynqmp - 5.15.0-1022.26\nNo subscription required\n\nlinux-image-unsigned-6.5.0-1021-nvidia - 6.5.0-1021.22\nlinux-image-unsigned-6.5.0-1021-nvidia-64k - 6.5.0-1021.22\nNo subscription required\n\nlinux-image-unsigned-5.15.0-1021-intel-iot-realtime - 5.15.0-1021.26\nAvailable with Ubuntu Pro: https://ubuntu.com/pro\n\nlinux-image-5.15.0-1006-realtime - 5.15.0-1006.6\nAvailable with Ubuntu Pro: https://ubuntu.com/pro",
		"affected": {
			"family": "unix",
			"platform": "Ubuntu 22.04 LTS"
		},
		"reference": {
			"source": "CVE",
			"ref_id": "CVE-2024-26620",
			"ref_url": "https://www.cve.org/CVERecord?id=CVE-2024-26620"
		},
		"advisory": {
			"severity": "Medium",
			"rights": "Copyright (C) 2024 Canonical Ltd.",
			"public_date": "2024-03-11 18:15:00 UTC",
			"cve": {
				"text": "CVE-2024-26620",
				"href": "https://ubuntu.com/security/CVE-2024-26620",
				"public": "20240311"
			},
			"public_date_at_usn": "2024-03-11 18:15:00 UTC",
			"ref": [
				"https://ubuntu.com/security/notices/USN-6818-1",
				"https://ubuntu.com/security/notices/USN-6819-1",
				"https://ubuntu.com/security/notices/USN-6818-2",
				"https://ubuntu.com/security/notices/USN-6819-2",
				"https://ubuntu.com/security/notices/USN-6819-3",
				"https://ubuntu.com/security/notices/USN-6818-3",
				"https://ubuntu.com/security/notices/USN-6818-4",
				"https://ubuntu.com/security/notices/USN-6819-4"
			]
		}
	},
	"notes": {},
	"criteria": {
		"criterias": [
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:2016107230000000",
						"comment": "linux package in jammy, is related to the CVE in some way and has been fixed (note: '5.13.0-19.19')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000160",
						"comment": "linux-hwe-5.19: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-hwe-6.2')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000270",
						"comment": "linux-hwe-6.2: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-hwe-6.5')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:2023524430000000",
						"comment": "linux-hwe-6.5 package in jammy was vulnerable but has been fixed (note: '6.5.0-41.41~22.04.2')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:2016107230000040",
						"comment": "linux-kvm package in jammy, is related to the CVE in some way and has been fixed (note: '5.13.0-1004.4')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000240",
						"comment": "linux-allwinner-5.19: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of kernel support')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:2016107230000010",
						"comment": "linux-aws package in jammy, is related to the CVE in some way and has been fixed (note: '5.13.0-1005.6')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000220",
						"comment": "linux-aws-5.19: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-aws-6.2')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000260",
						"comment": "linux-aws-6.2: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-aws-6.5')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000380",
						"comment": "linux-aws-6.5: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of life, was pending [6.5.0-1021.21~22.04.1]')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:2016107230000030",
						"comment": "linux-azure package in jammy, is related to the CVE in some way and has been fixed (note: '5.13.0-1006.7')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000180",
						"comment": "linux-azure-5.19: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-azure-6.2')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000300",
						"comment": "linux-azure-6.2: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-azure-6.5')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:2023524430000040",
						"comment": "linux-azure-6.5 package in jammy was vulnerable but has been fixed (note: '6.5.0-1022.23~22.04.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:2016107230000080",
						"comment": "linux-azure-fde package in jammy, is related to the CVE in some way and has been fixed (note: '5.15.0-1019.24.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000190",
						"comment": "linux-azure-fde-5.19: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-azure-fde-6.2')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000310",
						"comment": "linux-azure-fde-6.2: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'replaced by linux-azure-6.5')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:2016107230000010",
						"comment": "linux-gcp package in jammy, is related to the CVE in some way and has been fixed (note: '5.13.0-1005.6')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000230",
						"comment": "linux-gcp-5.19: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-gcp-6.2')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000290",
						"comment": "linux-gcp-6.2: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-gcp-6.5')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:2023524430000050",
						"comment": "linux-gcp-6.5 package in jammy was vulnerable but has been fixed (note: '6.5.0-1022.24~22.04.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:2016107230000020",
						"comment": "linux-gke package in jammy, is related to the CVE in some way and has been fixed (note: '5.15.0-1002.2')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:2016107230000070",
						"comment": "linux-gkeop package in jammy, is related to the CVE in some way and has been fixed (note: '5.15.0-1001.2')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:2016107230000020",
						"comment": "linux-ibm package in jammy, is related to the CVE in some way and has been fixed (note: '5.15.0-1002.2')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:2016107230000110",
						"comment": "linux-intel-iotg package in jammy, is related to the CVE in some way and has been fixed (note: '5.15.0-1004.6')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:2016107230000090",
						"comment": "linux-lowlatency package in jammy, is related to the CVE in some way and has been fixed (note: '5.15.0-22.22')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000170",
						"comment": "linux-lowlatency-hwe-5.19: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-lowlatency-hwe-6.2')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000280",
						"comment": "linux-lowlatency-hwe-6.2: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-lowlatency-hwe-6.5')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:2023524430000010",
						"comment": "linux-lowlatency-hwe-6.5 package in jammy was vulnerable but has been fixed (note: '6.5.0-41.41.1~22.04.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:2016107230000140",
						"comment": "linux-nvidia package in jammy, is related to the CVE in some way and has been fixed (note: '5.15.0-1005.5')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000320",
						"comment": "linux-nvidia-6.2: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-nvidia-6.5')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:2016107230000050",
						"comment": "linux-oracle package in jammy, is related to the CVE in some way and has been fixed (note: '5.13.0-1008.10')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:2023524430000060",
						"comment": "linux-oracle-6.5 package in jammy was vulnerable but has been fixed (note: '6.5.0-1024.24~22.04.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000120",
						"comment": "linux-oem-5.17: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-oem-6.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000140",
						"comment": "linux-oem-6.0: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-oem-6.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000150",
						"comment": "linux-oem-6.1: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-oem-6.5, was needs-triage')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:2023524430000020",
						"comment": "linux-oem-6.5 package in jammy was vulnerable but has been fixed (note: '6.5.0-1024.25')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:2016107230000060",
						"comment": "linux-raspi package in jammy, is related to the CVE in some way and has been fixed (note: '5.13.0-1008.9')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000250",
						"comment": "linux-starfive-5.19: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of kernel support')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201245420000330",
						"comment": "linux-starfive-6.2: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-starfive-6.5')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:2023524430000030",
						"comment": "linux-starfive-6.5 package in jammy was vulnerable but has been fixed (note: '6.5.0-1015.16~22.04.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:2016107230000130",
						"comment": "linux-xilinx-zynqmp package in jammy, is related to the CVE in some way and has been fixed (note: '5.15.0-1022.26')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:2023524430000070",
						"comment": "linux-nvidia-6.5 package in jammy was vulnerable but has been fixed (note: '6.5.0-1021.22')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:2016107230000250",
						"comment": "linux-intel-iot-realtime package in jammy, is related to the CVE in some way and has been fixed (note: '5.15.0-1021.26')."
					},
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:2016107230000260",
						"comment": "linux-realtime package in jammy, is related to the CVE in some way and has been fixed (note: '5.15.0-1006.6')."
					}
				]
			}
		]
	}
}
