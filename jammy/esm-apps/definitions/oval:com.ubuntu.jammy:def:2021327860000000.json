{
	"class": "vulnerability",
	"id": "oval:com.ubuntu.jammy:def:2021327860000000",
	"version": "1",
	"metadata": {
		"Title": "CVE-2021-32786 on Ubuntu 22.04 ESM (jammy) - medium",
		"Description": "mod_auth_openidc is an authentication/authorization module for the Apache2.x HTTP server that functions as an OpenID Connect Relying Party,authenticating users against an OpenID Connect Provider. In versions priorto 2.4.9, `oidc_validate_redirect_url()` does not parse URLs the same wayas most browsers do. As a result, this function can be bypassed and leadsto an Open Redirect vulnerability in the logout functionality. This bug hasbeen fixed in version 2.4.9 by replacing any backslash of the URL toredirect with slashes to address a particular breaking change between thedifferent specifications (RFC2396 / RFC3986 and WHATWG). As a workaround,this vulnerability can be mitigated by configuring `mod_auth_openidc` toonly allow redirection whose destination matches a given regularexpression.\n\n    Update Instructions:\n\n    Run `sudo pro fix CVE-2021-32786` to fix the vulnerability. The problem can be corrected\n    by updating your system to the following package versions:\n\nlibapache2-mod-auth-openidc - 2.4.9-1\nAvailable with Ubuntu Pro: https://ubuntu.com/pro",
		"affected": {
			"family": "unix",
			"Platform": "Ubuntu 22.04 ESM"
		},
		"reference": {
			"source": "CVE",
			"ref_id": "CVE-2021-32786",
			"ref_url": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-32786"
		},
		"advisory": {
			"Severity": "Medium",
			"Rights": "Copyright (C) 2021 Canonical Ltd.",
			"PublicDate": "2021-07-22 22:15:00 UTC",
			"Bug": null,
			"cve": {
				"text": "CVE-2021-32786",
				"href": "https://ubuntu.com/security/CVE-2021-32786",
				"public": "20210722",
				"cvss_score": "6.1",
				"cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N"
			},
			"PublicDateAtUsn": "",
			"AssignedTo": "",
			"DiscoveredBy": "",
			"Crd": "",
			"Ref": null
		}
	},
	"notes": {
		"Note": ""
	},
	"criteria": {
		"criterias": [
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:com.ubuntu.jammy:tst:201759920000000",
						"comment": "libapache2-mod-auth-openidc package in esm-apps/jammy, is related to the CVE in some way and has been fixed (note: '2.4.9-1')."
					}
				]
			}
		]
	}
}
