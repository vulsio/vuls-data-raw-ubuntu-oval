{
  "class": "vulnerability",
  "id": "oval:com.ubuntu.jammy:def:202304610000000",
  "version": "1",
  "metadata": {
    "Title": "CVE-2023-0461 on Ubuntu 22.04 ESM (jammy) - high.",
    "Description": "There is a use-after-free vulnerability in the Linux Kernel which can be exploited to achieve local privilege escalation. To reach the vulnerability kernel configuration flag CONFIG_TLS or CONFIG_XFRM_ESPINTCP has to be configured, but the operation does not require any privilege. There is a use-after-free bug of icsk_ulp_data of a struct inet_connection_sock. When CONFIG_TLS is enabled, user can install a tls context (struct tls_context) on a connected tcp socket. The context is not cleared if this socket is disconnected and reused as a listener. If a new socket is created from the listener, the context is inherited and vulnerable. The setsockopt TCP_ULP operation does not require any privilege. We recommend upgrading past commit 2c02d41d71f90a5168391b6a5f2954112ba2307c It was discovered that the Upper Level Protocol (ULP) subsystem in the Linux kernel did not properly handle sockets entering the LISTEN state in certain protocols, leading to a use-after-free vulnerability. A local attacker could use this to cause a denial of service (system crash) or possibly execute arbitrary code.\n\nUpdate Instructions:\n\nRun `sudo pro fix CVE-2023-0461` to fix the vulnerability. The problem can be corrected\nby updating your system to the following package versions:\n\nlinux-image-5.15.0-67-generic - 5.15.0-67.74\nlinux-image-5.15.0-67-generic-lpae - 5.15.0-67.74\nlinux-image-unsigned-5.15.0-67-generic - 5.15.0-67.74\nlinux-image-unsigned-5.15.0-67-generic-64k - 5.15.0-67.74\nNo subscription required\n\nlinux-image-unsigned-5.15.0-1031-aws - 5.15.0-1031.35\nNo subscription required\n\nlinux-image-unsigned-5.15.0-1034-azure - 5.15.0-1034.41\nNo subscription required\n\nlinux-image-unsigned-5.19.0-1021-azure - 5.19.0-1021.22~22.04.1\nNo subscription required\n\nlinux-image-unsigned-5.15.0-1051-azure-fde - 5.15.0-1034.41\nNo subscription required\n\nlinux-image-unsigned-5.15.0-1030-gcp - 5.15.0-1030.37\nNo subscription required\n\nlinux-image-unsigned-5.15.0-1028-gke - 5.15.0-1028.33\nNo subscription required\n\nlinux-image-unsigned-5.15.0-1016-gkeop - 5.15.0-1016.21\nNo subscription required\n\nlinux-image-5.19.0-35-generic - 5.19.0-35.36~22.04.1\nlinux-image-5.19.0-35-generic-lpae - 5.19.0-35.36~22.04.1\nlinux-image-unsigned-5.19.0-35-generic - 5.19.0-35.36~22.04.1\nlinux-image-unsigned-5.19.0-35-generic-64k - 5.19.0-35.36~22.04.1\nNo subscription required\n\nlinux-image-unsigned-5.15.0-1026-ibm - 5.15.0-1026.29\nNo subscription required\n\nlinux-image-unsigned-5.15.0-1026-intel-iotg - 5.15.0-1026.31\nNo subscription required\n\nlinux-image-unsigned-5.15.0-1029-kvm - 5.15.0-1029.34\nNo subscription required\n\nlinux-image-unsigned-5.15.0-67-lowlatency - 5.15.0-67.74\nlinux-image-unsigned-5.15.0-67-lowlatency-64k - 5.15.0-67.74\nNo subscription required\n\nlinux-image-unsigned-5.19.0-1018-lowlatency - 5.19.0-1018.19~22.04.1\nlinux-image-unsigned-5.19.0-1018-lowlatency-64k - 5.19.0-1018.19~22.04.1\nNo subscription required\n\nlinux-image-unsigned-5.17.0-1028-oem - 5.17.0-1028.29\nNo subscription required\n\nlinux-image-unsigned-6.0.0-1012-oem - 6.0.0-1012.12\nNo subscription required\n\nlinux-image-unsigned-6.1.0-1007-oem - 6.1.0-1007.7\nNo subscription required\n\nlinux-image-unsigned-5.15.0-1030-oracle - 5.15.0-1030.36\nNo subscription required\n\nlinux-image-5.15.0-1025-raspi - 5.15.0-1025.27\nlinux-image-5.15.0-1025-raspi-nolpae - 5.15.0-1025.27\nNo subscription required\n\nlinux-image-5.15.0-67-generic - 5.15.0-67.74\nlinux-image-5.15.0-67-generic-lpae - 5.15.0-67.74\nlinux-image-unsigned-5.15.0-67-generic - 5.15.0-67.74\nlinux-image-unsigned-5.15.0-67-generic-64k - 5.15.0-67.74\nNo subscription required\n\nlinux-image-unsigned-5.15.0-1031-aws - 5.15.0-1031.35\nNo subscription required\n\nlinux-image-unsigned-5.15.0-1034-azure - 5.15.0-1034.41\nNo subscription required\n\nlinux-image-unsigned-5.15.0-1051-azure-fde - 5.15.0-1034.41\nNo subscription required\n\nlinux-image-unsigned-5.15.0-1030-gcp - 5.15.0-1030.37\nNo subscription required\n\nlinux-image-unsigned-5.15.0-1028-gke - 5.15.0-1028.33\nNo subscription required\n\nlinux-image-unsigned-5.15.0-1016-gkeop - 5.15.0-1016.21\nNo subscription required\n\nlinux-image-5.19.0-35-generic - 5.19.0-35.36~22.04.1\nlinux-image-5.19.0-35-generic-lpae - 5.19.0-35.36~22.04.1\nlinux-image-unsigned-5.19.0-35-generic - 5.19.0-35.36~22.04.1\nlinux-image-unsigned-5.19.0-35-generic-64k - 5.19.0-35.36~22.04.1\nNo subscription required\n\nlinux-image-unsigned-5.15.0-1026-ibm - 5.15.0-1026.29\nNo subscription required\n\nlinux-image-unsigned-5.15.0-1026-intel-iotg - 5.15.0-1026.31\nNo subscription required\n\nlinux-image-unsigned-5.15.0-1029-kvm - 5.15.0-1029.34\nNo subscription required\n\nlinux-image-unsigned-5.15.0-67-lowlatency - 5.15.0-67.74\nlinux-image-unsigned-5.15.0-67-lowlatency-64k - 5.15.0-67.74\nNo subscription required\n\nlinux-image-unsigned-5.19.0-1018-lowlatency - 5.19.0-1018.19~22.04.1\nlinux-image-unsigned-5.19.0-1018-lowlatency-64k - 5.19.0-1018.19~22.04.1\nNo subscription required\n\nlinux-image-unsigned-5.17.0-1028-oem - 5.17.0-1028.29\nNo subscription required\n\nlinux-image-unsigned-6.0.0-1012-oem - 6.0.0-1012.12\nNo subscription required\n\nlinux-image-unsigned-6.1.0-1007-oem - 6.1.0-1007.7\nNo subscription required\n\nlinux-image-unsigned-5.15.0-1030-oracle - 5.15.0-1030.36\nNo subscription required",
    "affected": {
      "family": "unix",
      "Platform": "Ubuntu 22.04 ESM"
    },
    "reference": {
      "source": "CVE",
      "ref_id": "CVE-2023-0461",
      "ref_url": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-0461"
    },
    "advisory": {
      "Severity": "High",
      "Rights": "Copyright (C) 2023 Canonical Ltd.",
      "PublicDate": "2023-02-22",
      "Bug": null,
      "cve": {
        "text": "CVE-2023-0461",
        "href": "https://ubuntu.com/security/CVE-2023-0461",
        "public": "20230222",
        "cvss_score": "7.8",
        "cvss_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
        "usns": "5883-1,5911-1,5912-1,5913-1,5914-1,5915-1,5917-1,5919-1,5920-1,5924-1,5925-1,5927-1,5929-1,5934-1,5935-1,5938-1,5939-1,5940-1,5941-1,5950-1,5951-1,5962-1,5975-1,5976-1,6000-1,6007-1"
      },
      "PublicDateAtUsn": "2023-02-22",
      "AssignedTo": "",
      "DiscoveredBy": "",
      "Crd": "",
      "Ref": null
    }
  },
  "notes": {
    "Note": "sbeattie> reported by google kCTF, apparently. rodrigo-zaiden> for some kernels, an extra commit was applied as a follow up commit: \"UBUNTU: SAUCE: Fix inet_csk_listen_start after CVE-2023-0461\" to properly address an error code variable during the backport. USN-5975-1 first publication included esm/xenial linux-gcp version 4.15.0-1146.162~16.04.1 by mistake, please refer to USN-6007-1."
  },
  "criteria": {
    "criterias": [
      {
        "operator": "OR",
        "criterions": [
          {
            "test_ref": "oval:com.ubuntu.jammy:tst:202231690000000",
            "comment": "linux package in jammy was vulnerable but has been fixed (note: '5.15.0-67.74')."
          },
          {
            "test_ref": "oval:com.ubuntu.jammy:tst:202231690000010",
            "comment": "linux-aws package in jammy was vulnerable but has been fixed (note: '5.15.0-1031.35')."
          },
          {
            "test_ref": "oval:com.ubuntu.jammy:tst:202231690000020",
            "comment": "linux-azure package in jammy was vulnerable but has been fixed (note: '5.15.0-1034.41')."
          },
          {
            "test_ref": "oval:com.ubuntu.jammy:tst:202231690000030",
            "comment": "linux-azure-5.19 package in jammy was vulnerable but has been fixed (note: '5.19.0-1021.22~22.04.1')."
          },
          {
            "test_ref": "oval:com.ubuntu.jammy:tst:202231690000040",
            "comment": "linux-azure-fde package in jammy was vulnerable but has been fixed (note: '5.15.0-1034.41')."
          },
          {
            "test_ref": "oval:com.ubuntu.jammy:tst:202231690000050",
            "comment": "linux-gcp package in jammy was vulnerable but has been fixed (note: '5.15.0-1030.37')."
          },
          {
            "test_ref": "oval:com.ubuntu.jammy:tst:202231690000060",
            "comment": "linux-gke package in jammy was vulnerable but has been fixed (note: '5.15.0-1028.33')."
          },
          {
            "test_ref": "oval:com.ubuntu.jammy:tst:202231690000070",
            "comment": "linux-gkeop package in jammy was vulnerable but has been fixed (note: '5.15.0-1016.21')."
          },
          {
            "test_ref": "oval:com.ubuntu.jammy:tst:202231690000080",
            "comment": "linux-hwe-5.19 package in jammy was vulnerable but has been fixed (note: '5.19.0-35.36~22.04.1')."
          },
          {
            "test_ref": "oval:com.ubuntu.jammy:tst:202231690000090",
            "comment": "linux-ibm package in jammy was vulnerable but has been fixed (note: '5.15.0-1026.29')."
          },
          {
            "test_ref": "oval:com.ubuntu.jammy:tst:202231690000100",
            "comment": "linux-intel-iotg package in jammy was vulnerable but has been fixed (note: '5.15.0-1026.31')."
          },
          {
            "test_ref": "oval:com.ubuntu.jammy:tst:202231690000110",
            "comment": "linux-kvm package in jammy was vulnerable but has been fixed (note: '5.15.0-1029.34')."
          },
          {
            "test_ref": "oval:com.ubuntu.jammy:tst:202231690000120",
            "comment": "linux-lowlatency package in jammy was vulnerable but has been fixed (note: '5.15.0-67.74')."
          },
          {
            "test_ref": "oval:com.ubuntu.jammy:tst:202231690000130",
            "comment": "linux-lowlatency-hwe-5.19 package in jammy was vulnerable but has been fixed (note: '5.19.0-1018.19~22.04.1')."
          },
          {
            "test_ref": "oval:com.ubuntu.jammy:tst:2022205660000140",
            "comment": "linux-oem-5.17 package in jammy was vulnerable but has been fixed (note: '5.17.0-1028.29')."
          },
          {
            "test_ref": "oval:com.ubuntu.jammy:tst:202235670000200",
            "comment": "linux-oem-6.0 package in jammy was vulnerable but has been fixed (note: '6.0.0-1012.12')."
          },
          {
            "test_ref": "oval:com.ubuntu.jammy:tst:2022362800000160",
            "comment": "linux-oem-6.1 package in jammy was vulnerable but has been fixed (note: '6.1.0-1007.7')."
          },
          {
            "test_ref": "oval:com.ubuntu.jammy:tst:202231690000170",
            "comment": "linux-oracle package in jammy was vulnerable but has been fixed (note: '5.15.0-1030.36')."
          },
          {
            "test_ref": "oval:com.ubuntu.jammy:tst:202231690000180",
            "comment": "linux-raspi package in jammy was vulnerable but has been fixed (note: '5.15.0-1025.27')."
          },
          {
            "test_ref": "oval:com.ubuntu.jammy:tst:202231690000190",
            "comment": "linux-signed package in jammy was vulnerable but has been fixed (note: '5.15.0-67.74')."
          },
          {
            "test_ref": "oval:com.ubuntu.jammy:tst:202231690000200",
            "comment": "linux-signed-aws package in jammy was vulnerable but has been fixed (note: '5.15.0-1031.35')."
          },
          {
            "test_ref": "oval:com.ubuntu.jammy:tst:202231690000210",
            "comment": "linux-signed-azure package in jammy was vulnerable but has been fixed (note: '5.15.0-1034.41')."
          },
          {
            "test_ref": "oval:com.ubuntu.jammy:tst:202231690000220",
            "comment": "linux-signed-azure-fde package in jammy was vulnerable but has been fixed (note: '5.15.0-1034.41')."
          },
          {
            "test_ref": "oval:com.ubuntu.jammy:tst:202231690000230",
            "comment": "linux-signed-gcp package in jammy was vulnerable but has been fixed (note: '5.15.0-1030.37')."
          },
          {
            "test_ref": "oval:com.ubuntu.jammy:tst:202231690000240",
            "comment": "linux-signed-gke package in jammy was vulnerable but has been fixed (note: '5.15.0-1028.33')."
          },
          {
            "test_ref": "oval:com.ubuntu.jammy:tst:202231690000250",
            "comment": "linux-signed-gkeop package in jammy was vulnerable but has been fixed (note: '5.15.0-1016.21')."
          },
          {
            "test_ref": "oval:com.ubuntu.jammy:tst:202231690000260",
            "comment": "linux-signed-hwe-5.19 package in jammy was vulnerable but has been fixed (note: '5.19.0-35.36~22.04.1')."
          },
          {
            "test_ref": "oval:com.ubuntu.jammy:tst:202231690000270",
            "comment": "linux-signed-ibm package in jammy was vulnerable but has been fixed (note: '5.15.0-1026.29')."
          },
          {
            "test_ref": "oval:com.ubuntu.jammy:tst:202231690000280",
            "comment": "linux-signed-intel-iotg package in jammy was vulnerable but has been fixed (note: '5.15.0-1026.31')."
          },
          {
            "test_ref": "oval:com.ubuntu.jammy:tst:202231690000290",
            "comment": "linux-signed-kvm package in jammy was vulnerable but has been fixed (note: '5.15.0-1029.34')."
          },
          {
            "test_ref": "oval:com.ubuntu.jammy:tst:202231690000300",
            "comment": "linux-signed-lowlatency package in jammy was vulnerable but has been fixed (note: '5.15.0-67.74')."
          },
          {
            "test_ref": "oval:com.ubuntu.jammy:tst:202231690000310",
            "comment": "linux-signed-lowlatency-hwe-5.19 package in jammy was vulnerable but has been fixed (note: '5.19.0-1018.19~22.04.1')."
          },
          {
            "test_ref": "oval:com.ubuntu.jammy:tst:2022205660000320",
            "comment": "linux-signed-oem-5.17 package in jammy was vulnerable but has been fixed (note: '5.17.0-1028.29')."
          },
          {
            "test_ref": "oval:com.ubuntu.jammy:tst:202235670000430",
            "comment": "linux-signed-oem-6.0 package in jammy was vulnerable but has been fixed (note: '6.0.0-1012.12')."
          },
          {
            "test_ref": "oval:com.ubuntu.jammy:tst:2022362800000340",
            "comment": "linux-signed-oem-6.1 package in jammy was vulnerable but has been fixed (note: '6.1.0-1007.7')."
          },
          {
            "test_ref": "oval:com.ubuntu.jammy:tst:202231690000350",
            "comment": "linux-signed-oracle package in jammy was vulnerable but has been fixed (note: '5.15.0-1030.36')."
          }
        ]
      }
    ]
  }
}
