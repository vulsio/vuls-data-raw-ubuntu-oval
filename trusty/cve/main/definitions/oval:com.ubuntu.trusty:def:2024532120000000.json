{
	"class": "vulnerability",
	"id": "oval:com.ubuntu.trusty:def:2024532120000000",
	"version": "1",
	"metadata": {
		"title": "CVE-2024-53212 on Ubuntu 14.04 LTS (trusty) - medium",
		"description": "In the Linux kernel, the following vulnerability has been resolved:netlink: fix false positive warning in extack during dumpsCommit under fixes extended extack reporting to dumps.It works under normal conditions, because extack errors areusually reported during ->start() or the first ->dump(),it's quite rare that the dump starts okay but fails later.If the dump does fail later, however, the input skb willalready have the initiating message pulled, so checkingif bad attr falls within skb->data will fail.Switch the check to using nlh, which is always valid.syzbot found a way to hit that scenario by filling upthe receive queue. In this case we initiate a dumpbut don't call ->dump() until there is read space foran skb.WARNING: CPU: 1 PID: 5845 at net/netlink/af_netlink.c:2210netlink_ack_tlv_fill+0x1a8/0x560 net/netlink/af_netlink.c:2209RIP: 0010:netlink_ack_tlv_fill+0x1a8/0x560 net/netlink/af_netlink.c:2209Call Trace: <TASK> netlink_dump_done+0x513/0x970 net/netlink/af_netlink.c:2250 netlink_dump+0x91f/0xe10 net/netlink/af_netlink.c:2351 netlink_recvmsg+0x6bb/0x11d0 net/netlink/af_netlink.c:1983 sock_recvmsg_nosec net/socket.c:1051 [inline] sock_recvmsg+0x22f/0x280 net/socket.c:1073 __sys_recvfrom+0x246/0x3d0 net/socket.c:2267 __do_sys_recvfrom net/socket.c:2285 [inline] __se_sys_recvfrom net/socket.c:2281 [inline] __x64_sys_recvfrom+0xde/0x100 net/socket.c:2281 do_syscall_x64 arch/x86/entry/common.c:52 [inline] do_syscall_64+0xf3/0x230 arch/x86/entry/common.c:83 entry_SYSCALL_64_after_hwframe+0x77/0x7f RIP: 0033:0x7ff37dd17a79\n\n    Update Instructions:\n\n    Run `sudo pro fix CVE-2024-53212` to fix the vulnerability. The problem can be corrected\n    by updating your system to the following package versions:\n\nlinux-image-unsigned-3.13.0-199-generic - 3.13.0-173.224\nlinux-image-unsigned-3.13.0-199-lowlatency - 3.13.0-173.224\nAvailable with Ubuntu Pro with Legacy support add-on: https://ubuntu.com/pro\n\nlinux-image-4.4.0-258-generic - 4.4.0-164.192~14.04.1\nlinux-image-unsigned-4.4.0-258-generic - 4.4.0-164.192~14.04.1\nlinux-image-unsigned-4.4.0-258-lowlatency - 4.4.0-164.192~14.04.1\nAvailable with Ubuntu Pro with Legacy support add-on: https://ubuntu.com/pro\n\nlinux-image-4.4.0-1135-aws - 4.4.0-1054.58\nAvailable with Ubuntu Pro with Legacy support add-on: https://ubuntu.com/pro\n\nlinux-image-unsigned-4.15.0-1180-azure - 4.15.0-1059.64~14.04.1\nAvailable with Ubuntu Pro with Legacy support add-on: https://ubuntu.com/pro",
		"affected": {
			"family": "unix",
			"platform": "Ubuntu 14.04 LTS"
		},
		"reference": {
			"source": "CVE",
			"ref_id": "CVE-2024-53212",
			"ref_url": "https://www.cve.org/CVERecord?id=CVE-2024-53212"
		},
		"advisory": {
			"severity": "Medium",
			"rights": "Copyright (C) 2024 Canonical Ltd.",
			"public_date": "2024-12-27 14:15:00 UTC",
			"cve": {
				"text": "CVE-2024-53212",
				"href": "https://ubuntu.com/security/CVE-2024-53212",
				"public": "20241227"
			}
		}
	},
	"notes": {},
	"criteria": {
		"criterias": [
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:com.ubuntu.trusty:tst:2019114770000000",
						"comment": "linux package in trusty, is related to the CVE in some way and has been fixed (note: '3.13.0-173.224')."
					},
					{
						"test_ref": "oval:com.ubuntu.trusty:tst:2017185510000000",
						"comment": "linux-lts-xenial package in trusty, is related to the CVE in some way and has been fixed (note: '4.4.0-164.192~14.04.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.trusty:tst:2017185510000010",
						"comment": "linux-aws package in trusty, is related to the CVE in some way and has been fixed (note: '4.4.0-1054.58')."
					},
					{
						"test_ref": "oval:com.ubuntu.trusty:tst:2018130530000000",
						"comment": "linux-azure package in trusty, is related to the CVE in some way and has been fixed (note: '4.15.0-1059.64~14.04.1')."
					}
				]
			}
		]
	}
}
