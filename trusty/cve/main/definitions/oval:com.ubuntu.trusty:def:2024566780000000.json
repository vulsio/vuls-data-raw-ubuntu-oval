{
	"class": "vulnerability",
	"id": "oval:com.ubuntu.trusty:def:2024566780000000",
	"version": "1",
	"metadata": {
		"title": "CVE-2024-56678 on Ubuntu 14.04 LTS (trusty) - medium",
		"description": "In the Linux kernel, the following vulnerability has been resolved:powerpc/mm/fault: Fix kfence page fault reportingcopy_from_kernel_nofault() can be called when doing read of /proc/kcore./proc/kcore can have some unmapped kfence objects which when read viacopy_from_kernel_nofault() can cause page faults. Since *_nofault()functions define their own fixup table for handling fault, use thatinstead of asking kfence to handle such faults.Hence we search the exception tables for the nip which generated thefault. If there is an entry then we let the fixup table handler handle thepage fault by returning an error from within ___do_page_fault().This can be easily triggered if someone tries to do dd from /proc/kcore.eg. dd if=/proc/kcore of=/dev/null bs=1MSome example false negatives:  ===============================  BUG: KFENCE: invalid read in copy_from_kernel_nofault+0x9c/0x1a0  Invalid read at 0xc0000000fdff0000:   copy_from_kernel_nofault+0x9c/0x1a0   0xc00000000665f950   read_kcore_iter+0x57c/0xa04   proc_reg_read_iter+0xe4/0x16c   vfs_read+0x320/0x3ec   ksys_read+0x90/0x154   system_call_exception+0x120/0x310   system_call_vectored_common+0x15c/0x2ec  BUG: KFENCE: use-after-free read in copy_from_kernel_nofault+0x9c/0x1a0  Use-after-free read at 0xc0000000fe050000 (in kfence-#2):   copy_from_kernel_nofault+0x9c/0x1a0   0xc00000000665f950   read_kcore_iter+0x57c/0xa04   proc_reg_read_iter+0xe4/0x16c   vfs_read+0x320/0x3ec   ksys_read+0x90/0x154   system_call_exception+0x120/0x310   system_call_vectored_common+0x15c/0x2ec\n\n    Update Instructions:\n\n    Run `sudo pro fix CVE-2024-56678` to fix the vulnerability. The problem can be corrected\n    by updating your system to the following package versions:\n\nlinux-image-unsigned-3.13.0-199-generic - 3.13.0-173.224\nlinux-image-unsigned-3.13.0-199-lowlatency - 3.13.0-173.224\nAvailable with Ubuntu Pro with Legacy support add-on: https://ubuntu.com/pro\n\nlinux-image-4.4.0-258-generic - 4.4.0-164.192~14.04.1\nlinux-image-unsigned-4.4.0-258-generic - 4.4.0-164.192~14.04.1\nlinux-image-unsigned-4.4.0-258-lowlatency - 4.4.0-164.192~14.04.1\nAvailable with Ubuntu Pro with Legacy support add-on: https://ubuntu.com/pro\n\nlinux-image-4.4.0-1135-aws - 4.4.0-1054.58\nAvailable with Ubuntu Pro with Legacy support add-on: https://ubuntu.com/pro\n\nlinux-image-unsigned-4.15.0-1180-azure - 4.15.0-1059.64~14.04.1\nAvailable with Ubuntu Pro with Legacy support add-on: https://ubuntu.com/pro",
		"affected": {
			"family": "unix",
			"platform": "Ubuntu 14.04 LTS"
		},
		"reference": {
			"source": "CVE",
			"ref_id": "CVE-2024-56678",
			"ref_url": "https://www.cve.org/CVERecord?id=CVE-2024-56678"
		},
		"advisory": {
			"severity": "Medium",
			"rights": "Copyright (C) 2024 Canonical Ltd.",
			"public_date": "2024-12-28 10:15:00 UTC",
			"cve": {
				"text": "CVE-2024-56678",
				"href": "https://ubuntu.com/security/CVE-2024-56678",
				"public": "20241228"
			}
		}
	},
	"notes": {},
	"criteria": {
		"criterias": [
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:com.ubuntu.trusty:tst:2019114770000000",
						"comment": "linux package in trusty, is related to the CVE in some way and has been fixed (note: '3.13.0-173.224')."
					},
					{
						"test_ref": "oval:com.ubuntu.trusty:tst:2017185510000000",
						"comment": "linux-lts-xenial package in trusty, is related to the CVE in some way and has been fixed (note: '4.4.0-164.192~14.04.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.trusty:tst:2017185510000010",
						"comment": "linux-aws package in trusty, is related to the CVE in some way and has been fixed (note: '4.4.0-1054.58')."
					},
					{
						"test_ref": "oval:com.ubuntu.trusty:tst:2018130530000000",
						"comment": "linux-azure package in trusty, is related to the CVE in some way and has been fixed (note: '4.15.0-1059.64~14.04.1')."
					}
				]
			}
		]
	}
}
