{
	"class": "vulnerability",
	"id": "oval:com.ubuntu.trusty:def:2024369710000000",
	"version": "1",
	"metadata": {
		"title": "CVE-2024-36971 on Ubuntu 14.04 LTS (trusty) - high",
		"description": "In the Linux kernel, the following vulnerability has been resolved: net:fix __dst_negative_advice() race __dst_negative_advice() does not enforceproper RCU rules when sk->dst_cache must be cleared, leading to possibleUAF. RCU rules are that we must first clear sk->sk_dst_cache, then calldst_release(old_dst). Note that sk_dst_reset(sk) is implementing thisprotocol correctly, while __dst_negative_advice() uses the wrong order.Given that ip6_negative_advice() has special logic against RTF_CACHE, thismeans each of the three ->negative_advice() existing methods must performthe sk_dst_reset() themselves. Note the check against NULL dst iscentralized in __dst_negative_advice(), there is no need to duplicate it invarious callbacks. Many thanks to Clement Lecigne for tracking this issue.This old bug became visible after the blamed commit, using UDP sockets.\n\n    Update Instructions:\n\n    Run `sudo pro fix CVE-2024-36971` to fix the vulnerability. The problem can be corrected\n    by updating your system to the following package versions:\n\nlinux-image-3.11.0-12-generic - 3.11.0-12.19\nlinux-image-3.11.0-12-generic-lpae - 3.11.0-12.19\nlinux-image-extra-3.11.0-12-generic - 3.11.0-12.19\nNo subscription required\n\nlinux-image-4.4.0-13-generic - 4.4.0-13.29~14.04.1\nlinux-image-4.4.0-13-generic-lpae - 4.4.0-13.29~14.04.1\nlinux-image-4.4.0-13-lowlatency - 4.4.0-13.29~14.04.1\nlinux-image-4.4.0-13-powerpc-e500mc - 4.4.0-13.29~14.04.1\nlinux-image-4.4.0-13-powerpc-smp - 4.4.0-13.29~14.04.1\nlinux-image-4.4.0-13-powerpc64-emb - 4.4.0-13.29~14.04.1\nlinux-image-4.4.0-13-powerpc64-smp - 4.4.0-13.29~14.04.1\nlinux-image-extra-4.4.0-13-generic - 4.4.0-13.29~14.04.1\nNo subscription required\n\nlinux-image-4.4.0-1002-aws - 4.4.0-1002.2\nNo subscription required",
		"affected": {
			"family": "unix",
			"platform": "Ubuntu 14.04 LTS"
		},
		"reference": {
			"source": "CVE",
			"ref_id": "CVE-2024-36971",
			"ref_url": "https://www.cve.org/CVERecord?id=CVE-2024-36971"
		},
		"advisory": {
			"severity": "High",
			"rights": "Copyright (C) 2024 Canonical Ltd.",
			"public_date": "2024-06-10 09:15:00 UTC",
			"cve": {
				"text": "CVE-2024-36971",
				"href": "https://ubuntu.com/security/CVE-2024-36971",
				"public": "20240610",
				"cvss_score": "7.8",
				"cvss_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
				"usns": "6951-1,6953-1,6951-2,6951-3,6951-4,6979-1,6999-1,7004-1,7005-1,7007-1,7008-1,7005-2,7009-1,7019-1,7007-2,6999-2,7007-3,7029-1,7009-2,7069-1"
			},
			"public_date_at_usn": "2024-06-10 09:15:00 UTC",
			"ref": [
				"https://ubuntu.com/security/notices/USN-6951-1",
				"https://ubuntu.com/security/notices/USN-6953-1",
				"https://ubuntu.com/security/notices/USN-6951-2",
				"https://ubuntu.com/security/notices/USN-6951-3",
				"https://ubuntu.com/security/notices/USN-6951-4",
				"https://ubuntu.com/security/notices/USN-6979-1",
				"https://ubuntu.com/security/notices/USN-6999-1",
				"https://ubuntu.com/security/notices/USN-7004-1",
				"https://ubuntu.com/security/notices/USN-7005-1",
				"https://ubuntu.com/security/notices/USN-7007-1",
				"https://ubuntu.com/security/notices/USN-7008-1",
				"https://ubuntu.com/security/notices/USN-7005-2",
				"https://ubuntu.com/security/notices/USN-7009-1",
				"https://ubuntu.com/security/notices/USN-7019-1",
				"https://ubuntu.com/security/notices/USN-7007-2",
				"https://ubuntu.com/security/notices/USN-6999-2",
				"https://ubuntu.com/security/notices/USN-7007-3",
				"https://ubuntu.com/security/notices/USN-7029-1",
				"https://ubuntu.com/security/notices/USN-7009-2",
				"https://ubuntu.com/security/notices/USN-7069-1"
			]
		}
	},
	"notes": {},
	"criteria": {
		"criterias": [
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:com.ubuntu.trusty:tst:200636350000000",
						"comment": "linux package in trusty, is related to the CVE in some way and has been fixed (note: '3.11.0-12.19')."
					},
					{
						"test_ref": "oval:com.ubuntu.trusty:tst:200636350000100",
						"comment": "linux-lts-xenial package in trusty, is related to the CVE in some way and has been fixed (note: '4.4.0-13.29~14.04.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.trusty:tst:200636350000110",
						"comment": "linux-aws package in trusty, is related to the CVE in some way and has been fixed (note: '4.4.0-1002.2')."
					},
					{
						"test_ref": "oval:com.ubuntu.trusty:tst:200747740000030",
						"comment": "linux-azure package in trusty is affected and needs fixing."
					}
				]
			}
		]
	}
}
