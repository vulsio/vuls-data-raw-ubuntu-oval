{
  "class": "vulnerability",
  "id": "oval:com.ubuntu.trusty:def:202134930000000",
  "version": "1",
  "metadata": {
    "Title": "CVE-2021-3493 on Ubuntu 14.04 ESM (trusty) - high.",
    "Description": "The overlayfs implementation in the linux kernel did not properly validate with respect to user namespaces the setting of file capabilities on files in an underlying file system. Due to the combination of unprivileged user namespaces along with a patch carried in the Ubuntu kernel to allow unprivileged overlay mounts, an attacker could use this to gain elevated privileges. It was discovered that the overlayfs implementation in the Linux kernel did not properly validate the application of file system capabilities with respect to user namespaces. A local attacker could use this to gain elevated privileges.\n\nUpdate Instructions:\n\nRun `sudo pro fix CVE-2021-3493` to fix the vulnerability. The problem can be corrected\nby updating your system to the following package versions:\n\nlinux-image-3.11.0-12-generic - 3.11.0-12.19\nlinux-image-3.11.0-12-generic-lpae - 3.11.0-12.19\nlinux-image-extra-3.11.0-12-generic - 3.11.0-12.19\nNo subscription required\n\nlinux-image-4.4.0-1091-aws - 4.4.0-1091.95\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro\n\nlinux-image-unsigned-4.15.0-1113-azure - 4.15.0-1113.126~14.04.1\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro\n\nlinux-image-4.4.0-209-generic - 4.4.0-209.241~14.04.1\nlinux-image-4.4.0-209-generic-lpae - 4.4.0-209.241~14.04.1\nlinux-image-4.4.0-209-lowlatency - 4.4.0-209.241~14.04.1\nlinux-image-4.4.0-209-powerpc-e500mc - 4.4.0-209.241~14.04.1\nlinux-image-4.4.0-209-powerpc-smp - 4.4.0-209.241~14.04.1\nlinux-image-4.4.0-209-powerpc64-emb - 4.4.0-209.241~14.04.1\nlinux-image-4.4.0-209-powerpc64-smp - 4.4.0-209.241~14.04.1\nlinux-image-unsigned-4.4.0-209-generic - 4.4.0-209.241~14.04.1\nlinux-image-unsigned-4.4.0-209-lowlatency - 4.4.0-209.241~14.04.1\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro\n\nlinux-image-3.11.0-12-generic - 3.11.0-12.19\nlinux-image-3.11.0-12-generic-lpae - 3.11.0-12.19\nlinux-image-extra-3.11.0-12-generic - 3.11.0-12.19\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro\n\nlinux-image-unsigned-4.15.0-1113-azure - 4.15.0-1113.126~14.04.1\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro\n\nlinux-image-4.4.0-209-generic - 4.4.0-209.241~14.04.1\nlinux-image-4.4.0-209-generic-lpae - 4.4.0-209.241~14.04.1\nlinux-image-4.4.0-209-lowlatency - 4.4.0-209.241~14.04.1\nlinux-image-4.4.0-209-powerpc-e500mc - 4.4.0-209.241~14.04.1\nlinux-image-4.4.0-209-powerpc-smp - 4.4.0-209.241~14.04.1\nlinux-image-4.4.0-209-powerpc64-emb - 4.4.0-209.241~14.04.1\nlinux-image-4.4.0-209-powerpc64-smp - 4.4.0-209.241~14.04.1\nlinux-image-unsigned-4.4.0-209-generic - 4.4.0-209.241~14.04.1\nlinux-image-unsigned-4.4.0-209-lowlatency - 4.4.0-209.241~14.04.1\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro",
    "affected": {
      "family": "unix",
      "Platform": "Ubuntu 14.04 ESM"
    },
    "reference": {
      "source": "CVE",
      "ref_id": "CVE-2021-3493",
      "ref_url": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-3493"
    },
    "advisory": {
      "Severity": "High",
      "Rights": "Copyright (C) 2021 Canonical Ltd.",
      "PublicDate": "2021-04-15 17:00:00 UTC",
      "Bug": null,
      "cve": {
        "text": "CVE-2021-3493",
        "href": "https://ubuntu.com/security/CVE-2021-3493",
        "public": "20210415",
        "cvss_score": "7.8",
        "cvss_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
        "usns": "4915-1,4916-1,4917-1"
      },
      "PublicDateAtUsn": "2021-04-15 17:00:00 UTC",
      "AssignedTo": "cascardo",
      "DiscoveredBy": "",
      "Crd": "2021-04-15 17:00:00 UTC",
      "Ref": null
    }
  },
  "notes": {
    "Note": "sbeattie> issue is specific to Ubuntu or any other distribution that patched the kernel to allow unprivileged overlay mounts, prior to the 5.11 commit (459c7c565ac36b) that permits it upstream."
  },
  "criteria": {
    "criterias": [
      {
        "operator": "OR",
        "criterions": [
          {
            "test_ref": "oval:com.ubuntu.trusty:tst:201686600000000",
            "comment": "linux package in trusty, is related to the CVE in some way and has been fixed (note: '3.11.0-12.19')."
          },
          {
            "test_ref": "oval:com.ubuntu.trusty:tst:2021291540000010",
            "comment": "linux-aws package in trusty/esm was vulnerable but has been fixed (note: '4.4.0-1091.95')."
          },
          {
            "test_ref": "oval:com.ubuntu.trusty:tst:2021291540000020",
            "comment": "linux-azure package in trusty/esm was vulnerable but has been fixed (note: '4.15.0-1113.126~14.04.1')."
          },
          {
            "test_ref": "oval:com.ubuntu.trusty:tst:2021291540000030",
            "comment": "linux-lts-xenial package in trusty/esm was vulnerable but has been fixed (note: '4.4.0-209.241~14.04.1')."
          },
          {
            "test_ref": "oval:com.ubuntu.trusty:tst:201686600000120",
            "comment": "linux-signed package in trusty, is related to the CVE in some way and has been fixed (note: '3.11.0-12.19')."
          },
          {
            "test_ref": "oval:com.ubuntu.trusty:tst:2021291540000050",
            "comment": "linux-signed-azure package in trusty/esm was vulnerable but has been fixed (note: '4.15.0-1113.126~14.04.1')."
          },
          {
            "test_ref": "oval:com.ubuntu.trusty:tst:2021291540000060",
            "comment": "linux-signed-lts-xenial package in trusty/esm was vulnerable but has been fixed (note: '4.4.0-209.241~14.04.1')."
          }
        ]
      }
    ]
  }
}
