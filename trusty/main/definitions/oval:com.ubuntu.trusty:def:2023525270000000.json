{
	"class": "vulnerability",
	"id": "oval:com.ubuntu.trusty:def:2023525270000000",
	"version": "1",
	"metadata": {
		"title": "CVE-2023-52527 on Ubuntu 14.04 LTS (trusty) - medium",
		"description": "In the Linux kernel, the following vulnerability has been resolved: ipv4,ipv6: Fix handling of transhdrlen in __ip{,6}_append_data() Including thetranshdrlen in length is a problem when the packet is partially filled(e.g. something like send(MSG_MORE) happened previously) when appending toan IPv4 or IPv6 packet as we don't want to repeat the transport header oraccount for it twice. This can happen under some circumstances, such assplicing into an L2TP socket. The symptom observed is a warning in__ip6_append_data(): WARNING: CPU: 1 PID: 5042 atnet/ipv6/ip6_output.c:1800 __ip6_append_data.isra.0+0x1be8/0x47f0net/ipv6/ip6_output.c:1800 that occurs when MSG_SPLICE_PAGES is used toappend more data to an already partially occupied skbuff. The warningoccurs when 'copy' is larger than the amount of data in the messageiterator. This is because the requested length includes the transportheader length when it shouldn't. This can be triggered by, for example: sfd= socket(AF_INET6, SOCK_DGRAM, IPPROTO_L2TP); bind(sfd, ...); // ::1connect(sfd, ...); // ::1 port 7 send(sfd, buffer, 4100, MSG_MORE);sendfile(sfd, dfd, NULL, 1024); Fix this by only adding transhdrlen intothe length if the write queue is empty in l2tp_ip6_sendmsg(), analogouslyto how UDP does things. l2tp_ip_sendmsg() looks like it won't suffer fromthis problem as it builds the UDP packet itself.\n\n    Update Instructions:\n\n    Run `sudo pro fix CVE-2023-52527` to fix the vulnerability. The problem can be corrected\n    by updating your system to the following package versions:\n\nlinux-image-4.4.0-259-generic - 4.4.0-259.293~14.04.1\nlinux-image-unsigned-4.4.0-259-generic - 4.4.0-259.293~14.04.1\nlinux-image-unsigned-4.4.0-259-lowlatency - 4.4.0-259.293~14.04.1\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro\n\nlinux-image-4.4.0-1136-aws - 4.4.0-1136.142\nAvailable with Ubuntu Pro (Infra-only): https://ubuntu.com/pro",
		"affected": {
			"family": "unix",
			"platform": "Ubuntu 14.04 LTS"
		},
		"reference": {
			"source": "CVE",
			"ref_id": "CVE-2023-52527",
			"ref_url": "https://www.cve.org/CVERecord?id=CVE-2023-52527"
		},
		"advisory": {
			"severity": "Medium",
			"rights": "Copyright (C) 2024 Canonical Ltd.",
			"public_date": "2024-03-02 22:15:00 UTC",
			"cve": {
				"text": "CVE-2023-52527",
				"href": "https://ubuntu.com/security/CVE-2023-52527",
				"public": "20240302"
			},
			"public_date_at_usn": "2024-03-02 22:15:00 UTC",
			"ref": [
				"https://ubuntu.com/security/notices/USN-7028-1",
				"https://ubuntu.com/security/notices/USN-7039-1"
			]
		}
	},
	"notes": {},
	"criteria": {
		"criterias": [
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:com.ubuntu.trusty:tst:200747740000000",
						"comment": "linux: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'ESM criteria, was needed')."
					},
					{
						"test_ref": "oval:com.ubuntu.trusty:tst:2021471810000000",
						"comment": "linux-lts-xenial package in trusty was vulnerable but has been fixed (note: '4.4.0-259.293~14.04.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.trusty:tst:2021471810000010",
						"comment": "linux-aws package in trusty was vulnerable but has been fixed (note: '4.4.0-1136.142')."
					},
					{
						"test_ref": "oval:com.ubuntu.trusty:tst:200747740000030",
						"comment": "linux-azure package in trusty is affected. An update containing the fix has been completed and is pending publication (note: '4.15.0-1181.196~14.04.1')."
					}
				]
			}
		]
	}
}
