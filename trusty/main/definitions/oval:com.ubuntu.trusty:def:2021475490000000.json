{
	"class": "vulnerability",
	"id": "oval:com.ubuntu.trusty:def:2021475490000000",
	"version": "1",
	"metadata": {
		"title": "CVE-2021-47549 on Ubuntu 14.04 LTS (trusty) - medium",
		"description": "In the Linux kernel, the following vulnerability has been resolved:sata_fsl: fix UAF in sata_fsl_port_stop when rmmod sata_fsl When the `rmmodsata_fsl.ko` command is executed in the PPC64 GNU/Linux, a bug is reported:================================================================== BUG:Unable to handle kernel data access on read at 0x80000800805b502c Oops:Kernel access of bad area, sig: 11 [#1] NIP [c0000000000388a4].ioread32+0x4/0x20 LR [80000000000c6034] .sata_fsl_port_stop+0x44/0xe0[sata_fsl] Call Trace: .free_irq+0x1c/0x4e0 (unreliable).ata_host_stop+0x74/0xd0 [libata] .release_nodes+0x330/0x3f0.device_release_driver_internal+0x178/0x2c0 .driver_detach+0x64/0xd0.bus_remove_driver+0x70/0xf0 .driver_unregister+0x38/0x80.platform_driver_unregister+0x14/0x30 .fsl_sata_driver_exit+0x18/0xa20[sata_fsl] .__se_sys_delete_module+0x1ec/0x2d0.system_call_exception+0xfc/0x1f0 system_call_common+0xf8/0x200================================================================== Thetriggering of the BUG is shown in the following stack: driver_detachdevice_release_driver_internal __device_release_driver drv->remove(dev) -->platform_drv_remove/platform_remove drv->remove(dev) --> sata_fsl_removeiounmap(host_priv->hcr_base); <---- unmap kfree(host_priv); <---- freedevres_release_all release_nodes dr->node.release(dev, dr->data) -->ata_host_stop ap->ops->port_stop(ap) --> sata_fsl_port_stopioread32(hcr_base + HCONTROL) <---- UAF host->ops->host_stop(host) Theiounmap(host_priv->hcr_base) and kfree(host_priv) functions should not beexecuted in drv->remove. These functions should be executed in host_stopafter port_stop. Therefore, we move these functions to the new functionsata_fsl_host_stop and bind the new function to host_stop.",
		"affected": {
			"family": "unix",
			"platform": "Ubuntu 14.04 LTS"
		},
		"reference": {
			"source": "CVE",
			"ref_id": "CVE-2021-47549",
			"ref_url": "https://www.cve.org/CVERecord?id=CVE-2021-47549"
		},
		"advisory": {
			"severity": "Medium",
			"rights": "Copyright (C) 2024 Canonical Ltd.",
			"public_date": "2024-05-24 15:15:00 UTC",
			"cve": {
				"text": "CVE-2021-47549",
				"href": "https://ubuntu.com/security/CVE-2021-47549",
				"public": "20240524"
			}
		}
	},
	"notes": {},
	"criteria": {
		"criterias": [
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:com.ubuntu.trusty:tst:200747740000000",
						"comment": "linux: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'ESM criteria, was needed')."
					},
					{
						"test_ref": "oval:com.ubuntu.trusty:tst:200747740000010",
						"comment": "linux-lts-xenial: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'ESM criteria, was needed')."
					},
					{
						"test_ref": "oval:com.ubuntu.trusty:tst:200747740000020",
						"comment": "linux-aws: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'ESM criteria, was needed')."
					},
					{
						"test_ref": "oval:com.ubuntu.trusty:tst:200747740000030",
						"comment": "linux-azure package in trusty is affected. An update containing the fix has been completed and is pending publication (note: '4.15.0-1131.144~14.04.1')."
					}
				]
			}
		]
	}
}
