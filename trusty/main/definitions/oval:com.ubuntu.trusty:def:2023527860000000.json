{
	"class": "vulnerability",
	"id": "oval:com.ubuntu.trusty:def:2023527860000000",
	"version": "1",
	"metadata": {
		"title": "CVE-2023-52786 on Ubuntu 14.04 LTS (trusty) - medium",
		"description": "In the Linux kernel, the following vulnerability has been resolved:ext4: fix racy may inline data check in dio writesyzbot reports that the following warning from ext4_iomap_begin()triggers as of the commit referenced below:        if (WARN_ON_ONCE(ext4_has_inline_data(inode)))                return -ERANGE;This occurs during a dio write, which is never expected to encounteran inode with inline data. To enforce this behavior,ext4_dio_write_iter() checks the current inline state of the inodeand clears the MAY_INLINE_DATA state flag to either fall back tobuffered writes, or enforce that any other writers in progress onthe inode are not allowed to create inline data.The problem is that the check for existing inline data and the stateflag can span a lock cycle. For example, if the ilock is originallylocked shared and subsequently upgraded to exclusive, another writermay have reacquired the lock and created inline data before the diowrite task acquires the lock and proceeds.The commit referenced below loosens the lock requirements to allowsome forms of unaligned dio writes to occur under shared lock, butAFAICT the inline data check was technically already racy for anydio write that would have involved a lock cycle. Regardless, liftclearing of the state bit to the same lock critical section thatchecks for preexisting inline data on the inode to close the race.",
		"affected": {
			"family": "unix",
			"platform": "Ubuntu 14.04 LTS"
		},
		"reference": {
			"source": "CVE",
			"ref_id": "CVE-2023-52786",
			"ref_url": "https://www.cve.org/CVERecord?id=CVE-2023-52786"
		},
		"advisory": {
			"severity": "Medium",
			"rights": "Copyright (C) 2024 Canonical Ltd.",
			"public_date": "2024-05-21 16:15:00 UTC",
			"cve": {
				"text": "CVE-2023-52786",
				"href": "https://ubuntu.com/security/CVE-2023-52786",
				"public": "20240521"
			}
		}
	},
	"notes": {},
	"criteria": {
		"criterias": [
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:com.ubuntu.trusty:tst:200747740000000",
						"comment": "linux package in trusty is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.trusty:tst:200747740000010",
						"comment": "linux-lts-xenial package in trusty is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.trusty:tst:200747740000020",
						"comment": "linux-aws package in trusty is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.trusty:tst:200747740000030",
						"comment": "linux-azure package in trusty is affected and may need fixing."
					}
				]
			}
		]
	}
}
