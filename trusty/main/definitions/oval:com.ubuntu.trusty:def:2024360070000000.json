{
	"class": "vulnerability",
	"id": "oval:com.ubuntu.trusty:def:2024360070000000",
	"version": "1",
	"metadata": {
		"title": "CVE-2024-36007 on Ubuntu 14.04 LTS (trusty) - medium",
		"description": "In the Linux kernel, the following vulnerability has been resolved: mlxsw:spectrum_acl_tcam: Fix warning during rehash As previously explained, therehash delayed work migrates filters from one region to another. This isdone by iterating over all chunks (all the filters with the same priority)in the region and in each chunk iterating over all the filters. When thework runs out of credits it stores the current chunk and entry as markersin the per-work context so that it would know where to resume the migrationfrom the next time the work is scheduled. Upon error, the chunk marker isreset to NULL, but without resetting the entry markers despite beingrelative to it. This can result in migration being resumed from an entrythat does not belong to the chunk being migrated. In turn, this willeventually lead to a chunk being iterated over as if it is an entry.Because of how the two structures happen to be defined, this does not leadto KASAN splats, but to warnings such as [1]. Fix by creating a helper thatresets all the markers and call it from all the places the currently onlyreset the chunk marker. For good measures also call it when starting acompletely new rehash. Add a warning to avoid future cases. [1] WARNING:CPU: 7 PID: 1076 atdrivers/net/ethernet/mellanox/mlxsw/core_acl_flex_keys.c:407mlxsw_afk_encode+0x242/0x2f0 Modules linked in: CPU: 7 PID: 1076 Comm:kworker/7:24 Tainted: G W 6.9.0-rc3-custom-00880-g29e61d91b77b #29 Hardwarename: Mellanox Technologies Ltd. MSN3700/VMOD0005, BIOS 5.11 01/06/2019Workqueue: mlxsw_core mlxsw_sp_acl_tcam_vregion_rehash_work RIP:0010:mlxsw_afk_encode+0x242/0x2f0 [...] Call Trace: <TASK>mlxsw_sp_acl_atcam_entry_add+0xd9/0x3c0mlxsw_sp_acl_tcam_entry_create+0x5e/0xa0mlxsw_sp_acl_tcam_vchunk_migrate_all+0x109/0x290mlxsw_sp_acl_tcam_vregion_rehash_work+0x6c/0x470process_one_work+0x151/0x370 worker_thread+0x2cb/0x3e0 kthread+0xd0/0x100ret_from_fork+0x34/0x50 </TASK>\n\n    Update Instructions:\n\n    Run `sudo pro fix CVE-2024-36007` to fix the vulnerability. The problem can be corrected\n    by updating your system to the following package versions:\n\nlinux-image-3.11.0-12-generic - 3.11.0-12.19\nlinux-image-3.11.0-12-generic-lpae - 3.11.0-12.19\nlinux-image-extra-3.11.0-12-generic - 3.11.0-12.19\nNo subscription required\n\nlinux-image-4.4.0-13-generic - 4.4.0-13.29~14.04.1\nlinux-image-4.4.0-13-generic-lpae - 4.4.0-13.29~14.04.1\nlinux-image-4.4.0-13-lowlatency - 4.4.0-13.29~14.04.1\nlinux-image-4.4.0-13-powerpc-e500mc - 4.4.0-13.29~14.04.1\nlinux-image-4.4.0-13-powerpc-smp - 4.4.0-13.29~14.04.1\nlinux-image-4.4.0-13-powerpc64-emb - 4.4.0-13.29~14.04.1\nlinux-image-4.4.0-13-powerpc64-smp - 4.4.0-13.29~14.04.1\nlinux-image-extra-4.4.0-13-generic - 4.4.0-13.29~14.04.1\nNo subscription required\n\nlinux-image-4.4.0-1002-aws - 4.4.0-1002.2\nNo subscription required\n\nlinux-image-unsigned-4.15.0-1023-azure - 4.15.0-1023.24~14.04.1\nNo subscription required",
		"affected": {
			"family": "unix",
			"platform": "Ubuntu 14.04 LTS"
		},
		"reference": {
			"source": "CVE",
			"ref_id": "CVE-2024-36007",
			"ref_url": "https://www.cve.org/CVERecord?id=CVE-2024-36007"
		},
		"advisory": {
			"severity": "Medium",
			"rights": "Copyright (C) 2024 Canonical Ltd.",
			"public_date": "2024-05-20 10:15:00 UTC",
			"cve": {
				"text": "CVE-2024-36007",
				"href": "https://ubuntu.com/security/CVE-2024-36007",
				"public": "20240520"
			},
			"public_date_at_usn": "2024-05-20 10:15:00 UTC",
			"ref": [
				"https://ubuntu.com/security/notices/USN-6896-1",
				"https://ubuntu.com/security/notices/USN-6898-1",
				"https://ubuntu.com/security/notices/USN-6896-2",
				"https://ubuntu.com/security/notices/USN-6898-2",
				"https://ubuntu.com/security/notices/USN-6896-3",
				"https://ubuntu.com/security/notices/USN-6898-3",
				"https://ubuntu.com/security/notices/USN-6896-4",
				"https://ubuntu.com/security/notices/USN-6896-5",
				"https://ubuntu.com/security/notices/USN-6898-4",
				"https://ubuntu.com/security/notices/USN-6917-1",
				"https://ubuntu.com/security/notices/USN-6919-1",
				"https://ubuntu.com/security/notices/USN-6927-1",
				"https://ubuntu.com/security/notices/USN-6949-1",
				"https://ubuntu.com/security/notices/USN-6952-1",
				"https://ubuntu.com/security/notices/USN-6955-1",
				"https://ubuntu.com/security/notices/USN-6949-2",
				"https://ubuntu.com/security/notices/USN-6952-2",
				"https://ubuntu.com/security/notices/USN-7019-1"
			]
		}
	},
	"notes": {},
	"criteria": {
		"criterias": [
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:com.ubuntu.trusty:tst:200636350000000",
						"comment": "linux package in trusty, is related to the CVE in some way and has been fixed (note: '3.11.0-12.19')."
					},
					{
						"test_ref": "oval:com.ubuntu.trusty:tst:200636350000100",
						"comment": "linux-lts-xenial package in trusty, is related to the CVE in some way and has been fixed (note: '4.4.0-13.29~14.04.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.trusty:tst:200636350000110",
						"comment": "linux-aws package in trusty, is related to the CVE in some way and has been fixed (note: '4.4.0-1002.2')."
					},
					{
						"test_ref": "oval:com.ubuntu.trusty:tst:200636350000120",
						"comment": "linux-azure package in trusty, is related to the CVE in some way and has been fixed (note: '4.15.0-1023.24~14.04.1')."
					}
				]
			}
		]
	}
}
