{
	"class": "vulnerability",
	"id": "oval:com.ubuntu.focal:def:2021471460000000",
	"version": "1",
	"metadata": {
		"title": "CVE-2021-47146 on Ubuntu 20.04 LTS (focal) - medium",
		"description": "In the Linux kernel, the following vulnerability has been resolved: mld:fix panic in mld_newpack() mld_newpack() doesn't allow to allocate highorder page, only order-0 allocation is allowed. If headroom size is toolarge, a kernel panic could occur in skb_put(). Test commands: ip netns delA ip netns del B ip netns add A ip netns add B ip link add veth0 type vethpeer name veth1 ip link set veth0 netns A ip link set veth1 netns B ipnetns exec A ip link set lo up ip netns exec A ip link set veth0 up ipnetns exec A ip -6 a a 2001:db8:0::1/64 dev veth0 ip netns exec B ip linkset lo up ip netns exec B ip link set veth1 up ip netns exec B ip -6 a a2001:db8:0::2/64 dev veth1 for i in {1..99} do let A=$i-1 ip netns exec Aip link add ip6gre$i type ip6gre \\ local 2001:db8:$A::1 remote2001:db8:$A::2 encaplimit 100 ip netns exec A ip -6 a a 2001:db8:$i::1/64dev ip6gre$i ip netns exec A ip link set ip6gre$i up ip netns exec B iplink add ip6gre$i type ip6gre \\ local 2001:db8:$A::2 remote 2001:db8:$A::1encaplimit 100 ip netns exec B ip -6 a a 2001:db8:$i::2/64 dev ip6gre$i ipnetns exec B ip link set ip6gre$i up done Splat looks like: kernel BUG atnet/core/skbuff.c:110! invalid opcode: 0000 [#1] SMP DEBUG_PAGEALLOC KASANPTI CPU: 0 PID: 7 Comm: kworker/0:1 Not tainted 5.12.0+ #891 Workqueue:ipv6_addrconf addrconf_dad_work RIP: 0010:skb_panic+0x15d/0x15f Code: 92 fe4c 8b 4c 24 10 53 8b 4d 70 45 89 e0 48 c7 c7 00 ae 79 83 41 57 41 56 41 5548 8b 54 24 a6 26 f9 ff <0f> 0b 48 8b 6c 24 20 89 34 24 e8 4a 4e 92 fe 8b34 24 48 c7 c1 20 RSP: 0018:ffff88810091f820 EFLAGS: 00010282 RAX:0000000000000089 RBX: ffff8881086e9000 RCX: 0000000000000000 RDX:0000000000000089 RSI: 0000000000000008 RDI: ffffed1020123efb RBP:ffff888005f6eac0 R08: ffffed1022fc0031 R09: ffffed1022fc0031 R10:ffff888117e00187 R11: ffffed1022fc0030 R12: 0000000000000028 R13:ffff888008284eb0 R14: 0000000000000ed8 R15: 0000000000000ec0 FS:0000000000000000(0000) GS:ffff888117c00000(0000) knlGS:0000000000000000 CS:0010 DS: 0000 ES: 0000 CR0: 0000000080050033 CR2: 00007f8b801c5640 CR3:0000000033c2c006 CR4: 00000000003706f0 DR0: 0000000000000000 DR1:0000000000000000 DR2: 0000000000000000 DR3: 0000000000000000 DR6:00000000fffe0ff0 DR7: 0000000000000400 Call Trace: ?ip6_mc_hdr.isra.26.constprop.46+0x12a/0x600 ?ip6_mc_hdr.isra.26.constprop.46+0x12a/0x600 skb_put.cold.104+0x22/0x22ip6_mc_hdr.isra.26.constprop.46+0x12a/0x600 ?rcu_read_lock_sched_held+0x91/0xc0 mld_newpack+0x398/0x8f0 ?ip6_mc_hdr.isra.26.constprop.46+0x600/0x600 ? lock_contended+0xc40/0xc40add_grhead.isra.33+0x280/0x380 add_grec+0x5ca/0xff0 ?mld_sendpack+0xf40/0xf40 ? lock_downgrade+0x690/0x690mld_send_initial_cr.part.34+0xb9/0x180 ipv6_mc_dad_complete+0x15d/0x1b0addrconf_dad_completed+0x8d2/0xbb0 ? lock_downgrade+0x690/0x690 ?addrconf_rs_timer+0x660/0x660 ? addrconf_dad_work+0x73c/0x10e0addrconf_dad_work+0x73c/0x10e0 Allowing high order page allocation couldfix this problem.\n\n    Update Instructions:\n\n    Run `sudo pro fix CVE-2021-47146` to fix the vulnerability. The problem can be corrected\n    by updating your system to the following package versions:\n\nlinux-image-5.4.0-80-generic - 5.4.0-80.90\nlinux-image-5.4.0-80-generic-lpae - 5.4.0-80.90\nlinux-image-unsigned-5.4.0-80-generic - 5.4.0-80.90\nlinux-image-unsigned-5.4.0-80-lowlatency - 5.4.0-80.90\nNo subscription required\n\nlinux-image-5.15.0-33-generic - 5.15.0-33.34~20.04.1\nlinux-image-5.15.0-33-generic-lpae - 5.15.0-33.34~20.04.1\nlinux-image-unsigned-5.15.0-33-generic - 5.15.0-33.34~20.04.1\nlinux-image-unsigned-5.15.0-33-generic-64k - 5.15.0-33.34~20.04.1\nNo subscription required\n\nlinux-image-unsigned-5.4.0-1044-kvm - 5.4.0-1044.46\nNo subscription required\n\nlinux-image-5.4.0-1054-aws - 5.4.0-1054.57\nNo subscription required\n\nlinux-image-unsigned-5.15.0-1014-aws - 5.15.0-1014.18~20.04.1\nNo subscription required\n\nlinux-image-unsigned-5.4.0-1055-azure - 5.4.0-1055.57\nNo subscription required\n\nlinux-image-unsigned-5.15.0-1007-azure - 5.15.0-1007.8~20.04.1\nNo subscription required\n\nlinux-image-unsigned-5.15.0-1019-azure-fde - 5.15.0-1019.24~20.04.1.1\nNo subscription required\n\nlinux-image-unsigned-5.4.0-1016-bluefield - 5.4.0-1016.19\nNo subscription required\n\nlinux-image-unsigned-5.4.0-1049-gcp - 5.4.0-1049.53\nNo subscription required\n\nlinux-image-unsigned-5.15.0-1006-gcp - 5.15.0-1006.9~20.04.1\nNo subscription required\n\nlinux-image-unsigned-5.4.0-1021-gkeop - 5.4.0-1021.22\nNo subscription required\n\nlinux-image-unsigned-5.15.0-1003-gkeop - 5.15.0-1003.5~20.04.2\nNo subscription required\n\nlinux-image-unsigned-5.4.0-1003-ibm - 5.4.0-1003.4\nNo subscription required\n\nlinux-image-unsigned-5.15.0-1033-ibm - 5.15.0-1033.36~20.04.1\nNo subscription required\n\nlinux-image-unsigned-5.15.0-1003-intel-iotg - 5.15.0-1003.5~20.04.1\nNo subscription required\n\nlinux-image-unsigned-5.4.0-1001-iot - 5.4.0-1001.3\nNo subscription required\n\nlinux-image-unsigned-5.15.0-33-lowlatency - 5.15.0-33.34~20.04.1\nlinux-image-unsigned-5.15.0-33-lowlatency-64k - 5.15.0-33.34~20.04.1\nNo subscription required\n\nlinux-image-unsigned-5.4.0-1052-oracle - 5.4.0-1052.56\nNo subscription required\n\nlinux-image-unsigned-5.15.0-1007-oracle - 5.15.0-1007.9~20.04.1\nNo subscription required\n\nlinux-image-5.4.0-1041-raspi - 5.4.0-1041.45\nNo subscription required\n\nlinux-image-5.4.0-1020-xilinx-zynqmp - 5.4.0-1020.24\nNo subscription required",
		"affected": {
			"family": "unix",
			"platform": "Ubuntu 20.04 LTS"
		},
		"reference": {
			"source": "CVE",
			"ref_id": "CVE-2021-47146",
			"ref_url": "https://www.cve.org/CVERecord?id=CVE-2021-47146"
		},
		"advisory": {
			"severity": "Medium",
			"rights": "Copyright (C) 2024 Canonical Ltd.",
			"public_date": "2024-03-25 09:15:00 UTC",
			"cve": {
				"text": "CVE-2021-47146",
				"href": "https://ubuntu.com/security/CVE-2021-47146",
				"public": "20240325"
			}
		}
	},
	"notes": {},
	"criteria": {
		"criterias": [
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:com.ubuntu.focal:tst:2020265550000000",
						"comment": "linux package in focal was vulnerable but has been fixed (note: '5.4.0-80.90')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000100",
						"comment": "linux-hwe-5.8: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-hwe-5.11')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000180",
						"comment": "linux-hwe-5.11: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-hwe-5.13')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000260",
						"comment": "linux-hwe-5.13: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-hwe-5.15')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201431800000000",
						"comment": "linux-hwe-5.15 package in focal, is related to the CVE in some way and has been fixed (note: '5.15.0-33.34~20.04.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:2020256700000050",
						"comment": "linux-kvm package in focal was vulnerable but has been fixed (note: '5.4.0-1044.46')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:2020265550000010",
						"comment": "linux-aws package in focal was vulnerable but has been fixed (note: '5.4.0-1054.57')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000130",
						"comment": "linux-aws-5.8: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-aws-5.11')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000190",
						"comment": "linux-aws-5.11: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-aws-5.13')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000270",
						"comment": "linux-aws-5.13: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-aws-5.15')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201431800000010",
						"comment": "linux-aws-5.15 package in focal, is related to the CVE in some way and has been fixed (note: '5.15.0-1014.18~20.04.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:2020265550000020",
						"comment": "linux-azure package in focal was vulnerable but has been fixed (note: '5.4.0-1055.57')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000140",
						"comment": "linux-azure-5.8: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-azure-5.11')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000200",
						"comment": "linux-azure-5.11: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-azure-5.13')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000310",
						"comment": "linux-azure-5.13: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-azure-5.15')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201431800000020",
						"comment": "linux-azure-5.15 package in focal, is related to the CVE in some way and has been fixed (note: '5.15.0-1007.8~20.04.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000300",
						"comment": "linux-azure-fde: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-azure-fde-5.15')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201499000000000",
						"comment": "linux-azure-fde-5.15 package in focal, is related to the CVE in some way and has been fixed (note: '5.15.0-1019.24~20.04.1.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:2020265550000080",
						"comment": "linux-bluefield package in focal was vulnerable but has been fixed (note: '5.4.0-1016.19')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:2020265550000030",
						"comment": "linux-gcp package in focal was vulnerable but has been fixed (note: '5.4.0-1049.53')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000150",
						"comment": "linux-gcp-5.8: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-gcp-5.11')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000230",
						"comment": "linux-gcp-5.11: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-gcp-5.13')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000290",
						"comment": "linux-gcp-5.13: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-gcp-5.15')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201431800000040",
						"comment": "linux-gcp-5.15 package in focal, is related to the CVE in some way and has been fixed (note: '5.15.0-1006.9~20.04.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000030",
						"comment": "linux-gke: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of kernel support')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000370",
						"comment": "linux-gke-5.15: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of kernel support')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:2020265550000050",
						"comment": "linux-gkeop package in focal was vulnerable but has been fixed (note: '5.4.0-1021.22')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201499000000010",
						"comment": "linux-gkeop-5.15 package in focal, is related to the CVE in some way and has been fixed (note: '5.15.0-1003.5~20.04.2')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201431800000050",
						"comment": "linux-ibm package in focal, is related to the CVE in some way and has been fixed (note: '5.4.0-1003.4')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201431800000060",
						"comment": "linux-ibm-5.15 package in focal, is related to the CVE in some way and has been fixed (note: '5.15.0-1033.36~20.04.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000250",
						"comment": "linux-intel-5.13: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of kernel support')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201431800000070",
						"comment": "linux-intel-iotg-5.15 package in focal, is related to the CVE in some way and has been fixed (note: '5.15.0-1003.5~20.04.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201431800000080",
						"comment": "linux-iot package in focal, is related to the CVE in some way and has been fixed (note: '5.4.0-1001.3')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201431800000000",
						"comment": "linux-lowlatency-hwe-5.15 package in focal, is related to the CVE in some way and has been fixed (note: '5.15.0-33.34~20.04.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:2020265550000060",
						"comment": "linux-oracle package in focal was vulnerable but has been fixed (note: '5.4.0-1052.56')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000160",
						"comment": "linux-oracle-5.8: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-oracle-5.11')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000210",
						"comment": "linux-oracle-5.11: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-oracle-5.13')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000280",
						"comment": "linux-oracle-5.13: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-oracle-5.15')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201431800000090",
						"comment": "linux-oracle-5.15 package in focal, is related to the CVE in some way and has been fixed (note: '5.15.0-1007.9~20.04.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000080",
						"comment": "linux-oem-5.6: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-oem-5.10')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000110",
						"comment": "linux-oem-5.10: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-oem-5.13')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201585530000000",
						"comment": "linux-oem-5.13: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-oem-5.14')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000240",
						"comment": "linux-oem-5.14: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'replaced by linux-hwe-5.15')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:2020265550000070",
						"comment": "linux-raspi package in focal was vulnerable but has been fixed (note: '5.4.0-1041.45')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000010",
						"comment": "linux-raspi2: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'replaced by linux-raspi')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201431800000100",
						"comment": "linux-xilinx-zynqmp package in focal, is related to the CVE in some way and has been fixed (note: '5.4.0-1020.24')."
					}
				]
			}
		]
	}
}
