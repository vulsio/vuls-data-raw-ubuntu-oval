{
	"class": "vulnerability",
	"id": "oval:com.ubuntu.focal:def:2024267660000000",
	"version": "1",
	"metadata": {
		"title": "CVE-2024-26766 on Ubuntu 20.04 FIPS Certified (focal) - medium",
		"description": "In the Linux kernel, the following vulnerability has been resolved:IB/hfi1: Fix sdma.h tx->num_descs off-by-one error Unfortunately the commit`fd8958efe877` introduced another error causing the `descs` array tooverflow. This reults in further crashes easily reproducible by `sendmsg`system call. [ 1080.836473] general protection fault, probably fornon-canonical address 0x400300015528b00a: 0000 [#1] PREEMPT SMP PTI [1080.869326] RIP:0010:hfi1_ipoib_build_ib_tx_headers.constprop.0+0xe1/0x2b0 [hfi1] -- [1080.974535] Call Trace: [ 1080.976990] <TASK> [ 1081.021929]hfi1_ipoib_send_dma_common+0x7a/0x2e0 [hfi1] [ 1081.027364]hfi1_ipoib_send_dma_list+0x62/0x270 [hfi1] [ 1081.032633]hfi1_ipoib_send+0x112/0x300 [hfi1] [ 1081.042001]ipoib_start_xmit+0x2a9/0x2d0 [ib_ipoib] [ 1081.046978]dev_hard_start_xmit+0xc4/0x210 -- [ 1081.148347] __sys_sendmsg+0x59/0xa0crash> ipoib_txreq 0xffff9cfeba229f00 struct ipoib_txreq { txreq = { list ={ next = 0xffff9cfeba229f00, prev = 0xffff9cfeba229f00 }, descp =0xffff9cfeba229f40, coalesce_buf = 0x0, wait = 0xffff9cfea4e69a48, complete= 0xffffffffc0fe0760 <hfi1_ipoib_sdma_complete>, packet_len = 0x46d, tlen =0x0, num_desc = 0x0, desc_limit = 0x6, next_descq_idx = 0x45c, coalesce_idx= 0x0, flags = 0x0, descs = {{ qw = {0x8024000120dffb00, 0x4} #SDMA_DESC0_FIRST_DESC_FLAG (bit 63) }, { qw = { 0x3800014231b108, 0x4} }, {qw = { 0x310000e4ee0fcf0, 0x8} }, { qw = { 0x3000012e9f8000, 0x8} }, { qw ={ 0x59000dfb9d0000, 0x8} }, { qw = { 0x78000e02e40000, 0x8} }} }, sdma_hdr= 0x400300015528b000, <<< invalid pointer in the tx request structuresdma_status = 0x0, SDMA_DESC0_LAST_DESC_FLAG (bit 62) complete = 0x0, priv= 0x0, txq = 0xffff9cfea4e69880, skb = 0xffff9d099809f400 } If an SDMA sendconsists of exactly 6 descriptors and requires dword padding (in the 7thdescriptor), the sdma_txreq descriptor array is not properly expanded andthe packet will overflow into the container structure. This results in apanic when the send completion runs. The exact panic varies depending onwhat elements of the container structure get corrupted. The fix is to usethe correct expression in _pad_sdma_tx_descs() to test the need to expandthe descriptor array. With this patch the crashes are no longerreproducible and the machine is stable.\n\n    Update Instructions:\n\n    Run `sudo pro fix CVE-2024-26766` to fix the vulnerability. The problem can be corrected\n    by updating your system to the following package versions:\n\nlinux-image-5.4.0-186-generic - 5.4.0-186.206\nlinux-image-5.4.0-186-generic-lpae - 5.4.0-186.206\nlinux-image-unsigned-5.4.0-186-generic - 5.4.0-186.206\nlinux-image-unsigned-5.4.0-186-lowlatency - 5.4.0-186.206\nNo subscription required\n\nlinux-image-unsigned-5.4.0-1114-kvm - 5.4.0-1114.121\nNo subscription required\n\nlinux-image-unsigned-5.4.0-1126-aws - 5.4.0-1126.136\nNo subscription required\n\nlinux-image-unsigned-5.15.0-1063-aws - 5.15.0-1063.69~20.04.1\nNo subscription required\n\nlinux-image-unsigned-5.4.0-1131-azure - 5.4.0-1131.138\nNo subscription required\n\nlinux-image-unsigned-5.4.0-1130-gcp - 5.4.0-1130.139\nNo subscription required\n\nlinux-image-unsigned-5.15.0-1062-gcp - 5.15.0-1062.70~20.04.1\nNo subscription required\n\nlinux-image-unsigned-5.4.0-1093-gkeop - 5.4.0-1093.97\nNo subscription required\n\nlinux-image-unsigned-5.15.0-1046-gkeop - 5.15.0-1046.53~20.04.1\nNo subscription required\n\nlinux-image-unsigned-5.4.0-1073-ibm - 5.4.0-1073.78\nNo subscription required\n\nlinux-image-unsigned-5.15.0-1058-intel-iotg - 5.15.0-1058.64~20.04.1\nNo subscription required\n\nlinux-image-unsigned-5.15.0-110-lowlatency - 5.15.0-110.120~20.04.1\nlinux-image-unsigned-5.15.0-110-lowlatency-64k - 5.15.0-110.120~20.04.1\nNo subscription required\n\nlinux-image-unsigned-5.4.0-1125-oracle - 5.4.0-1125.134\nNo subscription required\n\nlinux-image-5.4.0-1110-raspi - 5.4.0-1110.122\nNo subscription required\n\nlinux-image-5.4.0-1045-xilinx-zynqmp - 5.4.0-1045.49\nNo subscription required",
		"affected": {
			"family": "unix",
			"platform": "Ubuntu 20.04 FIPS Certified"
		},
		"reference": {
			"source": "CVE",
			"ref_id": "CVE-2024-26766",
			"ref_url": "https://www.cve.org/CVERecord?id=CVE-2024-26766"
		},
		"advisory": {
			"severity": "Medium",
			"rights": "Copyright (C) 2024 Canonical Ltd.",
			"public_date": "2024-04-03 17:15:00 UTC",
			"cve": {
				"text": "CVE-2024-26766",
				"href": "https://ubuntu.com/security/CVE-2024-26766",
				"public": "20240403"
			},
			"public_date_at_usn": "2024-04-03 17:15:00 UTC",
			"ref": [
				"https://ubuntu.com/security/notices/USN-6820-1",
				"https://ubuntu.com/security/notices/USN-6821-1",
				"https://ubuntu.com/security/notices/USN-6821-2",
				"https://ubuntu.com/security/notices/USN-6828-1",
				"https://ubuntu.com/security/notices/USN-6820-2",
				"https://ubuntu.com/security/notices/USN-6821-3",
				"https://ubuntu.com/security/notices/USN-6831-1",
				"https://ubuntu.com/security/notices/USN-6821-4"
			]
		}
	},
	"notes": {},
	"criteria": {
		"criterias": [
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:com.ubuntu.focal:tst:2021470630000000",
						"comment": "linux package in focal was vulnerable but has been fixed (note: '5.4.0-186.206')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000100",
						"comment": "linux-hwe-5.8: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-hwe-5.11')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000180",
						"comment": "linux-hwe-5.11: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-hwe-5.13')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000260",
						"comment": "linux-hwe-5.13: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-hwe-5.15')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000340",
						"comment": "linux-hwe-5.15 package in focal is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:2021470630000010",
						"comment": "linux-kvm package in focal was vulnerable but has been fixed (note: '5.4.0-1114.121')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:2021470630000020",
						"comment": "linux-aws package in focal was vulnerable but has been fixed (note: '5.4.0-1126.136')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000130",
						"comment": "linux-aws-5.8: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-aws-5.11')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000190",
						"comment": "linux-aws-5.11: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-aws-5.13')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000270",
						"comment": "linux-aws-5.13: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-aws-5.15')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:2023524340000000",
						"comment": "linux-aws-5.15 package in focal was vulnerable but has been fixed (note: '5.15.0-1063.69~20.04.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:2021470630000030",
						"comment": "linux-azure package in focal was vulnerable but has been fixed (note: '5.4.0-1131.138')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000140",
						"comment": "linux-azure-5.8: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-azure-5.11')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000200",
						"comment": "linux-azure-5.11: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-azure-5.13')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000310",
						"comment": "linux-azure-5.13: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-azure-5.15')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000380",
						"comment": "linux-azure-5.15 package in focal is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000300",
						"comment": "linux-azure-fde: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-azure-fde-5.15')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000400",
						"comment": "linux-azure-fde-5.15 package in focal is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000170",
						"comment": "linux-bluefield package in focal is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201585530000010",
						"comment": "linux-fips package in fips/focal is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:2021470630000040",
						"comment": "linux-gcp package in focal was vulnerable but has been fixed (note: '5.4.0-1130.139')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000150",
						"comment": "linux-gcp-5.8: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-gcp-5.11')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000230",
						"comment": "linux-gcp-5.11: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-gcp-5.13')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000290",
						"comment": "linux-gcp-5.13: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-gcp-5.15')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:2023524340000010",
						"comment": "linux-gcp-5.15 package in focal was vulnerable but has been fixed (note: '5.15.0-1062.70~20.04.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000030",
						"comment": "linux-gke: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of kernel support')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000370",
						"comment": "linux-gke-5.15: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of kernel support')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:2021470630000050",
						"comment": "linux-gkeop package in focal was vulnerable but has been fixed (note: '5.4.0-1093.97')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:2022458860000050",
						"comment": "linux-gkeop-5.15 package in focal was vulnerable but has been fixed (note: '5.15.0-1046.53~20.04.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:2020278200000010",
						"comment": "linux-ibm package in focal was vulnerable but has been fixed (note: '5.4.0-1073.78')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000440",
						"comment": "linux-ibm-5.15 package in focal is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000250",
						"comment": "linux-intel-5.13: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of kernel support')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:2023240230000040",
						"comment": "linux-intel-iotg-5.15 package in focal was vulnerable but has been fixed (note: '5.15.0-1058.64~20.04.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000410",
						"comment": "linux-iot package in focal is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:2023524340000020",
						"comment": "linux-lowlatency-hwe-5.15 package in focal was vulnerable but has been fixed (note: '5.15.0-110.120~20.04.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:2021470630000060",
						"comment": "linux-oracle package in focal was vulnerable but has been fixed (note: '5.4.0-1125.134')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000160",
						"comment": "linux-oracle-5.8: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-oracle-5.11')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000210",
						"comment": "linux-oracle-5.11: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-oracle-5.13')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000280",
						"comment": "linux-oracle-5.13: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-oracle-5.15')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000390",
						"comment": "linux-oracle-5.15 package in focal is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000080",
						"comment": "linux-oem-5.6: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-oem-5.10')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000110",
						"comment": "linux-oem-5.10: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-oem-5.13')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201585530000000",
						"comment": "linux-oem-5.13: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-oem-5.14')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000240",
						"comment": "linux-oem-5.14: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'replaced by linux-hwe-5.15')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:2021470630000070",
						"comment": "linux-raspi package in focal was vulnerable but has been fixed (note: '5.4.0-1110.122')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000010",
						"comment": "linux-raspi2: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'replaced by linux-raspi')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:2020256390000050",
						"comment": "linux-xilinx-zynqmp package in focal was vulnerable but has been fixed (note: '5.4.0-1045.49')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000450",
						"comment": "linux-aws-fips package in fips/focal is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000460",
						"comment": "linux-azure-fips package in fips/focal is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000470",
						"comment": "linux-gcp-fips package in fips/focal is affected and may need fixing."
					}
				]
			}
		]
	}
}
