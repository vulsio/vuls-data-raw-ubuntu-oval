{
	"class": "vulnerability",
	"id": "oval:com.ubuntu.focal:def:2024386010000000",
	"version": "1",
	"metadata": {
		"title": "CVE-2024-38601 on Ubuntu 20.04 FIPS Certified (focal) - medium",
		"description": "In the Linux kernel, the following vulnerability has been resolved:ring-buffer: Fix a race between readers and resize checksThe reader code in rb_get_reader_page() swaps a new reader page into thering buffer by doing cmpxchg on old->list.prev->next to point it to thenew page. Following that, if the operation is successful,old->list.next->prev gets updated too. This means the underlyingdoubly-linked list is temporarily inconsistent, page->prev->next orpage->next->prev might not be equal back to page for some page in thering buffer.The resize operation in ring_buffer_resize() can be invoked in parallel.It calls rb_check_pages() which can detect the described inconsistencyand stop further tracing:[  190.271762] ------------[ cut here ]------------[  190.271771] WARNING: CPU: 1 PID: 6186 at kernel/trace/ring_buffer.c:1467rb_check_pages.isra.0+0x6a/0xa0[  190.271789] Modules linked in: [...][  190.271991] Unloaded tainted modules: intel_uncore_frequency(E):1skx_edac(E):1[  190.272002] CPU: 1 PID: 6186 Comm: cmd.sh Kdump: loaded Tainted: G     E      6.9.0-rc6-default #5 158d3e1e6d0b091c34c3b96bfd99a1c58306d79f[  190.272011] Hardware name: QEMU Standard PC (Q35 + ICH9, 2009), BIOSrel-1.16.0-0-gd239552c-rebuilt.opensuse.org 04/01/2014[  190.272015] RIP: 0010:rb_check_pages.isra.0+0x6a/0xa0[  190.272023] Code: [...][  190.272028] RSP: 0018:ffff9c37463abb70 EFLAGS: 00010206[  190.272034] RAX: ffff8eba04b6cb80 RBX: 0000000000000007 RCX:ffff8eba01f13d80[  190.272038] RDX: ffff8eba01f130c0 RSI: ffff8eba04b6cd00 RDI:ffff8eba0004c700[  190.272042] RBP: ffff8eba0004c700 R08: 0000000000010002 R09:0000000000000000[  190.272045] R10: 00000000ffff7f52 R11: ffff8eba7f600000 R12:ffff8eba0004c720[  190.272049] R13: ffff8eba00223a00 R14: 0000000000000008 R15:ffff8eba067a8000[  190.272053] FS:  00007f1bd64752c0(0000) GS:ffff8eba7f680000(0000)knlGS:0000000000000000[  190.272057] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033[  190.272061] CR2: 00007f1bd6662590 CR3: 000000010291e001 CR4:0000000000370ef0[  190.272070] DR0: 0000000000000000 DR1: 0000000000000000 DR2:0000000000000000[  190.272073] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7:0000000000000400[  190.272077] Call Trace:[  190.272098]  <TASK>[  190.272189]  ring_buffer_resize+0x2ab/0x460[  190.272199]  __tracing_resize_ring_buffer.part.0+0x23/0xa0[  190.272206]  tracing_resize_ring_buffer+0x65/0x90[  190.272216]  tracing_entries_write+0x74/0xc0[  190.272225]  vfs_write+0xf5/0x420[  190.272248]  ksys_write+0x67/0xe0[  190.272256]  do_syscall_64+0x82/0x170[  190.272363]  entry_SYSCALL_64_after_hwframe+0x76/0x7e[  190.272373] RIP: 0033:0x7f1bd657d263[  190.272381] Code: [...][  190.272385] RSP: 002b:00007ffe72b643f8 EFLAGS: 00000246 ORIG_RAX:0000000000000001[  190.272391] RAX: ffffffffffffffda RBX: 0000000000000002 RCX:00007f1bd657d263[  190.272395] RDX: 0000000000000002 RSI: 0000555a6eb538e0 RDI:0000000000000001[  190.272398] RBP: 0000555a6eb538e0 R08: 000000000000000a R09:0000000000000000[  190.272401] R10: 0000555a6eb55190 R11: 0000000000000246 R12:00007f1bd6662500[  190.272404] R13: 0000000000000002 R14: 00007f1bd6667c00 R15:0000000000000002[  190.272412]  </TASK>[  190.272414] ---[ end trace 0000000000000000 ]---Note that ring_buffer_resize() calls rb_check_pages() only if the parenttrace_buffer has recording disabled. Recent commit d78ab792705c(\"tracing: Stop current tracer when resizing buffer\") causes that it isnow always the case which makes it more likely to experience this issue.The window to hit this race is nonetheless very small. To helpreproducing it, one can add a delay loop in rb_get_reader_page(): ret = rb_head_page_replace(reader, cpu_buffer->reader_page); if (!ret) \tgoto spin; for (unsigned i = 0; i < 1U << 26; i++)  /* inserted delay loop */ \t__asm__ __volatile__ (\"\" : : : \"memory\"); rb_list_head(reader->list.next)->prev = &cpu_buffer->reader_page->list;..---truncated---",
		"affected": {
			"family": "unix",
			"platform": "Ubuntu 20.04 FIPS Certified"
		},
		"reference": {
			"source": "CVE",
			"ref_id": "CVE-2024-38601",
			"ref_url": "https://www.cve.org/CVERecord?id=CVE-2024-38601"
		},
		"advisory": {
			"severity": "Medium",
			"rights": "Copyright (C) 2024 Canonical Ltd.",
			"public_date": "2024-06-20",
			"cve": {
				"text": "CVE-2024-38601",
				"href": "https://ubuntu.com/security/CVE-2024-38601",
				"public": "20240620"
			}
		}
	},
	"notes": {},
	"criteria": {
		"criterias": [
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000000",
						"comment": "linux package in focal is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000100",
						"comment": "linux-hwe-5.8: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-hwe-5.11')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000180",
						"comment": "linux-hwe-5.11: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-hwe-5.13')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000260",
						"comment": "linux-hwe-5.13: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-hwe-5.15')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000340",
						"comment": "linux-hwe-5.15 package in focal is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000060",
						"comment": "linux-kvm package in focal is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000020",
						"comment": "linux-aws package in focal is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000130",
						"comment": "linux-aws-5.8: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-aws-5.11')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000190",
						"comment": "linux-aws-5.11: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-aws-5.13')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000270",
						"comment": "linux-aws-5.13: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-aws-5.15')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000350",
						"comment": "linux-aws-5.15 package in focal is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000040",
						"comment": "linux-azure package in focal is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000140",
						"comment": "linux-azure-5.8: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-azure-5.11')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000200",
						"comment": "linux-azure-5.11: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-azure-5.13')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000310",
						"comment": "linux-azure-5.13: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-azure-5.15')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000380",
						"comment": "linux-azure-5.15 package in focal is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000300",
						"comment": "linux-azure-fde: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-azure-fde-5.15')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000400",
						"comment": "linux-azure-fde-5.15 package in focal is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000170",
						"comment": "linux-bluefield package in focal is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201585530000010",
						"comment": "linux-fips package in fips/focal is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000450",
						"comment": "linux-aws-fips package in fips/focal is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000460",
						"comment": "linux-azure-fips package in fips/focal is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000470",
						"comment": "linux-gcp-fips package in fips/focal is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000050",
						"comment": "linux-gcp package in focal is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000150",
						"comment": "linux-gcp-5.8: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-gcp-5.11')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000230",
						"comment": "linux-gcp-5.11: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-gcp-5.13')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000290",
						"comment": "linux-gcp-5.13: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-gcp-5.15')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000360",
						"comment": "linux-gcp-5.15 package in focal is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000030",
						"comment": "linux-gke: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of kernel support')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000370",
						"comment": "linux-gke-5.15: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of kernel support')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000120",
						"comment": "linux-gkeop package in focal is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000430",
						"comment": "linux-gkeop-5.15 package in focal is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000220",
						"comment": "linux-ibm package in focal is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000440",
						"comment": "linux-ibm-5.15 package in focal is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000250",
						"comment": "linux-intel-5.13: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of kernel support')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000320",
						"comment": "linux-intel-iotg-5.15 package in focal is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000410",
						"comment": "linux-iot package in focal is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000330",
						"comment": "linux-lowlatency-hwe-5.15 package in focal is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000070",
						"comment": "linux-oracle package in focal is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000160",
						"comment": "linux-oracle-5.8: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-oracle-5.11')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000210",
						"comment": "linux-oracle-5.11: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-oracle-5.13')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000280",
						"comment": "linux-oracle-5.13: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-oracle-5.15')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000390",
						"comment": "linux-oracle-5.15 package in focal is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000080",
						"comment": "linux-oem-5.6: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-oem-5.10')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000110",
						"comment": "linux-oem-5.10: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-oem-5.13')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201585530000000",
						"comment": "linux-oem-5.13: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-oem-5.14')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000240",
						"comment": "linux-oem-5.14: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'replaced by linux-hwe-5.15')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000090",
						"comment": "linux-raspi package in focal is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000010",
						"comment": "linux-raspi2: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'replaced by linux-raspi')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000420",
						"comment": "linux-xilinx-zynqmp package in focal is affected and may need fixing."
					}
				]
			}
		]
	}
}
