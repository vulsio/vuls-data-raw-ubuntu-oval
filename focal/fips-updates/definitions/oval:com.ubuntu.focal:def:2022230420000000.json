{
	"class": "vulnerability",
	"id": "oval:com.ubuntu.focal:def:2022230420000000",
	"version": "1",
	"metadata": {
		"Title": "CVE-2022-23042 on Ubuntu 20.04 FIPS Compliant (focal) - medium.",
		"Description": "Linux PV device frontends vulnerable to attacks by backends T[his CNA information record relates to multiple CVEs; the text explains which aspects/vulnerabilities correspond to which CVE.] Several Linux PV device frontends are using the grant table interfaces for removing access rights of the backends in ways being subject to race conditions, resulting in potential data leaks, data corruption by malicious backends, and denial of service triggered by malicious backends: blkfront, netfront, scsifront and the gntalloc driver are testing whether a grant reference is still in use. If this is not the case, they assume that a following removal of the granted access will always succeed, which is not true in case the backend has mapped the granted page between those two operations. As a result the backend can keep access to the memory page of the guest no matter how the page will be used after the frontend I/O has finished. The xenbus driver has a similar problem, as it doesn't check the success of removing the granted access of a shared ring buffer. blkfront: CVE-2022-23036 netfront: CVE-2022-23037 scsifront: CVE-2022-23038 gntalloc: CVE-2022-23039 xenbus: CVE-2022-23040 blkfront, netfront, scsifront, usbfront, dmabuf, xenbus, 9p, kbdfront, and pvcalls are using a functionality to delay freeing a grant reference until it is no longer in use, but the freeing of the related data page is not synchronized with dropping the granted access. As a result the backend can keep access to the memory page even after it has been freed and then re-used for a different purpose. CVE-2022-23041 netfront will fail a BUG_ON() assertion if it fails to revoke access in the rx path. This will result in a Denial of Service (DoS) situation of the guest which can be triggered by the backend. CVE-2022-23042 Demi Marie Obenour and Simon Gaiser discovered that several Xen para- virtualization device frontends did not properly restrict the access rights of device backends. An attacker could possibly use a malicious Xen backend to gain access to memory pages of a guest VM or cause a denial of service in the guest.\n\nUpdate Instructions:\n\nRun `sudo pro fix CVE-2022-23042` to fix the vulnerability. The problem can be corrected\nby updating your system to the following package versions:\n\nlinux-image-5.4.0-117-generic - 5.4.0-117.132\nlinux-image-5.4.0-117-generic-lpae - 5.4.0-117.132\nlinux-image-unsigned-5.4.0-117-generic - 5.4.0-117.132\nlinux-image-unsigned-5.4.0-117-lowlatency - 5.4.0-117.132\nNo subscription required\n\nlinux-image-unsigned-5.4.0-1078-aws - 5.4.0-1078.84\nNo subscription required\n\nlinux-image-unsigned-5.4.0-1083-azure - 5.4.0-1083.87\nNo subscription required\n\nlinux-image-unsigned-5.4.0-1103-azure-fde - 5.4.0-1083.87\nNo subscription required\n\nlinux-image-unsigned-5.15.0-1052-azure-fde - 5.15.0-1007.8~20.04.1\nNo subscription required\n\nlinux-image-unsigned-5.4.0-1040-bluefield - 5.4.0-1040.44\nNo subscription required\n\nlinux-image-unsigned-5.4.0-1078-gcp - 5.4.0-1078.84\nNo subscription required\n\nlinux-image-unsigned-5.4.0-1074-gke - 5.4.0-1074.79\nNo subscription required\n\nlinux-image-unsigned-5.4.0-1046-gkeop - 5.4.0-1046.48\nNo subscription required\n\nlinux-image-5.15.0-33-generic - 5.15.0-33.34~20.04.1\nlinux-image-5.15.0-33-generic-lpae - 5.15.0-33.34~20.04.1\nlinux-image-unsigned-5.15.0-33-generic - 5.15.0-33.34~20.04.1\nlinux-image-unsigned-5.15.0-33-generic-64k - 5.15.0-33.34~20.04.1\nNo subscription required\n\nlinux-image-unsigned-5.4.0-1026-ibm - 5.4.0-1026.29\nNo subscription required\n\nlinux-image-unsigned-5.15.0-1008-intel-iotg - 5.15.0-1008.11~20.04.1\nNo subscription required\n\nlinux-image-unsigned-5.4.0-1068-kvm - 5.4.0-1068.72\nNo subscription required\n\nlinux-image-unsigned-5.15.0-33-lowlatency - 5.15.0-33.34~20.04.1\nlinux-image-unsigned-5.15.0-33-lowlatency-64k - 5.15.0-33.34~20.04.1\nNo subscription required\n\nlinux-image-unsigned-5.4.0-1076-oracle - 5.4.0-1076.83\nNo subscription required\n\nlinux-image-5.4.0-1065-raspi - 5.4.0-1065.75\nNo subscription required\n\nlinux-image-5.4.0-117-generic - 5.4.0-117.132\nlinux-image-5.4.0-117-generic-lpae - 5.4.0-117.132\nlinux-image-unsigned-5.4.0-117-generic - 5.4.0-117.132\nlinux-image-unsigned-5.4.0-117-lowlatency - 5.4.0-117.132\nNo subscription required\n\nlinux-image-unsigned-5.4.0-1078-aws - 5.4.0-1078.84\nNo subscription required\n\nlinux-image-unsigned-5.4.0-1083-azure - 5.4.0-1083.87\nNo subscription required\n\nlinux-image-unsigned-5.4.0-1103-azure-fde - 5.4.0-1083.87\nNo subscription required\n\nlinux-image-unsigned-5.15.0-1052-azure-fde - 5.15.0-1007.8~20.04.1\nNo subscription required\n\nlinux-image-unsigned-5.4.0-1040-bluefield - 5.4.0-1040.44\nNo subscription required\n\nlinux-image-unsigned-5.4.0-1078-gcp - 5.4.0-1078.84\nNo subscription required\n\nlinux-image-unsigned-5.4.0-1074-gke - 5.4.0-1074.79\nNo subscription required\n\nlinux-image-unsigned-5.4.0-1046-gkeop - 5.4.0-1046.48\nNo subscription required\n\nlinux-image-5.15.0-33-generic - 5.15.0-33.34~20.04.1\nlinux-image-5.15.0-33-generic-lpae - 5.15.0-33.34~20.04.1\nlinux-image-unsigned-5.15.0-33-generic - 5.15.0-33.34~20.04.1\nlinux-image-unsigned-5.15.0-33-generic-64k - 5.15.0-33.34~20.04.1\nNo subscription required\n\nlinux-image-unsigned-5.4.0-1026-ibm - 5.4.0-1026.29\nNo subscription required\n\nlinux-image-unsigned-5.15.0-1008-intel-iotg - 5.15.0-1008.11~20.04.1\nNo subscription required\n\nlinux-image-unsigned-5.4.0-1068-kvm - 5.4.0-1068.72\nNo subscription required\n\nlinux-image-unsigned-5.15.0-33-lowlatency - 5.15.0-33.34~20.04.1\nlinux-image-unsigned-5.15.0-33-lowlatency-64k - 5.15.0-33.34~20.04.1\nNo subscription required\n\nlinux-image-unsigned-5.4.0-1076-oracle - 5.4.0-1076.83\nNo subscription required",
		"affected": {
			"family": "unix",
			"Platform": "Ubuntu 20.04 FIPS Compliant"
		},
		"reference": {
			"source": "CVE",
			"ref_id": "CVE-2022-23042",
			"ref_url": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-23042"
		},
		"advisory": {
			"Severity": "Medium",
			"Rights": "Copyright (C) 2022 Canonical Ltd.",
			"PublicDate": "2022-03-10 20:15:00 UTC",
			"Bug": null,
			"cve": {
				"text": "CVE-2022-23042",
				"href": "https://ubuntu.com/security/CVE-2022-23042",
				"public": "20220310",
				"cvss_score": "7.0",
				"cvss_vector": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H",
				"usns": "5418-1,5467-1"
			},
			"PublicDateAtUsn": "2022-03-10 20:15:00 UTC",
			"AssignedTo": "",
			"DiscoveredBy": "Demi Marie Obenour and Simon Gaiser",
			"Crd": "",
			"Ref": null
		}
	},
	"notes": {
		"Note": ""
	},
	"criteria": {
		"criterias": [
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:com.ubuntu.focal:tst:202137720000000",
						"comment": "linux package in focal was vulnerable but has been fixed (note: '5.4.0-117.132')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:202137720000010",
						"comment": "linux-aws package in focal was vulnerable but has been fixed (note: '5.4.0-1078.84')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000020",
						"comment": "linux-aws-5.11: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of life, was needs-triage')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000030",
						"comment": "linux-aws-5.13: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of life, was needed')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000050",
						"comment": "linux-aws-5.8: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-aws-5.11')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:202137720000060",
						"comment": "linux-azure package in focal was vulnerable but has been fixed (note: '5.4.0-1083.87')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000070",
						"comment": "linux-azure-5.11: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of life, was needs-triage')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000080",
						"comment": "linux-azure-5.13: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of life, was needed')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000100",
						"comment": "linux-azure-5.8: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-azure-5.11')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:202137720000110",
						"comment": "linux-azure-fde package in focal was vulnerable but has been fixed (note: '5.4.0-1083.87')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:2016107230000100",
						"comment": "linux-azure-fde-5.15 package in focal, is related to the CVE in some way and has been fixed (note: '5.15.0-1007.8~20.04.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:2020278200000110",
						"comment": "linux-bluefield package in focal was vulnerable but has been fixed (note: '5.4.0-1040.44')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201585530000140",
						"comment": "linux-fips package in fips-updates/focal is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:202137720000150",
						"comment": "linux-gcp package in focal was vulnerable but has been fixed (note: '5.4.0-1078.84')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000150",
						"comment": "linux-gcp-5.11: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of life, was needs-triage')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000160",
						"comment": "linux-gcp-5.13: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of life, was needed')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000180",
						"comment": "linux-gcp-5.8: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-gcp-5.11')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:202137720000200",
						"comment": "linux-gke package in focal was vulnerable but has been fixed (note: '5.4.0-1074.79')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:202137720000220",
						"comment": "linux-gkeop package in focal was vulnerable but has been fixed (note: '5.4.0-1046.48')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000230",
						"comment": "linux-hwe-5.11: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-hwe-5.13')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000240",
						"comment": "linux-hwe-5.13: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of life, was needed')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:2020261440000230",
						"comment": "linux-hwe-5.15 package in focal, is related to the CVE in some way and has been fixed (note: '5.15.0-33.34~20.04.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000260",
						"comment": "linux-hwe-5.8: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-hwe-5.11')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:202137720000270",
						"comment": "linux-ibm package in focal was vulnerable but has been fixed (note: '5.4.0-1026.29')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000290",
						"comment": "linux-intel-5.13: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of life, was needs-triage')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:2021264010000310",
						"comment": "linux-intel-iotg-5.15 package in focal was vulnerable but has been fixed (note: '5.15.0-1008.11~20.04.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:202137720000300",
						"comment": "linux-kvm package in focal was vulnerable but has been fixed (note: '5.4.0-1068.72')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:2020261440000300",
						"comment": "linux-lowlatency-hwe-5.15 package in focal, is related to the CVE in some way and has been fixed (note: '5.15.0-33.34~20.04.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000340",
						"comment": "linux-oem-5.10: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of life, was needs-triage')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201585530000360",
						"comment": "linux-oem-5.13: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of life, was needs-triage')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000350",
						"comment": "linux-oem-5.14: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of life, was needed')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000360",
						"comment": "linux-oem-5.6: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of life, was needs-triage')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:202137720000360",
						"comment": "linux-oracle package in focal was vulnerable but has been fixed (note: '5.4.0-1076.83')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000380",
						"comment": "linux-oracle-5.11: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of life, was needs-triage')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000390",
						"comment": "linux-oracle-5.13: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of life, was needed')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000410",
						"comment": "linux-oracle-5.8: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-oracle-5.11')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:202137720000410",
						"comment": "linux-raspi package in focal was vulnerable but has been fixed (note: '5.4.0-1065.75')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000430",
						"comment": "linux-raspi2: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'replaced by linux-raspi')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:202137720000430",
						"comment": "linux-signed package in focal was vulnerable but has been fixed (note: '5.4.0-117.132')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:202137720000440",
						"comment": "linux-signed-aws package in focal was vulnerable but has been fixed (note: '5.4.0-1078.84')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000460",
						"comment": "linux-signed-aws-5.13: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of life, was needed')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:202137720000470",
						"comment": "linux-signed-azure package in focal was vulnerable but has been fixed (note: '5.4.0-1083.87')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000490",
						"comment": "linux-signed-azure-5.11: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of life, was needs-triage')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000500",
						"comment": "linux-signed-azure-5.13: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of life, was needed')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000520",
						"comment": "linux-signed-azure-5.8: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-azure-5.11')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:202137720000520",
						"comment": "linux-signed-azure-fde package in focal was vulnerable but has been fixed (note: '5.4.0-1083.87')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:2016107230000450",
						"comment": "linux-signed-azure-fde-5.15 package in focal, is related to the CVE in some way and has been fixed (note: '5.15.0-1007.8~20.04.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:2020278200000470",
						"comment": "linux-signed-bluefield package in focal was vulnerable but has been fixed (note: '5.4.0-1040.44')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:202137720000550",
						"comment": "linux-signed-gcp package in focal was vulnerable but has been fixed (note: '5.4.0-1078.84')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000570",
						"comment": "linux-signed-gcp-5.11: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of life, was needs-triage')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000580",
						"comment": "linux-signed-gcp-5.13: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of life, was needed')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000600",
						"comment": "linux-signed-gcp-5.8: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-gcp-5.11')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:202137720000600",
						"comment": "linux-signed-gke package in focal was vulnerable but has been fixed (note: '5.4.0-1074.79')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:202137720000620",
						"comment": "linux-signed-gkeop package in focal was vulnerable but has been fixed (note: '5.4.0-1046.48')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000650",
						"comment": "linux-signed-hwe-5.11: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-hwe-5.13')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000660",
						"comment": "linux-signed-hwe-5.13: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of life, was needed')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:2020261440000620",
						"comment": "linux-signed-hwe-5.15 package in focal, is related to the CVE in some way and has been fixed (note: '5.15.0-33.34~20.04.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000680",
						"comment": "linux-signed-hwe-5.8: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-hwe-5.11')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:202137720000670",
						"comment": "linux-signed-ibm package in focal was vulnerable but has been fixed (note: '5.4.0-1026.29')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000710",
						"comment": "linux-signed-intel-5.13: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of life, was needs-triage')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:2021264010000740",
						"comment": "linux-signed-intel-iotg-5.15 package in focal was vulnerable but has been fixed (note: '5.15.0-1008.11~20.04.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:202137720000700",
						"comment": "linux-signed-kvm package in focal was vulnerable but has been fixed (note: '5.4.0-1068.72')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:2020261440000690",
						"comment": "linux-signed-lowlatency-hwe-5.15 package in focal, is related to the CVE in some way and has been fixed (note: '5.15.0-33.34~20.04.1')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000760",
						"comment": "linux-signed-oem-5.10: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of life, was needs-triage')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201585530000790",
						"comment": "linux-signed-oem-5.13: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of life, was needs-triage')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000770",
						"comment": "linux-signed-oem-5.14: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of life, was needed')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000780",
						"comment": "linux-signed-oem-5.6: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of life, was needs-triage')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:202137720000760",
						"comment": "linux-signed-oracle package in focal was vulnerable but has been fixed (note: '5.4.0-1076.83')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000800",
						"comment": "linux-signed-oracle-5.11: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of life, was needs-triage')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000810",
						"comment": "linux-signed-oracle-5.13: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'end of life, was needed')."
					},
					{
						"test_ref": "oval:com.ubuntu.focal:tst:201245420000830",
						"comment": "linux-signed-oracle-5.8: while related to the CVE in some way, a decision has been made to ignore this issue (note: 'superseded by linux-oracle-5.11')."
					}
				]
			}
		]
	}
}
