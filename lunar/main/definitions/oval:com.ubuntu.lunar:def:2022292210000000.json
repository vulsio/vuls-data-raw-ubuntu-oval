{
	"class": "vulnerability",
	"id": "oval:com.ubuntu.lunar:def:2022292210000000",
	"version": "1",
	"metadata": {
		"Title": "CVE-2022-29221 on Ubuntu 23.04 (lunar) - medium.",
		"Description": "Smarty is a template engine for PHP, facilitating the separation of presentation (HTML/CSS) from application logic. Prior to versions 3.1.45 and 4.1.1, template authors could inject php code by choosing a malicious {block} name or {include} file name. Sites that cannot fully trust template authors should upgrade to versions 3.1.45 or 4.1.1 to receive a patch for this issue. There are currently no known workarounds.\n\nUpdate Instructions:\n\nRun `sudo pro fix CVE-2022-29221` to fix the vulnerability. The problem can be corrected\nby updating your system to the following package versions:\n\nsmarty3 - 3.1.39-2ubuntu2\nNo subscription required",
		"affected": {
			"family": "unix",
			"Platform": "Ubuntu 23.04"
		},
		"reference": {
			"source": "CVE",
			"ref_id": "CVE-2022-29221",
			"ref_url": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-29221"
		},
		"advisory": {
			"Severity": "Medium",
			"Rights": "Copyright (C) 2022 Canonical Ltd.",
			"PublicDate": "2022-05-24 15:15:00 UTC",
			"Bug": [
				"http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1011757",
				"http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1011758"
			],
			"cve": {
				"text": "CVE-2022-29221",
				"href": "https://ubuntu.com/security/CVE-2022-29221",
				"public": "20220524",
				"cvss_score": "8.8",
				"cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
				"usns": "6012-1"
			},
			"PublicDateAtUsn": "2022-05-24 15:15:00 UTC",
			"AssignedTo": "iosifache, ccdm94 (postfixadmin)",
			"DiscoveredBy": "",
			"Crd": "",
			"Ref": null
		}
	},
	"notes": {
		"Note": "ccdm94> postfixadmin does not contain embedded copies of smarty in trusty and xenial. In bionic, postfixadmin contains an embedded smarty copy at version 3.1.29, while in jammy it contains an embedded copy at version 3.1.33. In lunar and mantic this copy is at version 4.3.0."
	},
	"criteria": {
		"criterias": [
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:com.ubuntu.lunar:tst:2022292210000000",
						"comment": "gosa package in lunar is affected and may need fixing."
					},
					{
						"test_ref": "oval:com.ubuntu.lunar:tst:2022292210000010",
						"comment": "smarty3 package in lunar was vulnerable but has been fixed (note: '3.1.39-2ubuntu2')."
					},
					{
						"test_ref": "oval:com.ubuntu.lunar:tst:2018250470000010",
						"comment": "smarty4 package in lunar is affected and may need fixing."
					}
				]
			}
		]
	}
}
